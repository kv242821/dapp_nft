import{e as wt,b7 as G1,b8 as yr,b9 as ur,ba as Mc,bb as Vr,a_ as An,bc as k1,f as W1,bd as Ol,n as Y1}from"./index-20076c51.js";import{e as Lr,D as iu}from"./index-3a9e22cb.js";import{c as J1,r as X1}from"./index-cf75820f.js";var Fa={},Qf={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,K,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{P(w.next(q))}catch(te){T(te)}}function W(q){try{P(w.throw(q))}catch(te){T(te)}}function P(q){q.done?p(q.value):_(q.value).then(F,W)}P((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(P){return function(q){return W([P,q])}}function W(P){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=P[0]&2?_.return:P[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,P[1])).done)return p;switch(_=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return d.label++,{value:P[1],done:!1};case 5:d.label++,_=P[1],P=[0];continue;case 7:P=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){d=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){d.label=P[1];break}if(P[0]===6&&d.label<p[1]){d.label=p[1],p=P;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(P);break}p[2]&&d.ops.pop(),d.trys.pop();continue}P=f.call(c,d)}catch(q){P=[6,q],_=0}finally{w=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(P,q):te(p[0][2],re)}function P(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(P){p({value:P,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},K=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",K),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(Qf);var ed=Qf.exports,ps={};Object.defineProperty(ps,"__esModule",{value:!0});function Z1(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}ps.safeJsonParse=Z1;function Q1(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}ps.safeJsonStringify=Q1;var Qn={exports:{}},Pl;function em(){return Pl||(Pl=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof wt<"u"&&wt.localStorage?Qn.exports=wt.localStorage:typeof window<"u"&&window.localStorage?Qn.exports=window.localStorage:Qn.exports=new t}()),Qn.exports}var mc={},es={},xl;function tm(){if(xl)return es;xl=1,Object.defineProperty(es,"__esModule",{value:!0}),es.IKeyValueStorage=void 0;class n{}return es.IKeyValueStorage=n,es}var ts={},Al;function rm(){if(Al)return ts;Al=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.parseEntry=void 0;const n=ps;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return ts.parseEntry=t,ts}var Tl;function im(){return Tl||(Tl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ed;t.__exportStar(tm(),n),t.__exportStar(rm(),n)}(mc)),mc}Object.defineProperty(Fa,"__esModule",{value:!0});Fa.KeyValueStorage=void 0;const Pn=ed,Cl=ps,nm=Pn.__importDefault(em()),sm=im();class td{constructor(){this.localStorage=nm.default}getKeys(){return Pn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Pn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(sm.parseEntry)})}getItem(t){return Pn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Cl.safeJsonParse(r)})}setItem(t,r){return Pn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Cl.safeJsonStringify(r))})}removeItem(t){return Pn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Fa.KeyValueStorage=td;var am=Fa.default=td,gs={},rd={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,K,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{P(w.next(q))}catch(te){T(te)}}function W(q){try{P(w.throw(q))}catch(te){T(te)}}function P(q){q.done?p(q.value):_(q.value).then(F,W)}P((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(P){return function(q){return W([P,q])}}function W(P){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=P[0]&2?_.return:P[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,P[1])).done)return p;switch(_=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return d.label++,{value:P[1],done:!1};case 5:d.label++,_=P[1],P=[0];continue;case 7:P=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){d=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){d.label=P[1];break}if(P[0]===6&&d.label<p[1]){d.label=p[1],p=P;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(P);break}p[2]&&d.ops.pop(),d.trys.pop();continue}P=f.call(c,d)}catch(q){P=[6,q],_=0}finally{w=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(P,q):te(p[0][2],re)}function P(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(P){p({value:P,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},K=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",K),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(rd);var Ua=rd.exports,rs={},me={},id={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,K,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{P(w.next(q))}catch(te){T(te)}}function W(q){try{P(w.throw(q))}catch(te){T(te)}}function P(q){q.done?p(q.value):_(q.value).then(F,W)}P((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(P){return function(q){return W([P,q])}}function W(P){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=P[0]&2?_.return:P[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,P[1])).done)return p;switch(_=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return d.label++,{value:P[1],done:!1};case 5:d.label++,_=P[1],P=[0];continue;case 7:P=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){d=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){d.label=P[1];break}if(P[0]===6&&d.label<p[1]){d.label=p[1],p=P;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(P);break}p[2]&&d.ops.pop(),d.trys.pop();continue}P=f.call(c,d)}catch(q){P=[6,q],_=0}finally{w=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(P,q):te(p[0][2],re)}function P(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(P){p({value:P,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},K=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",K),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(id);var La=id.exports,bc={},is={},Rl;function om(){if(Rl)return is;Rl=1,Object.defineProperty(is,"__esModule",{value:!0}),is.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return is.delay=n,is}var Wi={},wc={},Yi={},Nl;function cm(){return Nl||(Nl=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.ONE_THOUSAND=Yi.ONE_HUNDRED=void 0,Yi.ONE_HUNDRED=100,Yi.ONE_THOUSAND=1e3),Yi}var Ec={},jl;function um(){return jl||(jl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Ec)),Ec}var Dl;function nd(){return Dl||(Dl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=La;t.__exportStar(cm(),n),t.__exportStar(um(),n)}(wc)),wc}var Fl;function hm(){if(Fl)return Wi;Fl=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.fromMiliseconds=Wi.toMiliseconds=void 0;const n=nd();function t(s){return s*n.ONE_THOUSAND}Wi.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Wi.fromMiliseconds=r,Wi}var Ul;function lm(){return Ul||(Ul=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=La;t.__exportStar(om(),n),t.__exportStar(hm(),n)}(bc)),bc}var On={},Ll;function fm(){if(Ll)return On;Ll=1,Object.defineProperty(On,"__esModule",{value:!0}),On.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const o=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:o})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return On.Watch=n,On.default=n,On}var Sc={},ns={},$l;function dm(){if($l)return ns;$l=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.IWatch=void 0;class n{}return ns.IWatch=n,ns}var Ml;function pm(){return Ml||(Ml=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),La.__exportStar(dm(),n)}(Sc)),Sc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=La;t.__exportStar(lm(),n),t.__exportStar(fm(),n),t.__exportStar(pm(),n),t.__exportStar(nd(),n)})(me);var Ic={},ss={};let en=class{};const gm=Object.freeze(Object.defineProperty({__proto__:null,IEvents:en},Symbol.toStringTag,{value:"Module"})),_m=G1(gm);var ql;function ym(){if(ql)return ss;ql=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.IHeartBeat=void 0;const n=_m;class t extends n.IEvents{constructor(s){super()}}return ss.IHeartBeat=t,ss}var zl;function sd(){return zl||(zl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ua.__exportStar(ym(),n)}(Ic)),Ic}var Oc={},Ji={},Hl;function vm(){if(Hl)return Ji;Hl=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.HEARTBEAT_EVENTS=Ji.HEARTBEAT_INTERVAL=void 0;const n=me;return Ji.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ji}var Kl;function ad(){return Kl||(Kl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ua.__exportStar(vm(),n)}(Oc)),Oc}var Bl;function mm(){if(Bl)return rs;Bl=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.HeartBeat=void 0;const n=Ua,t=Lr,r=me,s=sd(),o=ad();class g extends s.IHeartBeat{constructor(m){super(m),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(m==null?void 0:m.interval)||o.HEARTBEAT_INTERVAL}static init(m){return n.__awaiter(this,void 0,void 0,function*(){const E=new g(m);return yield E.init(),E})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(m,E){this.events.on(m,E)}once(m,E){this.events.once(m,E)}off(m,E){this.events.off(m,E)}removeListener(m,E){this.events.removeListener(m,E)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return rs.HeartBeat=g,rs}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Ua;t.__exportStar(mm(),n),t.__exportStar(sd(),n),t.__exportStar(ad(),n)})(gs);var Qe={},od={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,K,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{P(w.next(q))}catch(te){T(te)}}function W(q){try{P(w.throw(q))}catch(te){T(te)}}function P(q){q.done?p(q.value):_(q.value).then(F,W)}P((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(P){return function(q){return W([P,q])}}function W(P){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=P[0]&2?_.return:P[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,P[1])).done)return p;switch(_=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return d.label++,{value:P[1],done:!1};case 5:d.label++,_=P[1],P=[0];continue;case 7:P=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){d=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){d.label=P[1];break}if(P[0]===6&&d.label<p[1]){d.label=p[1],p=P;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(P);break}p[2]&&d.ops.pop(),d.trys.pop();continue}P=f.call(c,d)}catch(q){P=[6,q],_=0}finally{w=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(P,q):te(p[0][2],re)}function P(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(P){p({value:P,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},K=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",K),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(od);var bm=od.exports,Pc,Vl;function wm(){if(Vl)return Pc;Vl=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Pc=t;function t(r,s,o){var g=o&&o.stringify||n,b=1;if(typeof r=="object"&&r!==null){var m=s.length+b;if(m===1)return r;var E=new Array(m);E[0]=g(r);for(var A=1;A<m;A++)E[A]=g(s[A]);return E.join(" ")}if(typeof r!="string")return r;var C=s.length;if(C===0)return r;for(var $="",k=1-b,M=-1,H=r&&r.length||0,Z=0;Z<H;){if(r.charCodeAt(Z)===37&&Z+1<H){switch(M=M>-1?M:0,r.charCodeAt(Z+1)){case 100:case 102:if(k>=C||s[k]==null)break;M<Z&&($+=r.slice(M,Z)),$+=Number(s[k]),M=Z+2,Z++;break;case 105:if(k>=C||s[k]==null)break;M<Z&&($+=r.slice(M,Z)),$+=Math.floor(Number(s[k])),M=Z+2,Z++;break;case 79:case 111:case 106:if(k>=C||s[k]===void 0)break;M<Z&&($+=r.slice(M,Z));var Q=typeof s[k];if(Q==="string"){$+="'"+s[k]+"'",M=Z+2,Z++;break}if(Q==="function"){$+=s[k].name||"<anonymous>",M=Z+2,Z++;break}$+=g(s[k]),M=Z+2,Z++;break;case 115:if(k>=C)break;M<Z&&($+=r.slice(M,Z)),$+=String(s[k]),M=Z+2,Z++;break;case 37:M<Z&&($+=r.slice(M,Z)),$+="%",M=Z+2,Z++,k--;break}++k}++Z}return M===-1?r:(M<H&&($+=r.slice(M)),$)}return Pc}var xc,Gl;function Em(){if(Gl)return xc;Gl=1;const n=wm();xc=o;const t=j().console||{},r={mapHttpRequest:H,mapHttpResponse:H,wrapRequestSerializer:Z,wrapResponseSerializer:Z,wrapErrorSerializer:Z,req:H,res:H,err:k};function s(O,u){return Array.isArray(O)?O.filter(function(X){return X!=="!stdSerializers.err"}):O===!0?Object.keys(u):!1}function o(O){O=O||{},O.browser=O.browser||{};const u=O.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const y=O.browser.write||t;O.browser.write&&(O.browser.asObject=!0);const X=O.serializers||{},c=s(O.browser.serialize,X);let f=O.browser.serialize;Array.isArray(O.browser.serialize)&&O.browser.serialize.indexOf("!stdSerializers.err")>-1&&(f=!1);const d=["error","fatal","warn","info","debug","trace"];typeof y=="function"&&(y.error=y.fatal=y.warn=y.info=y.debug=y.trace=y),O.enabled===!1&&(O.level="silent");const w=O.level||"info",_=Object.create(y);_.log||(_.log=Q),Object.defineProperty(_,"levelVal",{get:T}),Object.defineProperty(_,"level",{get:F,set:W});const p={transmit:u,serialize:c,asObject:O.browser.asObject,levels:d,timestamp:M(O)};_.levels=o.levels,_.level=w,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=Q,_.serializers=X,_._serialize=c,_._stdErrSerialize=f,_.child=P,u&&(_._logEvent=$());function T(){return this.level==="silent"?1/0:this.levels.values[this.level]}function F(){return this._level}function W(q){if(q!=="silent"&&!this.levels.values[q])throw Error("unknown level "+q);this._level=q,g(p,_,"error","log"),g(p,_,"fatal","error"),g(p,_,"warn","error"),g(p,_,"info","log"),g(p,_,"debug","log"),g(p,_,"trace","log")}function P(q,te){if(!q)throw new Error("missing bindings for child Pino");te=te||{},c&&q.serializers&&(te.serializers=q.serializers);const re=te.serializers;if(c&&re){var ie=Object.assign({},X,re),ge=O.browser.serialize===!0?Object.keys(ie):c;delete q.serializers,E([q],ge,ie,this._stdErrSerialize)}function le(be){this._childLevel=(be._childLevel|0)+1,this.error=A(be,q,"error"),this.fatal=A(be,q,"fatal"),this.warn=A(be,q,"warn"),this.info=A(be,q,"info"),this.debug=A(be,q,"debug"),this.trace=A(be,q,"trace"),ie&&(this.serializers=ie,this._serialize=ge),u&&(this._logEvent=$([].concat(be._logEvent.bindings,q)))}return le.prototype=this,new le(this)}return _}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:ue,epochTime:L,unixTime:K,isoTime:N});function g(O,u,y,X){const c=Object.getPrototypeOf(u);u[y]=u.levelVal>u.levels.values[y]?Q:c[y]?c[y]:t[y]||t[X]||Q,b(O,u,y)}function b(O,u,y){!O.transmit&&u[y]===Q||(u[y]=function(X){return function(){const f=O.timestamp(),d=new Array(arguments.length),w=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var _=0;_<d.length;_++)d[_]=arguments[_];if(O.serialize&&!O.asObject&&E(d,this._serialize,this.serializers,this._stdErrSerialize),O.asObject?X.call(w,m(this,y,d,f)):X.apply(w,d),O.transmit){const p=O.transmit.level||u.level,T=o.levels.values[p],F=o.levels.values[y];if(F<T)return;C(this,{ts:f,methodLevel:y,methodValue:F,transmitLevel:p,transmitValue:o.levels.values[O.transmit.level||u.level],send:O.transmit.send,val:u.levelVal},d)}}}(u[y]))}function m(O,u,y,X){O._serialize&&E(y,O._serialize,O.serializers,O._stdErrSerialize);const c=y.slice();let f=c[0];const d={};X&&(d.time=X),d.level=o.levels.values[u];let w=(O._childLevel|0)+1;if(w<1&&(w=1),f!==null&&typeof f=="object"){for(;w--&&typeof c[0]=="object";)Object.assign(d,c.shift());f=c.length?n(c.shift(),c):void 0}else typeof f=="string"&&(f=n(c.shift(),c));return f!==void 0&&(d.msg=f),d}function E(O,u,y,X){for(const c in O)if(X&&O[c]instanceof Error)O[c]=o.stdSerializers.err(O[c]);else if(typeof O[c]=="object"&&!Array.isArray(O[c]))for(const f in O[c])u&&u.indexOf(f)>-1&&f in y&&(O[c][f]=y[f](O[c][f]))}function A(O,u,y){return function(){const X=new Array(1+arguments.length);X[0]=u;for(var c=1;c<X.length;c++)X[c]=arguments[c-1];return O[y].apply(this,X)}}function C(O,u,y){const X=u.send,c=u.ts,f=u.methodLevel,d=u.methodValue,w=u.val,_=O._logEvent.bindings;E(y,O._serialize||Object.keys(O.serializers),O.serializers,O._stdErrSerialize===void 0?!0:O._stdErrSerialize),O._logEvent.ts=c,O._logEvent.messages=y.filter(function(p){return _.indexOf(p)===-1}),O._logEvent.level.label=f,O._logEvent.level.value=d,X(f,O._logEvent,w),O._logEvent=$(_)}function $(O){return{ts:0,messages:[],bindings:O||[],level:{label:"",value:0}}}function k(O){const u={type:O.constructor.name,msg:O.message,stack:O.stack};for(const y in O)u[y]===void 0&&(u[y]=O[y]);return u}function M(O){return typeof O.timestamp=="function"?O.timestamp:O.timestamp===!1?ue:L}function H(){return{}}function Z(O){return O}function Q(){}function ue(){return!1}function L(){return Date.now()}function K(){return Math.round(Date.now()/1e3)}function N(){return new Date(Date.now()).toISOString()}function j(){function O(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return O(self)||O(window)||O(this)||{}}}return xc}var Xi={},kl;function cd(){return kl||(kl=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.PINO_CUSTOM_CONTEXT_KEY=Xi.PINO_LOGGER_DEFAULTS=void 0,Xi.PINO_LOGGER_DEFAULTS={level:"info"},Xi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Xi}var ar={},Wl;function Sm(){if(Wl)return ar;Wl=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const n=cd();function t(m){return Object.assign(Object.assign({},m),{level:(m==null?void 0:m.level)||n.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=t;function r(m,E=n.PINO_CUSTOM_CONTEXT_KEY){return m[E]||""}ar.getBrowserLoggerContext=r;function s(m,E,A=n.PINO_CUSTOM_CONTEXT_KEY){return m[A]=E,m}ar.setBrowserLoggerContext=s;function o(m,E=n.PINO_CUSTOM_CONTEXT_KEY){let A="";return typeof m.bindings>"u"?A=r(m,E):A=m.bindings().context||"",A}ar.getLoggerContext=o;function g(m,E,A=n.PINO_CUSTOM_CONTEXT_KEY){const C=o(m,A);return C.trim()?`${C}/${E}`:E}ar.formatChildLoggerContext=g;function b(m,E,A=n.PINO_CUSTOM_CONTEXT_KEY){const C=g(m,E,A),$=m.child({context:C});return s($,C,A)}return ar.generateChildLogger=b,ar}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=bm,r=t.__importDefault(Em());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(cd(),n),t.__exportStar(Sm(),n)})(Qe);class Im extends en{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Om extends en{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Pm{constructor(t,r){this.logger=t,this.core=r}}let xm=class extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}},Am=class extends en{constructor(t){super()}},Tm=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}};class Cm extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Rm extends en{constructor(t,r){super(),this.core=t,this.logger=r}}let Nm=class{constructor(t,r){this.projectId=t,this.logger=r}},jm=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Dm=class{constructor(t){this.client=t}};const Fm=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Um=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function nu(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Um(n)}catch{return n}}function fs(n){return typeof n=="string"?n:Fm(n)||""}var su={},Rn={},$a={},Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.BrowserRandomSource=void 0;const Yl=65536;class Lm{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=Yl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Yl)));return r}}Ma.BrowserRandomSource=Lm;var qa={},Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});function $m(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Ir.wipe=$m;Object.defineProperty(qa,"__esModule",{value:!0});qa.NodeRandomSource=void 0;const Mm=Ir;class qm{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof J1<"u"){const t=X1();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let o=0;o<s.length;o++)s[o]=r[o];return(0,Mm.wipe)(r),s}}qa.NodeRandomSource=qm;Object.defineProperty($a,"__esModule",{value:!0});$a.SystemRandomSource=void 0;const zm=Ma,Hm=qa;class Km{constructor(){if(this.isAvailable=!1,this.name="",this._source=new zm.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Hm.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}$a.SystemRandomSource=Km;var Ue={},ud={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(m,E){var A=m>>>16&65535,C=m&65535,$=E>>>16&65535,k=E&65535;return C*k+(A*k+C*$<<16>>>0)|0}n.mul=Math.imul||t;function r(m,E){return m+E|0}n.add=r;function s(m,E){return m-E|0}n.sub=s;function o(m,E){return m<<E|m>>>32-E}n.rotl=o;function g(m,E){return m<<32-E|m>>>E}n.rotr=g;function b(m){return typeof m=="number"&&isFinite(m)&&Math.floor(m)===m}n.isInteger=Number.isInteger||b,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(m){return n.isInteger(m)&&m>=-n.MAX_SAFE_INTEGER&&m<=n.MAX_SAFE_INTEGER}})(ud);Object.defineProperty(Ue,"__esModule",{value:!0});var hd=ud;function Bm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}Ue.readInt16BE=Bm;function Vm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}Ue.readUint16BE=Vm;function Gm(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}Ue.readInt16LE=Gm;function km(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}Ue.readUint16LE=km;function ld(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}Ue.writeUint16BE=ld;Ue.writeInt16BE=ld;function fd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}Ue.writeUint16LE=fd;Ue.writeInt16LE=fd;function qc(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}Ue.readInt32BE=qc;function zc(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}Ue.readUint32BE=zc;function Hc(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}Ue.readInt32LE=Hc;function Kc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}Ue.readUint32LE=Kc;function Ta(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}Ue.writeUint32BE=Ta;Ue.writeInt32BE=Ta;function Ca(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}Ue.writeUint32LE=Ca;Ue.writeInt32LE=Ca;function Wm(n,t){t===void 0&&(t=0);var r=qc(n,t),s=qc(n,t+4);return r*4294967296+s-(s>>31)*4294967296}Ue.readInt64BE=Wm;function Ym(n,t){t===void 0&&(t=0);var r=zc(n,t),s=zc(n,t+4);return r*4294967296+s}Ue.readUint64BE=Ym;function Jm(n,t){t===void 0&&(t=0);var r=Hc(n,t),s=Hc(n,t+4);return s*4294967296+r-(r>>31)*4294967296}Ue.readInt64LE=Jm;function Xm(n,t){t===void 0&&(t=0);var r=Kc(n,t),s=Kc(n,t+4);return s*4294967296+r}Ue.readUint64LE=Xm;function dd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ta(n/4294967296>>>0,t,r),Ta(n>>>0,t,r+4),t}Ue.writeUint64BE=dd;Ue.writeInt64BE=dd;function pd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ca(n>>>0,t,r),Ca(n/4294967296>>>0,t,r+4),t}Ue.writeUint64LE=pd;Ue.writeInt64LE=pd;function Zm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,g=n/8+r-1;g>=r;g--)s+=t[g]*o,o*=256;return s}Ue.readUintBE=Zm;function Qm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,g=r;g<r+n/8;g++)s+=t[g]*o,o*=256;return s}Ue.readUintLE=Qm;function eb(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!hd.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,g=n/8+s-1;g>=s;g--)r[g]=t/o&255,o*=256;return r}Ue.writeUintBE=eb;function tb(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!hd.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,g=s;g<s+n/8;g++)r[g]=t/o&255,o*=256;return r}Ue.writeUintLE=tb;function rb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}Ue.readFloat32BE=rb;function ib(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}Ue.readFloat32LE=ib;function nb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}Ue.readFloat64BE=nb;function sb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}Ue.readFloat64LE=sb;function ab(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}Ue.writeFloat32BE=ab;function ob(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}Ue.writeFloat32LE=ob;function cb(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}Ue.writeFloat64BE=cb;function ub(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}Ue.writeFloat64LE=ub;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=$a,r=Ue,s=Ir;n.defaultRandomSource=new t.SystemRandomSource;function o(A,C=n.defaultRandomSource){return C.randomBytes(A)}n.randomBytes=o;function g(A=n.defaultRandomSource){const C=o(4,A),$=(0,r.readUint32LE)(C);return(0,s.wipe)(C),$}n.randomUint32=g;const b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function m(A,C=b,$=n.defaultRandomSource){if(C.length<2)throw new Error("randomString charset is too short");if(C.length>256)throw new Error("randomString charset is too long");let k="";const M=C.length,H=256-256%M;for(;A>0;){const Z=o(Math.ceil(A*256/H),$);for(let Q=0;Q<Z.length&&A>0;Q++){const ue=Z[Q];ue<H&&(k+=C.charAt(ue%M),A--)}(0,s.wipe)(Z)}return k}n.randomString=m;function E(A,C=b,$=n.defaultRandomSource){const k=Math.ceil(A/(Math.log(C.length)/Math.LN2));return m(k,C,$)}n.randomStringForEntropy=E})(Rn);var gd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ue,r=Ir;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function m(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return m.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},m.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},m.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},m.prototype.update=function(E,A){if(A===void 0&&(A=E.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var C=0;if(this._bytesHashed+=A,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&A>0;)this._buffer[this._bufferLength++]=E[C++],A--;this._bufferLength===this.blockSize&&(g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(A>=this.blockSize&&(C=g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,E,C,A),A%=this.blockSize);A>0;)this._buffer[this._bufferLength++]=E[C++],A--;return this},m.prototype.finish=function(E){if(!this._finished){var A=this._bytesHashed,C=this._bufferLength,$=A/536870912|0,k=A<<3,M=A%128<112?128:256;this._buffer[C]=128;for(var H=C+1;H<M-8;H++)this._buffer[H]=0;t.writeUint32BE($,this._buffer,M-8),t.writeUint32BE(k,this._buffer,M-4),g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,M),this._finished=!0}for(var H=0;H<this.digestLength/8;H++)t.writeUint32BE(this._stateHi[H],E,H*8),t.writeUint32BE(this._stateLo[H],E,H*8+4);return this},m.prototype.digest=function(){var E=new Uint8Array(this.digestLength);return this.finish(E),E},m.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},m.prototype.restoreState=function(E){return this._stateHi.set(E.stateHi),this._stateLo.set(E.stateLo),this._bufferLength=E.bufferLength,E.buffer&&this._buffer.set(E.buffer),this._bytesHashed=E.bytesHashed,this._finished=!1,this},m.prototype.cleanSavedState=function(E){r.wipe(E.stateHi),r.wipe(E.stateLo),E.buffer&&r.wipe(E.buffer),E.bufferLength=0,E.bytesHashed=0},m}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function g(m,E,A,C,$,k,M){for(var H=A[0],Z=A[1],Q=A[2],ue=A[3],L=A[4],K=A[5],N=A[6],j=A[7],O=C[0],u=C[1],y=C[2],X=C[3],c=C[4],f=C[5],d=C[6],w=C[7],_,p,T,F,W,P,q,te;M>=128;){for(var re=0;re<16;re++){var ie=8*re+k;m[re]=t.readUint32BE($,ie),E[re]=t.readUint32BE($,ie+4)}for(var re=0;re<80;re++){var ge=H,le=Z,be=Q,J=ue,Y=L,z=K,l=N,D=j,he=O,pe=u,Oe=y,He=X,Ve=c,Le=f,pt=d,gt=w;if(_=j,p=w,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=(L>>>14|c<<32-14)^(L>>>18|c<<32-18)^(c>>>41-32|L<<32-(41-32)),p=(c>>>14|L<<32-14)^(c>>>18|L<<32-18)^(L>>>41-32|c<<32-(41-32)),W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,_=L&K^~L&N,p=c&f^~c&d,W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,_=o[re*2],p=o[re*2+1],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,_=m[re%16],p=E[re%16],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,T=q&65535|te<<16,F=W&65535|P<<16,_=T,p=F,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=(H>>>28|O<<32-28)^(O>>>34-32|H<<32-(34-32))^(O>>>39-32|H<<32-(39-32)),p=(O>>>28|H<<32-28)^(H>>>34-32|O<<32-(34-32))^(H>>>39-32|O<<32-(39-32)),W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,_=H&Z^H&Q^Z&Q,p=O&u^O&y^u&y,W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,D=q&65535|te<<16,gt=W&65535|P<<16,_=J,p=He,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=T,p=F,W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,J=q&65535|te<<16,He=W&65535|P<<16,Z=ge,Q=le,ue=be,L=J,K=Y,N=z,j=l,H=D,u=he,y=pe,X=Oe,c=He,f=Ve,d=Le,w=pt,O=gt,re%16===15)for(var ie=0;ie<16;ie++)_=m[ie],p=E[ie],W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=m[(ie+9)%16],p=E[(ie+9)%16],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,T=m[(ie+1)%16],F=E[(ie+1)%16],_=(T>>>1|F<<32-1)^(T>>>8|F<<32-8)^T>>>7,p=(F>>>1|T<<32-1)^(F>>>8|T<<32-8)^(F>>>7|T<<32-7),W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,T=m[(ie+14)%16],F=E[(ie+14)%16],_=(T>>>19|F<<32-19)^(F>>>61-32|T<<32-(61-32))^T>>>6,p=(F>>>19|T<<32-19)^(T>>>61-32|F<<32-(61-32))^(F>>>6|T<<32-6),W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,m[ie]=q&65535|te<<16,E[ie]=W&65535|P<<16}_=H,p=O,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[0],p=C[0],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[0]=H=q&65535|te<<16,C[0]=O=W&65535|P<<16,_=Z,p=u,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[1],p=C[1],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[1]=Z=q&65535|te<<16,C[1]=u=W&65535|P<<16,_=Q,p=y,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[2],p=C[2],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[2]=Q=q&65535|te<<16,C[2]=y=W&65535|P<<16,_=ue,p=X,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[3],p=C[3],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[3]=ue=q&65535|te<<16,C[3]=X=W&65535|P<<16,_=L,p=c,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[4],p=C[4],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[4]=L=q&65535|te<<16,C[4]=c=W&65535|P<<16,_=K,p=f,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[5],p=C[5],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[5]=K=q&65535|te<<16,C[5]=f=W&65535|P<<16,_=N,p=d,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[6],p=C[6],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[6]=N=q&65535|te<<16,C[6]=d=W&65535|P<<16,_=j,p=w,W=p&65535,P=p>>>16,q=_&65535,te=_>>>16,_=A[7],p=C[7],W+=p&65535,P+=p>>>16,q+=_&65535,te+=_>>>16,P+=W>>>16,q+=P>>>16,te+=q>>>16,A[7]=j=q&65535|te<<16,C[7]=w=W&65535|P<<16,k+=128,M-=128}return k}function b(m){var E=new s;E.update(m);var A=E.digest();return E.clean(),A}n.hash=b})(gd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Rn,r=gd,s=Ir;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(J){const Y=new Float64Array(16);if(J)for(let z=0;z<J.length;z++)Y[z]=J[z];return Y}const g=new Uint8Array(32);g[0]=9;const b=o(),m=o([1]),E=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),C=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),$=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),k=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function M(J,Y){for(let z=0;z<16;z++)J[z]=Y[z]|0}function H(J){let Y=1;for(let z=0;z<16;z++){let l=J[z]+Y+65535;Y=Math.floor(l/65536),J[z]=l-Y*65536}J[0]+=Y-1+37*(Y-1)}function Z(J,Y,z){const l=~(z-1);for(let D=0;D<16;D++){const he=l&(J[D]^Y[D]);J[D]^=he,Y[D]^=he}}function Q(J,Y){const z=o(),l=o();for(let D=0;D<16;D++)l[D]=Y[D];H(l),H(l),H(l);for(let D=0;D<2;D++){z[0]=l[0]-65517;for(let pe=1;pe<15;pe++)z[pe]=l[pe]-65535-(z[pe-1]>>16&1),z[pe-1]&=65535;z[15]=l[15]-32767-(z[14]>>16&1);const he=z[15]>>16&1;z[14]&=65535,Z(l,z,1-he)}for(let D=0;D<16;D++)J[2*D]=l[D]&255,J[2*D+1]=l[D]>>8}function ue(J,Y){let z=0;for(let l=0;l<32;l++)z|=J[l]^Y[l];return(1&z-1>>>8)-1}function L(J,Y){const z=new Uint8Array(32),l=new Uint8Array(32);return Q(z,J),Q(l,Y),ue(z,l)}function K(J){const Y=new Uint8Array(32);return Q(Y,J),Y[0]&1}function N(J,Y){for(let z=0;z<16;z++)J[z]=Y[2*z]+(Y[2*z+1]<<8);J[15]&=32767}function j(J,Y,z){for(let l=0;l<16;l++)J[l]=Y[l]+z[l]}function O(J,Y,z){for(let l=0;l<16;l++)J[l]=Y[l]-z[l]}function u(J,Y,z){let l,D,he=0,pe=0,Oe=0,He=0,Ve=0,Le=0,pt=0,gt=0,Me=0,Pe=0,je=0,De=0,qe=0,Ae=0,Fe=0,Ie=0,Te=0,Ke=0,xe=0,Ge=0,We=0,et=0,tt=0,Je=0,er=0,hr=0,Gr=0,tr=0,ri=0,vi=0,Di=0,Et=z[0],_t=z[1],St=z[2],It=z[3],mt=z[4],yt=z[5],Ut=z[6],Lt=z[7],Ot=z[8],$t=z[9],Pt=z[10],Ct=z[11],xt=z[12],ht=z[13],Mt=z[14],qt=z[15];l=Y[0],he+=l*Et,pe+=l*_t,Oe+=l*St,He+=l*It,Ve+=l*mt,Le+=l*yt,pt+=l*Ut,gt+=l*Lt,Me+=l*Ot,Pe+=l*$t,je+=l*Pt,De+=l*Ct,qe+=l*xt,Ae+=l*ht,Fe+=l*Mt,Ie+=l*qt,l=Y[1],pe+=l*Et,Oe+=l*_t,He+=l*St,Ve+=l*It,Le+=l*mt,pt+=l*yt,gt+=l*Ut,Me+=l*Lt,Pe+=l*Ot,je+=l*$t,De+=l*Pt,qe+=l*Ct,Ae+=l*xt,Fe+=l*ht,Ie+=l*Mt,Te+=l*qt,l=Y[2],Oe+=l*Et,He+=l*_t,Ve+=l*St,Le+=l*It,pt+=l*mt,gt+=l*yt,Me+=l*Ut,Pe+=l*Lt,je+=l*Ot,De+=l*$t,qe+=l*Pt,Ae+=l*Ct,Fe+=l*xt,Ie+=l*ht,Te+=l*Mt,Ke+=l*qt,l=Y[3],He+=l*Et,Ve+=l*_t,Le+=l*St,pt+=l*It,gt+=l*mt,Me+=l*yt,Pe+=l*Ut,je+=l*Lt,De+=l*Ot,qe+=l*$t,Ae+=l*Pt,Fe+=l*Ct,Ie+=l*xt,Te+=l*ht,Ke+=l*Mt,xe+=l*qt,l=Y[4],Ve+=l*Et,Le+=l*_t,pt+=l*St,gt+=l*It,Me+=l*mt,Pe+=l*yt,je+=l*Ut,De+=l*Lt,qe+=l*Ot,Ae+=l*$t,Fe+=l*Pt,Ie+=l*Ct,Te+=l*xt,Ke+=l*ht,xe+=l*Mt,Ge+=l*qt,l=Y[5],Le+=l*Et,pt+=l*_t,gt+=l*St,Me+=l*It,Pe+=l*mt,je+=l*yt,De+=l*Ut,qe+=l*Lt,Ae+=l*Ot,Fe+=l*$t,Ie+=l*Pt,Te+=l*Ct,Ke+=l*xt,xe+=l*ht,Ge+=l*Mt,We+=l*qt,l=Y[6],pt+=l*Et,gt+=l*_t,Me+=l*St,Pe+=l*It,je+=l*mt,De+=l*yt,qe+=l*Ut,Ae+=l*Lt,Fe+=l*Ot,Ie+=l*$t,Te+=l*Pt,Ke+=l*Ct,xe+=l*xt,Ge+=l*ht,We+=l*Mt,et+=l*qt,l=Y[7],gt+=l*Et,Me+=l*_t,Pe+=l*St,je+=l*It,De+=l*mt,qe+=l*yt,Ae+=l*Ut,Fe+=l*Lt,Ie+=l*Ot,Te+=l*$t,Ke+=l*Pt,xe+=l*Ct,Ge+=l*xt,We+=l*ht,et+=l*Mt,tt+=l*qt,l=Y[8],Me+=l*Et,Pe+=l*_t,je+=l*St,De+=l*It,qe+=l*mt,Ae+=l*yt,Fe+=l*Ut,Ie+=l*Lt,Te+=l*Ot,Ke+=l*$t,xe+=l*Pt,Ge+=l*Ct,We+=l*xt,et+=l*ht,tt+=l*Mt,Je+=l*qt,l=Y[9],Pe+=l*Et,je+=l*_t,De+=l*St,qe+=l*It,Ae+=l*mt,Fe+=l*yt,Ie+=l*Ut,Te+=l*Lt,Ke+=l*Ot,xe+=l*$t,Ge+=l*Pt,We+=l*Ct,et+=l*xt,tt+=l*ht,Je+=l*Mt,er+=l*qt,l=Y[10],je+=l*Et,De+=l*_t,qe+=l*St,Ae+=l*It,Fe+=l*mt,Ie+=l*yt,Te+=l*Ut,Ke+=l*Lt,xe+=l*Ot,Ge+=l*$t,We+=l*Pt,et+=l*Ct,tt+=l*xt,Je+=l*ht,er+=l*Mt,hr+=l*qt,l=Y[11],De+=l*Et,qe+=l*_t,Ae+=l*St,Fe+=l*It,Ie+=l*mt,Te+=l*yt,Ke+=l*Ut,xe+=l*Lt,Ge+=l*Ot,We+=l*$t,et+=l*Pt,tt+=l*Ct,Je+=l*xt,er+=l*ht,hr+=l*Mt,Gr+=l*qt,l=Y[12],qe+=l*Et,Ae+=l*_t,Fe+=l*St,Ie+=l*It,Te+=l*mt,Ke+=l*yt,xe+=l*Ut,Ge+=l*Lt,We+=l*Ot,et+=l*$t,tt+=l*Pt,Je+=l*Ct,er+=l*xt,hr+=l*ht,Gr+=l*Mt,tr+=l*qt,l=Y[13],Ae+=l*Et,Fe+=l*_t,Ie+=l*St,Te+=l*It,Ke+=l*mt,xe+=l*yt,Ge+=l*Ut,We+=l*Lt,et+=l*Ot,tt+=l*$t,Je+=l*Pt,er+=l*Ct,hr+=l*xt,Gr+=l*ht,tr+=l*Mt,ri+=l*qt,l=Y[14],Fe+=l*Et,Ie+=l*_t,Te+=l*St,Ke+=l*It,xe+=l*mt,Ge+=l*yt,We+=l*Ut,et+=l*Lt,tt+=l*Ot,Je+=l*$t,er+=l*Pt,hr+=l*Ct,Gr+=l*xt,tr+=l*ht,ri+=l*Mt,vi+=l*qt,l=Y[15],Ie+=l*Et,Te+=l*_t,Ke+=l*St,xe+=l*It,Ge+=l*mt,We+=l*yt,et+=l*Ut,tt+=l*Lt,Je+=l*Ot,er+=l*$t,hr+=l*Pt,Gr+=l*Ct,tr+=l*xt,ri+=l*ht,vi+=l*Mt,Di+=l*qt,he+=38*Te,pe+=38*Ke,Oe+=38*xe,He+=38*Ge,Ve+=38*We,Le+=38*et,pt+=38*tt,gt+=38*Je,Me+=38*er,Pe+=38*hr,je+=38*Gr,De+=38*tr,qe+=38*ri,Ae+=38*vi,Fe+=38*Di,D=1,l=he+D+65535,D=Math.floor(l/65536),he=l-D*65536,l=pe+D+65535,D=Math.floor(l/65536),pe=l-D*65536,l=Oe+D+65535,D=Math.floor(l/65536),Oe=l-D*65536,l=He+D+65535,D=Math.floor(l/65536),He=l-D*65536,l=Ve+D+65535,D=Math.floor(l/65536),Ve=l-D*65536,l=Le+D+65535,D=Math.floor(l/65536),Le=l-D*65536,l=pt+D+65535,D=Math.floor(l/65536),pt=l-D*65536,l=gt+D+65535,D=Math.floor(l/65536),gt=l-D*65536,l=Me+D+65535,D=Math.floor(l/65536),Me=l-D*65536,l=Pe+D+65535,D=Math.floor(l/65536),Pe=l-D*65536,l=je+D+65535,D=Math.floor(l/65536),je=l-D*65536,l=De+D+65535,D=Math.floor(l/65536),De=l-D*65536,l=qe+D+65535,D=Math.floor(l/65536),qe=l-D*65536,l=Ae+D+65535,D=Math.floor(l/65536),Ae=l-D*65536,l=Fe+D+65535,D=Math.floor(l/65536),Fe=l-D*65536,l=Ie+D+65535,D=Math.floor(l/65536),Ie=l-D*65536,he+=D-1+37*(D-1),D=1,l=he+D+65535,D=Math.floor(l/65536),he=l-D*65536,l=pe+D+65535,D=Math.floor(l/65536),pe=l-D*65536,l=Oe+D+65535,D=Math.floor(l/65536),Oe=l-D*65536,l=He+D+65535,D=Math.floor(l/65536),He=l-D*65536,l=Ve+D+65535,D=Math.floor(l/65536),Ve=l-D*65536,l=Le+D+65535,D=Math.floor(l/65536),Le=l-D*65536,l=pt+D+65535,D=Math.floor(l/65536),pt=l-D*65536,l=gt+D+65535,D=Math.floor(l/65536),gt=l-D*65536,l=Me+D+65535,D=Math.floor(l/65536),Me=l-D*65536,l=Pe+D+65535,D=Math.floor(l/65536),Pe=l-D*65536,l=je+D+65535,D=Math.floor(l/65536),je=l-D*65536,l=De+D+65535,D=Math.floor(l/65536),De=l-D*65536,l=qe+D+65535,D=Math.floor(l/65536),qe=l-D*65536,l=Ae+D+65535,D=Math.floor(l/65536),Ae=l-D*65536,l=Fe+D+65535,D=Math.floor(l/65536),Fe=l-D*65536,l=Ie+D+65535,D=Math.floor(l/65536),Ie=l-D*65536,he+=D-1+37*(D-1),J[0]=he,J[1]=pe,J[2]=Oe,J[3]=He,J[4]=Ve,J[5]=Le,J[6]=pt,J[7]=gt,J[8]=Me,J[9]=Pe,J[10]=je,J[11]=De,J[12]=qe,J[13]=Ae,J[14]=Fe,J[15]=Ie}function y(J,Y){u(J,Y,Y)}function X(J,Y){const z=o();let l;for(l=0;l<16;l++)z[l]=Y[l];for(l=253;l>=0;l--)y(z,z),l!==2&&l!==4&&u(z,z,Y);for(l=0;l<16;l++)J[l]=z[l]}function c(J,Y){const z=o();let l;for(l=0;l<16;l++)z[l]=Y[l];for(l=250;l>=0;l--)y(z,z),l!==1&&u(z,z,Y);for(l=0;l<16;l++)J[l]=z[l]}function f(J,Y){const z=o(),l=o(),D=o(),he=o(),pe=o(),Oe=o(),He=o(),Ve=o(),Le=o();O(z,J[1],J[0]),O(Le,Y[1],Y[0]),u(z,z,Le),j(l,J[0],J[1]),j(Le,Y[0],Y[1]),u(l,l,Le),u(D,J[3],Y[3]),u(D,D,A),u(he,J[2],Y[2]),j(he,he,he),O(pe,l,z),O(Oe,he,D),j(He,he,D),j(Ve,l,z),u(J[0],pe,Oe),u(J[1],Ve,He),u(J[2],He,Oe),u(J[3],pe,Ve)}function d(J,Y,z){for(let l=0;l<4;l++)Z(J[l],Y[l],z)}function w(J,Y){const z=o(),l=o(),D=o();X(D,Y[2]),u(z,Y[0],D),u(l,Y[1],D),Q(J,l),J[31]^=K(z)<<7}function _(J,Y,z){M(J[0],b),M(J[1],m),M(J[2],m),M(J[3],b);for(let l=255;l>=0;--l){const D=z[l/8|0]>>(l&7)&1;d(J,Y,D),f(Y,J),f(J,J),d(J,Y,D)}}function p(J,Y){const z=[o(),o(),o(),o()];M(z[0],C),M(z[1],$),M(z[2],m),u(z[3],C,$),_(J,z,Y)}function T(J){if(J.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const Y=(0,r.hash)(J);Y[0]&=248,Y[31]&=127,Y[31]|=64;const z=new Uint8Array(32),l=[o(),o(),o(),o()];p(l,Y),w(z,l);const D=new Uint8Array(64);return D.set(J),D.set(z,32),{publicKey:z,secretKey:D}}n.generateKeyPairFromSeed=T;function F(J){const Y=(0,t.randomBytes)(32,J),z=T(Y);return(0,s.wipe)(Y),z}n.generateKeyPair=F;function W(J){if(J.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(J.subarray(32))}n.extractPublicKeyFromSecretKey=W;const P=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function q(J,Y){let z,l,D,he;for(l=63;l>=32;--l){for(z=0,D=l-32,he=l-12;D<he;++D)Y[D]+=z-16*Y[l]*P[D-(l-32)],z=Math.floor((Y[D]+128)/256),Y[D]-=z*256;Y[D]+=z,Y[l]=0}for(z=0,D=0;D<32;D++)Y[D]+=z-(Y[31]>>4)*P[D],z=Y[D]>>8,Y[D]&=255;for(D=0;D<32;D++)Y[D]-=z*P[D];for(l=0;l<32;l++)Y[l+1]+=Y[l]>>8,J[l]=Y[l]&255}function te(J){const Y=new Float64Array(64);for(let z=0;z<64;z++)Y[z]=J[z];for(let z=0;z<64;z++)J[z]=0;q(J,Y)}function re(J,Y){const z=new Float64Array(64),l=[o(),o(),o(),o()],D=(0,r.hash)(J.subarray(0,32));D[0]&=248,D[31]&=127,D[31]|=64;const he=new Uint8Array(64);he.set(D.subarray(32),32);const pe=new r.SHA512;pe.update(he.subarray(32)),pe.update(Y);const Oe=pe.digest();pe.clean(),te(Oe),p(l,Oe),w(he,l),pe.reset(),pe.update(he.subarray(0,32)),pe.update(J.subarray(32)),pe.update(Y);const He=pe.digest();te(He);for(let Ve=0;Ve<32;Ve++)z[Ve]=Oe[Ve];for(let Ve=0;Ve<32;Ve++)for(let Le=0;Le<32;Le++)z[Ve+Le]+=He[Ve]*D[Le];return q(he.subarray(32),z),he}n.sign=re;function ie(J,Y){const z=o(),l=o(),D=o(),he=o(),pe=o(),Oe=o(),He=o();return M(J[2],m),N(J[1],Y),y(D,J[1]),u(he,D,E),O(D,D,J[2]),j(he,J[2],he),y(pe,he),y(Oe,pe),u(He,Oe,pe),u(z,He,D),u(z,z,he),c(z,z),u(z,z,D),u(z,z,he),u(z,z,he),u(J[0],z,he),y(l,J[0]),u(l,l,he),L(l,D)&&u(J[0],J[0],k),y(l,J[0]),u(l,l,he),L(l,D)?-1:(K(J[0])===Y[31]>>7&&O(J[0],b,J[0]),u(J[3],J[0],J[1]),0)}function ge(J,Y,z){const l=new Uint8Array(32),D=[o(),o(),o(),o()],he=[o(),o(),o(),o()];if(z.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ie(he,J))return!1;const pe=new r.SHA512;pe.update(z.subarray(0,32)),pe.update(J),pe.update(Y);const Oe=pe.digest();return te(Oe),_(D,he,Oe),p(he,z.subarray(32)),f(D,he),w(l,D),!ue(z,l)}n.verify=ge;function le(J){let Y=[o(),o(),o(),o()];if(ie(Y,J))throw new Error("Ed25519: invalid public key");let z=o(),l=o(),D=Y[1];j(z,m,D),O(l,m,D),X(l,l),u(z,z,l);let he=new Uint8Array(32);return Q(he,z),he}n.convertPublicKeyToX25519=le;function be(J){const Y=(0,r.hash)(J.subarray(0,32));Y[0]&=248,Y[31]&=127,Y[31]|=64;const z=new Uint8Array(Y.subarray(0,32));return(0,s.wipe)(Y),z}n.convertSecretKeyToX25519=be})(su);const hb="EdDSA",lb="JWT",_d=".",yd="base64url",fb="utf8",db="utf8",pb=":",gb="did",_b="key",Jl="base58btc",yb="z",vb="K36",mb=32;function Ra(n){return ur(yr(fs(n),fb),yd)}function vd(n){const t=yr(vb,Jl),r=yb+ur(Mc([t,n]),Jl);return[gb,_b,r].join(pb)}function bb(n){return ur(n,yd)}function wb(n){return yr([Ra(n.header),Ra(n.payload)].join(_d),db)}function Eb(n){return[Ra(n.header),Ra(n.payload),bb(n.signature)].join(_d)}function Xl(n=Rn.randomBytes(mb)){return su.generateKeyPairFromSeed(n)}async function Sb(n,t,r,s,o=me.fromMiliseconds(Date.now())){const g={alg:hb,typ:lb},b=vd(s.publicKey),m=o+r,E={iss:b,sub:n,aud:t,iat:o,exp:m},A=wb({header:g,payload:E}),C=su.sign(s.secretKey,A);return Eb({header:g,payload:E,signature:C})}var au={},za={};Object.defineProperty(za,"__esModule",{value:!0});var Qt=Ue,Bc=Ir,Ib=20;function Ob(n,t,r){for(var s=1634760805,o=857760878,g=2036477234,b=1797285236,m=r[3]<<24|r[2]<<16|r[1]<<8|r[0],E=r[7]<<24|r[6]<<16|r[5]<<8|r[4],A=r[11]<<24|r[10]<<16|r[9]<<8|r[8],C=r[15]<<24|r[14]<<16|r[13]<<8|r[12],$=r[19]<<24|r[18]<<16|r[17]<<8|r[16],k=r[23]<<24|r[22]<<16|r[21]<<8|r[20],M=r[27]<<24|r[26]<<16|r[25]<<8|r[24],H=r[31]<<24|r[30]<<16|r[29]<<8|r[28],Z=t[3]<<24|t[2]<<16|t[1]<<8|t[0],Q=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ue=t[11]<<24|t[10]<<16|t[9]<<8|t[8],L=t[15]<<24|t[14]<<16|t[13]<<8|t[12],K=s,N=o,j=g,O=b,u=m,y=E,X=A,c=C,f=$,d=k,w=M,_=H,p=Z,T=Q,F=ue,W=L,P=0;P<Ib;P+=2)K=K+u|0,p^=K,p=p>>>32-16|p<<16,f=f+p|0,u^=f,u=u>>>32-12|u<<12,N=N+y|0,T^=N,T=T>>>32-16|T<<16,d=d+T|0,y^=d,y=y>>>32-12|y<<12,j=j+X|0,F^=j,F=F>>>32-16|F<<16,w=w+F|0,X^=w,X=X>>>32-12|X<<12,O=O+c|0,W^=O,W=W>>>32-16|W<<16,_=_+W|0,c^=_,c=c>>>32-12|c<<12,j=j+X|0,F^=j,F=F>>>32-8|F<<8,w=w+F|0,X^=w,X=X>>>32-7|X<<7,O=O+c|0,W^=O,W=W>>>32-8|W<<8,_=_+W|0,c^=_,c=c>>>32-7|c<<7,N=N+y|0,T^=N,T=T>>>32-8|T<<8,d=d+T|0,y^=d,y=y>>>32-7|y<<7,K=K+u|0,p^=K,p=p>>>32-8|p<<8,f=f+p|0,u^=f,u=u>>>32-7|u<<7,K=K+y|0,W^=K,W=W>>>32-16|W<<16,w=w+W|0,y^=w,y=y>>>32-12|y<<12,N=N+X|0,p^=N,p=p>>>32-16|p<<16,_=_+p|0,X^=_,X=X>>>32-12|X<<12,j=j+c|0,T^=j,T=T>>>32-16|T<<16,f=f+T|0,c^=f,c=c>>>32-12|c<<12,O=O+u|0,F^=O,F=F>>>32-16|F<<16,d=d+F|0,u^=d,u=u>>>32-12|u<<12,j=j+c|0,T^=j,T=T>>>32-8|T<<8,f=f+T|0,c^=f,c=c>>>32-7|c<<7,O=O+u|0,F^=O,F=F>>>32-8|F<<8,d=d+F|0,u^=d,u=u>>>32-7|u<<7,N=N+X|0,p^=N,p=p>>>32-8|p<<8,_=_+p|0,X^=_,X=X>>>32-7|X<<7,K=K+y|0,W^=K,W=W>>>32-8|W<<8,w=w+W|0,y^=w,y=y>>>32-7|y<<7;Qt.writeUint32LE(K+s|0,n,0),Qt.writeUint32LE(N+o|0,n,4),Qt.writeUint32LE(j+g|0,n,8),Qt.writeUint32LE(O+b|0,n,12),Qt.writeUint32LE(u+m|0,n,16),Qt.writeUint32LE(y+E|0,n,20),Qt.writeUint32LE(X+A|0,n,24),Qt.writeUint32LE(c+C|0,n,28),Qt.writeUint32LE(f+$|0,n,32),Qt.writeUint32LE(d+k|0,n,36),Qt.writeUint32LE(w+M|0,n,40),Qt.writeUint32LE(_+H|0,n,44),Qt.writeUint32LE(p+Z|0,n,48),Qt.writeUint32LE(T+Q|0,n,52),Qt.writeUint32LE(F+ue|0,n,56),Qt.writeUint32LE(W+L|0,n,60)}function md(n,t,r,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var g,b;if(o===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");g=new Uint8Array(16),b=g.length-t.length,g.set(t,b)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");g=t,b=o}for(var m=new Uint8Array(64),E=0;E<r.length;E+=64){Ob(m,g,n);for(var A=E;A<E+64&&A<r.length;A++)s[A]=r[A]^m[A-E];xb(g,0,b)}return Bc.wipe(m),o===0&&Bc.wipe(g),s}za.streamXOR=md;function Pb(n,t,r,s){return s===void 0&&(s=0),Bc.wipe(r),md(n,t,r,r,s)}za.stream=Pb;function xb(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var bd={},Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});function Ab(n,t,r){return~(n-1)&t|n-1&r}Ri.select=Ab;function Tb(n,t){return(n|0)-(t|0)-1>>>31&1}Ri.lessOrEqual=Tb;function wd(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Ri.compare=wd;function Cb(n,t){return n.length===0||t.length===0?!1:wd(n,t)!==0}Ri.equal=Cb;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ri,r=Ir;n.DIGEST_LENGTH=16;var s=function(){function b(m){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var E=m[0]|m[1]<<8;this._r[0]=E&8191;var A=m[2]|m[3]<<8;this._r[1]=(E>>>13|A<<3)&8191;var C=m[4]|m[5]<<8;this._r[2]=(A>>>10|C<<6)&7939;var $=m[6]|m[7]<<8;this._r[3]=(C>>>7|$<<9)&8191;var k=m[8]|m[9]<<8;this._r[4]=($>>>4|k<<12)&255,this._r[5]=k>>>1&8190;var M=m[10]|m[11]<<8;this._r[6]=(k>>>14|M<<2)&8191;var H=m[12]|m[13]<<8;this._r[7]=(M>>>11|H<<5)&8065;var Z=m[14]|m[15]<<8;this._r[8]=(H>>>8|Z<<8)&8191,this._r[9]=Z>>>5&127,this._pad[0]=m[16]|m[17]<<8,this._pad[1]=m[18]|m[19]<<8,this._pad[2]=m[20]|m[21]<<8,this._pad[3]=m[22]|m[23]<<8,this._pad[4]=m[24]|m[25]<<8,this._pad[5]=m[26]|m[27]<<8,this._pad[6]=m[28]|m[29]<<8,this._pad[7]=m[30]|m[31]<<8}return b.prototype._blocks=function(m,E,A){for(var C=this._fin?0:2048,$=this._h[0],k=this._h[1],M=this._h[2],H=this._h[3],Z=this._h[4],Q=this._h[5],ue=this._h[6],L=this._h[7],K=this._h[8],N=this._h[9],j=this._r[0],O=this._r[1],u=this._r[2],y=this._r[3],X=this._r[4],c=this._r[5],f=this._r[6],d=this._r[7],w=this._r[8],_=this._r[9];A>=16;){var p=m[E+0]|m[E+1]<<8;$+=p&8191;var T=m[E+2]|m[E+3]<<8;k+=(p>>>13|T<<3)&8191;var F=m[E+4]|m[E+5]<<8;M+=(T>>>10|F<<6)&8191;var W=m[E+6]|m[E+7]<<8;H+=(F>>>7|W<<9)&8191;var P=m[E+8]|m[E+9]<<8;Z+=(W>>>4|P<<12)&8191,Q+=P>>>1&8191;var q=m[E+10]|m[E+11]<<8;ue+=(P>>>14|q<<2)&8191;var te=m[E+12]|m[E+13]<<8;L+=(q>>>11|te<<5)&8191;var re=m[E+14]|m[E+15]<<8;K+=(te>>>8|re<<8)&8191,N+=re>>>5|C;var ie=0,ge=ie;ge+=$*j,ge+=k*(5*_),ge+=M*(5*w),ge+=H*(5*d),ge+=Z*(5*f),ie=ge>>>13,ge&=8191,ge+=Q*(5*c),ge+=ue*(5*X),ge+=L*(5*y),ge+=K*(5*u),ge+=N*(5*O),ie+=ge>>>13,ge&=8191;var le=ie;le+=$*O,le+=k*j,le+=M*(5*_),le+=H*(5*w),le+=Z*(5*d),ie=le>>>13,le&=8191,le+=Q*(5*f),le+=ue*(5*c),le+=L*(5*X),le+=K*(5*y),le+=N*(5*u),ie+=le>>>13,le&=8191;var be=ie;be+=$*u,be+=k*O,be+=M*j,be+=H*(5*_),be+=Z*(5*w),ie=be>>>13,be&=8191,be+=Q*(5*d),be+=ue*(5*f),be+=L*(5*c),be+=K*(5*X),be+=N*(5*y),ie+=be>>>13,be&=8191;var J=ie;J+=$*y,J+=k*u,J+=M*O,J+=H*j,J+=Z*(5*_),ie=J>>>13,J&=8191,J+=Q*(5*w),J+=ue*(5*d),J+=L*(5*f),J+=K*(5*c),J+=N*(5*X),ie+=J>>>13,J&=8191;var Y=ie;Y+=$*X,Y+=k*y,Y+=M*u,Y+=H*O,Y+=Z*j,ie=Y>>>13,Y&=8191,Y+=Q*(5*_),Y+=ue*(5*w),Y+=L*(5*d),Y+=K*(5*f),Y+=N*(5*c),ie+=Y>>>13,Y&=8191;var z=ie;z+=$*c,z+=k*X,z+=M*y,z+=H*u,z+=Z*O,ie=z>>>13,z&=8191,z+=Q*j,z+=ue*(5*_),z+=L*(5*w),z+=K*(5*d),z+=N*(5*f),ie+=z>>>13,z&=8191;var l=ie;l+=$*f,l+=k*c,l+=M*X,l+=H*y,l+=Z*u,ie=l>>>13,l&=8191,l+=Q*O,l+=ue*j,l+=L*(5*_),l+=K*(5*w),l+=N*(5*d),ie+=l>>>13,l&=8191;var D=ie;D+=$*d,D+=k*f,D+=M*c,D+=H*X,D+=Z*y,ie=D>>>13,D&=8191,D+=Q*u,D+=ue*O,D+=L*j,D+=K*(5*_),D+=N*(5*w),ie+=D>>>13,D&=8191;var he=ie;he+=$*w,he+=k*d,he+=M*f,he+=H*c,he+=Z*X,ie=he>>>13,he&=8191,he+=Q*y,he+=ue*u,he+=L*O,he+=K*j,he+=N*(5*_),ie+=he>>>13,he&=8191;var pe=ie;pe+=$*_,pe+=k*w,pe+=M*d,pe+=H*f,pe+=Z*c,ie=pe>>>13,pe&=8191,pe+=Q*X,pe+=ue*y,pe+=L*u,pe+=K*O,pe+=N*j,ie+=pe>>>13,pe&=8191,ie=(ie<<2)+ie|0,ie=ie+ge|0,ge=ie&8191,ie=ie>>>13,le+=ie,$=ge,k=le,M=be,H=J,Z=Y,Q=z,ue=l,L=D,K=he,N=pe,E+=16,A-=16}this._h[0]=$,this._h[1]=k,this._h[2]=M,this._h[3]=H,this._h[4]=Z,this._h[5]=Q,this._h[6]=ue,this._h[7]=L,this._h[8]=K,this._h[9]=N},b.prototype.finish=function(m,E){E===void 0&&(E=0);var A=new Uint16Array(10),C,$,k,M;if(this._leftover){for(M=this._leftover,this._buffer[M++]=1;M<16;M++)this._buffer[M]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(C=this._h[1]>>>13,this._h[1]&=8191,M=2;M<10;M++)this._h[M]+=C,C=this._h[M]>>>13,this._h[M]&=8191;for(this._h[0]+=C*5,C=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=C,C=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=C,A[0]=this._h[0]+5,C=A[0]>>>13,A[0]&=8191,M=1;M<10;M++)A[M]=this._h[M]+C,C=A[M]>>>13,A[M]&=8191;for(A[9]-=8192,$=(C^1)-1,M=0;M<10;M++)A[M]&=$;for($=~$,M=0;M<10;M++)this._h[M]=this._h[M]&$|A[M];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,k=this._h[0]+this._pad[0],this._h[0]=k&65535,M=1;M<8;M++)k=(this._h[M]+this._pad[M]|0)+(k>>>16)|0,this._h[M]=k&65535;return m[E+0]=this._h[0]>>>0,m[E+1]=this._h[0]>>>8,m[E+2]=this._h[1]>>>0,m[E+3]=this._h[1]>>>8,m[E+4]=this._h[2]>>>0,m[E+5]=this._h[2]>>>8,m[E+6]=this._h[3]>>>0,m[E+7]=this._h[3]>>>8,m[E+8]=this._h[4]>>>0,m[E+9]=this._h[4]>>>8,m[E+10]=this._h[5]>>>0,m[E+11]=this._h[5]>>>8,m[E+12]=this._h[6]>>>0,m[E+13]=this._h[6]>>>8,m[E+14]=this._h[7]>>>0,m[E+15]=this._h[7]>>>8,this._finished=!0,this},b.prototype.update=function(m){var E=0,A=m.length,C;if(this._leftover){C=16-this._leftover,C>A&&(C=A);for(var $=0;$<C;$++)this._buffer[this._leftover+$]=m[E+$];if(A-=C,E+=C,this._leftover+=C,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(A>=16&&(C=A-A%16,this._blocks(m,E,C),E+=C,A-=C),A){for(var $=0;$<A;$++)this._buffer[this._leftover+$]=m[E+$];this._leftover+=A}return this},b.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var m=new Uint8Array(16);return this.finish(m),m},b.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},b}();n.Poly1305=s;function o(b,m){var E=new s(b);E.update(m);var A=E.digest();return E.clean(),A}n.oneTimeAuth=o;function g(b,m){return b.length!==n.DIGEST_LENGTH||m.length!==n.DIGEST_LENGTH?!1:t.equal(b,m)}n.equal=g})(bd);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=za,r=bd,s=Ir,o=Ue,g=Ri;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var b=new Uint8Array(16),m=function(){function E(A){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,A.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(A)}return E.prototype.seal=function(A,C,$,k){if(A.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var M=new Uint8Array(16);M.set(A,M.length-A.length);var H=new Uint8Array(32);t.stream(this._key,M,H,4);var Z=C.length+this.tagLength,Q;if(k){if(k.length!==Z)throw new Error("ChaCha20Poly1305: incorrect destination length");Q=k}else Q=new Uint8Array(Z);return t.streamXOR(this._key,M,C,Q,4),this._authenticate(Q.subarray(Q.length-this.tagLength,Q.length),H,Q.subarray(0,Q.length-this.tagLength),$),s.wipe(M),Q},E.prototype.open=function(A,C,$,k){if(A.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(C.length<this.tagLength)return null;var M=new Uint8Array(16);M.set(A,M.length-A.length);var H=new Uint8Array(32);t.stream(this._key,M,H,4);var Z=new Uint8Array(this.tagLength);if(this._authenticate(Z,H,C.subarray(0,C.length-this.tagLength),$),!g.equal(Z,C.subarray(C.length-this.tagLength,C.length)))return null;var Q=C.length-this.tagLength,ue;if(k){if(k.length!==Q)throw new Error("ChaCha20Poly1305: incorrect destination length");ue=k}else ue=new Uint8Array(Q);return t.streamXOR(this._key,M,C.subarray(0,C.length-this.tagLength),ue,4),s.wipe(M),ue},E.prototype.clean=function(){return s.wipe(this._key),this},E.prototype._authenticate=function(A,C,$,k){var M=new r.Poly1305(C);k&&(M.update(k),k.length%16>0&&M.update(b.subarray(k.length%16))),M.update($),$.length%16>0&&M.update(b.subarray($.length%16));var H=new Uint8Array(8);k&&o.writeUint64LE(k.length,H),M.update(H),o.writeUint64LE($.length,H),M.update(H);for(var Z=M.digest(),Q=0;Q<Z.length;Q++)A[Q]=Z[Q];M.clean(),s.wipe(Z),s.wipe(H)},E}();n.ChaCha20Poly1305=m})(au);var Ed={},_s={},ou={};Object.defineProperty(ou,"__esModule",{value:!0});function Rb(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}ou.isSerializableHash=Rb;Object.defineProperty(_s,"__esModule",{value:!0});var Zr=ou,Nb=Ri,jb=Ir,Sd=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Zr.isSerializableHash(this._inner)&&Zr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),jb.wipe(s)}return n.prototype.reset=function(){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Zr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Zr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();_s.HMAC=Sd;function Db(n,t,r){var s=new Sd(n,t);s.update(r);var o=s.digest();return s.clean(),o}_s.hmac=Db;_s.equal=Nb.equal;Object.defineProperty(Ed,"__esModule",{value:!0});var Zl=_s,Ql=Ir,Fb=function(){function n(t,r,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=o;var g=Zl.hmac(this._hash,s,r);this._hmac=new Zl.HMAC(t,g),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),Ql.wipe(this._buffer),Ql.wipe(this._counter),this._bufpos=0},n}(),Ub=Ed.HKDF=Fb,Ha={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ue,r=Ir;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function m(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return m.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},m.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},m.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},m.prototype.update=function(E,A){if(A===void 0&&(A=E.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var C=0;if(this._bytesHashed+=A,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&A>0;)this._buffer[this._bufferLength++]=E[C++],A--;this._bufferLength===this.blockSize&&(g(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(A>=this.blockSize&&(C=g(this._temp,this._state,E,C,A),A%=this.blockSize);A>0;)this._buffer[this._bufferLength++]=E[C++],A--;return this},m.prototype.finish=function(E){if(!this._finished){var A=this._bytesHashed,C=this._bufferLength,$=A/536870912|0,k=A<<3,M=A%64<56?64:128;this._buffer[C]=128;for(var H=C+1;H<M-8;H++)this._buffer[H]=0;t.writeUint32BE($,this._buffer,M-8),t.writeUint32BE(k,this._buffer,M-4),g(this._temp,this._state,this._buffer,0,M),this._finished=!0}for(var H=0;H<this.digestLength/4;H++)t.writeUint32BE(this._state[H],E,H*4);return this},m.prototype.digest=function(){var E=new Uint8Array(this.digestLength);return this.finish(E),E},m.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},m.prototype.restoreState=function(E){return this._state.set(E.state),this._bufferLength=E.bufferLength,E.buffer&&this._buffer.set(E.buffer),this._bytesHashed=E.bytesHashed,this._finished=!1,this},m.prototype.cleanSavedState=function(E){r.wipe(E.state),E.buffer&&r.wipe(E.buffer),E.bufferLength=0,E.bytesHashed=0},m}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function g(m,E,A,C,$){for(;$>=64;){for(var k=E[0],M=E[1],H=E[2],Z=E[3],Q=E[4],ue=E[5],L=E[6],K=E[7],N=0;N<16;N++){var j=C+N*4;m[N]=t.readUint32BE(A,j)}for(var N=16;N<64;N++){var O=m[N-2],u=(O>>>17|O<<32-17)^(O>>>19|O<<32-19)^O>>>10;O=m[N-15];var y=(O>>>7|O<<32-7)^(O>>>18|O<<32-18)^O>>>3;m[N]=(u+m[N-7]|0)+(y+m[N-16]|0)}for(var N=0;N<64;N++){var u=(((Q>>>6|Q<<26)^(Q>>>11|Q<<21)^(Q>>>25|Q<<7))+(Q&ue^~Q&L)|0)+(K+(o[N]+m[N]|0)|0)|0,y=((k>>>2|k<<32-2)^(k>>>13|k<<32-13)^(k>>>22|k<<32-22))+(k&M^k&H^M&H)|0;K=L,L=ue,ue=Q,Q=Z+u|0,Z=H,H=M,M=k,k=u+y|0}E[0]+=k,E[1]+=M,E[2]+=H,E[3]+=Z,E[4]+=Q,E[5]+=ue,E[6]+=L,E[7]+=K,C+=64,$-=64}return C}function b(m){var E=new s;E.update(m);var A=E.digest();return E.clean(),A}n.hash=b})(Ha);var cu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=Rn,r=Ir;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(N){const j=new Float64Array(16);if(N)for(let O=0;O<N.length;O++)j[O]=N[O];return j}const o=new Uint8Array(32);o[0]=9;const g=s([56129,1]);function b(N){let j=1;for(let O=0;O<16;O++){let u=N[O]+j+65535;j=Math.floor(u/65536),N[O]=u-j*65536}N[0]+=j-1+37*(j-1)}function m(N,j,O){const u=~(O-1);for(let y=0;y<16;y++){const X=u&(N[y]^j[y]);N[y]^=X,j[y]^=X}}function E(N,j){const O=s(),u=s();for(let y=0;y<16;y++)u[y]=j[y];b(u),b(u),b(u);for(let y=0;y<2;y++){O[0]=u[0]-65517;for(let c=1;c<15;c++)O[c]=u[c]-65535-(O[c-1]>>16&1),O[c-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const X=O[15]>>16&1;O[14]&=65535,m(u,O,1-X)}for(let y=0;y<16;y++)N[2*y]=u[y]&255,N[2*y+1]=u[y]>>8}function A(N,j){for(let O=0;O<16;O++)N[O]=j[2*O]+(j[2*O+1]<<8);N[15]&=32767}function C(N,j,O){for(let u=0;u<16;u++)N[u]=j[u]+O[u]}function $(N,j,O){for(let u=0;u<16;u++)N[u]=j[u]-O[u]}function k(N,j,O){let u,y,X=0,c=0,f=0,d=0,w=0,_=0,p=0,T=0,F=0,W=0,P=0,q=0,te=0,re=0,ie=0,ge=0,le=0,be=0,J=0,Y=0,z=0,l=0,D=0,he=0,pe=0,Oe=0,He=0,Ve=0,Le=0,pt=0,gt=0,Me=O[0],Pe=O[1],je=O[2],De=O[3],qe=O[4],Ae=O[5],Fe=O[6],Ie=O[7],Te=O[8],Ke=O[9],xe=O[10],Ge=O[11],We=O[12],et=O[13],tt=O[14],Je=O[15];u=j[0],X+=u*Me,c+=u*Pe,f+=u*je,d+=u*De,w+=u*qe,_+=u*Ae,p+=u*Fe,T+=u*Ie,F+=u*Te,W+=u*Ke,P+=u*xe,q+=u*Ge,te+=u*We,re+=u*et,ie+=u*tt,ge+=u*Je,u=j[1],c+=u*Me,f+=u*Pe,d+=u*je,w+=u*De,_+=u*qe,p+=u*Ae,T+=u*Fe,F+=u*Ie,W+=u*Te,P+=u*Ke,q+=u*xe,te+=u*Ge,re+=u*We,ie+=u*et,ge+=u*tt,le+=u*Je,u=j[2],f+=u*Me,d+=u*Pe,w+=u*je,_+=u*De,p+=u*qe,T+=u*Ae,F+=u*Fe,W+=u*Ie,P+=u*Te,q+=u*Ke,te+=u*xe,re+=u*Ge,ie+=u*We,ge+=u*et,le+=u*tt,be+=u*Je,u=j[3],d+=u*Me,w+=u*Pe,_+=u*je,p+=u*De,T+=u*qe,F+=u*Ae,W+=u*Fe,P+=u*Ie,q+=u*Te,te+=u*Ke,re+=u*xe,ie+=u*Ge,ge+=u*We,le+=u*et,be+=u*tt,J+=u*Je,u=j[4],w+=u*Me,_+=u*Pe,p+=u*je,T+=u*De,F+=u*qe,W+=u*Ae,P+=u*Fe,q+=u*Ie,te+=u*Te,re+=u*Ke,ie+=u*xe,ge+=u*Ge,le+=u*We,be+=u*et,J+=u*tt,Y+=u*Je,u=j[5],_+=u*Me,p+=u*Pe,T+=u*je,F+=u*De,W+=u*qe,P+=u*Ae,q+=u*Fe,te+=u*Ie,re+=u*Te,ie+=u*Ke,ge+=u*xe,le+=u*Ge,be+=u*We,J+=u*et,Y+=u*tt,z+=u*Je,u=j[6],p+=u*Me,T+=u*Pe,F+=u*je,W+=u*De,P+=u*qe,q+=u*Ae,te+=u*Fe,re+=u*Ie,ie+=u*Te,ge+=u*Ke,le+=u*xe,be+=u*Ge,J+=u*We,Y+=u*et,z+=u*tt,l+=u*Je,u=j[7],T+=u*Me,F+=u*Pe,W+=u*je,P+=u*De,q+=u*qe,te+=u*Ae,re+=u*Fe,ie+=u*Ie,ge+=u*Te,le+=u*Ke,be+=u*xe,J+=u*Ge,Y+=u*We,z+=u*et,l+=u*tt,D+=u*Je,u=j[8],F+=u*Me,W+=u*Pe,P+=u*je,q+=u*De,te+=u*qe,re+=u*Ae,ie+=u*Fe,ge+=u*Ie,le+=u*Te,be+=u*Ke,J+=u*xe,Y+=u*Ge,z+=u*We,l+=u*et,D+=u*tt,he+=u*Je,u=j[9],W+=u*Me,P+=u*Pe,q+=u*je,te+=u*De,re+=u*qe,ie+=u*Ae,ge+=u*Fe,le+=u*Ie,be+=u*Te,J+=u*Ke,Y+=u*xe,z+=u*Ge,l+=u*We,D+=u*et,he+=u*tt,pe+=u*Je,u=j[10],P+=u*Me,q+=u*Pe,te+=u*je,re+=u*De,ie+=u*qe,ge+=u*Ae,le+=u*Fe,be+=u*Ie,J+=u*Te,Y+=u*Ke,z+=u*xe,l+=u*Ge,D+=u*We,he+=u*et,pe+=u*tt,Oe+=u*Je,u=j[11],q+=u*Me,te+=u*Pe,re+=u*je,ie+=u*De,ge+=u*qe,le+=u*Ae,be+=u*Fe,J+=u*Ie,Y+=u*Te,z+=u*Ke,l+=u*xe,D+=u*Ge,he+=u*We,pe+=u*et,Oe+=u*tt,He+=u*Je,u=j[12],te+=u*Me,re+=u*Pe,ie+=u*je,ge+=u*De,le+=u*qe,be+=u*Ae,J+=u*Fe,Y+=u*Ie,z+=u*Te,l+=u*Ke,D+=u*xe,he+=u*Ge,pe+=u*We,Oe+=u*et,He+=u*tt,Ve+=u*Je,u=j[13],re+=u*Me,ie+=u*Pe,ge+=u*je,le+=u*De,be+=u*qe,J+=u*Ae,Y+=u*Fe,z+=u*Ie,l+=u*Te,D+=u*Ke,he+=u*xe,pe+=u*Ge,Oe+=u*We,He+=u*et,Ve+=u*tt,Le+=u*Je,u=j[14],ie+=u*Me,ge+=u*Pe,le+=u*je,be+=u*De,J+=u*qe,Y+=u*Ae,z+=u*Fe,l+=u*Ie,D+=u*Te,he+=u*Ke,pe+=u*xe,Oe+=u*Ge,He+=u*We,Ve+=u*et,Le+=u*tt,pt+=u*Je,u=j[15],ge+=u*Me,le+=u*Pe,be+=u*je,J+=u*De,Y+=u*qe,z+=u*Ae,l+=u*Fe,D+=u*Ie,he+=u*Te,pe+=u*Ke,Oe+=u*xe,He+=u*Ge,Ve+=u*We,Le+=u*et,pt+=u*tt,gt+=u*Je,X+=38*le,c+=38*be,f+=38*J,d+=38*Y,w+=38*z,_+=38*l,p+=38*D,T+=38*he,F+=38*pe,W+=38*Oe,P+=38*He,q+=38*Ve,te+=38*Le,re+=38*pt,ie+=38*gt,y=1,u=X+y+65535,y=Math.floor(u/65536),X=u-y*65536,u=c+y+65535,y=Math.floor(u/65536),c=u-y*65536,u=f+y+65535,y=Math.floor(u/65536),f=u-y*65536,u=d+y+65535,y=Math.floor(u/65536),d=u-y*65536,u=w+y+65535,y=Math.floor(u/65536),w=u-y*65536,u=_+y+65535,y=Math.floor(u/65536),_=u-y*65536,u=p+y+65535,y=Math.floor(u/65536),p=u-y*65536,u=T+y+65535,y=Math.floor(u/65536),T=u-y*65536,u=F+y+65535,y=Math.floor(u/65536),F=u-y*65536,u=W+y+65535,y=Math.floor(u/65536),W=u-y*65536,u=P+y+65535,y=Math.floor(u/65536),P=u-y*65536,u=q+y+65535,y=Math.floor(u/65536),q=u-y*65536,u=te+y+65535,y=Math.floor(u/65536),te=u-y*65536,u=re+y+65535,y=Math.floor(u/65536),re=u-y*65536,u=ie+y+65535,y=Math.floor(u/65536),ie=u-y*65536,u=ge+y+65535,y=Math.floor(u/65536),ge=u-y*65536,X+=y-1+37*(y-1),y=1,u=X+y+65535,y=Math.floor(u/65536),X=u-y*65536,u=c+y+65535,y=Math.floor(u/65536),c=u-y*65536,u=f+y+65535,y=Math.floor(u/65536),f=u-y*65536,u=d+y+65535,y=Math.floor(u/65536),d=u-y*65536,u=w+y+65535,y=Math.floor(u/65536),w=u-y*65536,u=_+y+65535,y=Math.floor(u/65536),_=u-y*65536,u=p+y+65535,y=Math.floor(u/65536),p=u-y*65536,u=T+y+65535,y=Math.floor(u/65536),T=u-y*65536,u=F+y+65535,y=Math.floor(u/65536),F=u-y*65536,u=W+y+65535,y=Math.floor(u/65536),W=u-y*65536,u=P+y+65535,y=Math.floor(u/65536),P=u-y*65536,u=q+y+65535,y=Math.floor(u/65536),q=u-y*65536,u=te+y+65535,y=Math.floor(u/65536),te=u-y*65536,u=re+y+65535,y=Math.floor(u/65536),re=u-y*65536,u=ie+y+65535,y=Math.floor(u/65536),ie=u-y*65536,u=ge+y+65535,y=Math.floor(u/65536),ge=u-y*65536,X+=y-1+37*(y-1),N[0]=X,N[1]=c,N[2]=f,N[3]=d,N[4]=w,N[5]=_,N[6]=p,N[7]=T,N[8]=F,N[9]=W,N[10]=P,N[11]=q,N[12]=te,N[13]=re,N[14]=ie,N[15]=ge}function M(N,j){k(N,j,j)}function H(N,j){const O=s();for(let u=0;u<16;u++)O[u]=j[u];for(let u=253;u>=0;u--)M(O,O),u!==2&&u!==4&&k(O,O,j);for(let u=0;u<16;u++)N[u]=O[u]}function Z(N,j){const O=new Uint8Array(32),u=new Float64Array(80),y=s(),X=s(),c=s(),f=s(),d=s(),w=s();for(let F=0;F<31;F++)O[F]=N[F];O[31]=N[31]&127|64,O[0]&=248,A(u,j);for(let F=0;F<16;F++)X[F]=u[F];y[0]=f[0]=1;for(let F=254;F>=0;--F){const W=O[F>>>3]>>>(F&7)&1;m(y,X,W),m(c,f,W),C(d,y,c),$(y,y,c),C(c,X,f),$(X,X,f),M(f,d),M(w,y),k(y,c,y),k(c,X,d),C(d,y,c),$(y,y,c),M(X,y),$(c,f,w),k(y,c,g),C(y,y,f),k(c,c,y),k(y,f,w),k(f,X,u),M(X,d),m(y,X,W),m(c,f,W)}for(let F=0;F<16;F++)u[F+16]=y[F],u[F+32]=c[F],u[F+48]=X[F],u[F+64]=f[F];const _=u.subarray(32),p=u.subarray(16);H(_,_),k(p,p,_);const T=new Uint8Array(32);return E(T,p),T}n.scalarMult=Z;function Q(N){return Z(N,o)}n.scalarMultBase=Q;function ue(N){if(N.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const j=new Uint8Array(N);return{publicKey:Q(j),secretKey:j}}n.generateKeyPairFromSeed=ue;function L(N){const j=(0,t.randomBytes)(32,N),O=ue(j);return(0,r.wipe)(j),O}n.generateKeyPair=L;function K(N,j,O=!1){if(N.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(j.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=Z(N,j);if(O){let y=0;for(let X=0;X<u.length;X++)y|=u[X];if(y===0)throw new Error("X25519: invalid shared key")}return u}n.sharedKey=K})(cu);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Od=lt.getLocation=lt.getLocationOrThrow=uu=lt.getNavigator=lt.getNavigatorOrThrow=Id=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function tn(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}lt.getFromWindow=tn;function Nn(n){const t=tn(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}lt.getFromWindowOrThrow=Nn;function Lb(){return Nn("document")}lt.getDocumentOrThrow=Lb;function $b(){return tn("document")}var Id=lt.getDocument=$b;function Mb(){return Nn("navigator")}lt.getNavigatorOrThrow=Mb;function qb(){return tn("navigator")}var uu=lt.getNavigator=qb;function zb(){return Nn("location")}lt.getLocationOrThrow=zb;function Hb(){return tn("location")}var Od=lt.getLocation=Hb;function Kb(){return Nn("crypto")}lt.getCryptoOrThrow=Kb;function Bb(){return tn("crypto")}lt.getCrypto=Bb;function Vb(){return Nn("localStorage")}lt.getLocalStorageOrThrow=Vb;function Gb(){return tn("localStorage")}lt.getLocalStorage=Gb;var hu={};Object.defineProperty(hu,"__esModule",{value:!0});var Pd=hu.getWindowMetadata=void 0;const ef=lt;function kb(){let n,t;try{n=ef.getDocumentOrThrow(),t=ef.getLocationOrThrow()}catch{return null}function r(){const $=n.getElementsByTagName("link"),k=[];for(let M=0;M<$.length;M++){const H=$[M],Z=H.getAttribute("rel");if(Z&&Z.toLowerCase().indexOf("icon")>-1){const Q=H.getAttribute("href");if(Q)if(Q.toLowerCase().indexOf("https:")===-1&&Q.toLowerCase().indexOf("http:")===-1&&Q.indexOf("//")!==0){let ue=t.protocol+"//"+t.host;if(Q.indexOf("/")===0)ue+=Q;else{const L=t.pathname.split("/");L.pop();const K=L.join("/");ue+=K+"/"+Q}k.push(ue)}else if(Q.indexOf("//")===0){const ue=t.protocol+Q;k.push(ue)}else k.push(Q)}}return k}function s(...$){const k=n.getElementsByTagName("meta");for(let M=0;M<k.length;M++){const H=k[M],Z=["itemprop","property","name"].map(Q=>H.getAttribute(Q)).filter(Q=>Q?$.includes(Q):!1);if(Z.length&&Z){const Q=H.getAttribute("content");if(Q)return Q}}return""}function o(){let $=s("name","og:site_name","og:title","twitter:title");return $||($=n.title),$}function g(){return s("description","og:description","twitter:description","keywords")}const b=o(),m=g(),E=t.origin,A=r();return{description:m,url:E,icons:A,name:b}}Pd=hu.getWindowMetadata=kb;var ds={},Wb=n=>encodeURIComponent(n).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),xd="%[a-f0-9]{2}",tf=new RegExp("("+xd+")|([^%]+?)","gi"),rf=new RegExp("("+xd+")+","gi");function Vc(n,t){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;t=t||1;var r=n.slice(0,t),s=n.slice(t);return Array.prototype.concat.call([],Vc(r),Vc(s))}function Yb(n){try{return decodeURIComponent(n)}catch{for(var t=n.match(tf)||[],r=1;r<t.length;r++)n=Vc(t,r).join(""),t=n.match(tf)||[];return n}}function Jb(n){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=rf.exec(n);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var s=Yb(r[0]);s!==r[0]&&(t[r[0]]=s)}r=rf.exec(n)}t["%C2"]="�";for(var o=Object.keys(t),g=0;g<o.length;g++){var b=o[g];n=n.replace(new RegExp(b,"g"),t[b])}return n}var Xb=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return Jb(n)}},Zb=(n,t)=>{if(!(typeof n=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[n];const r=n.indexOf(t);return r===-1?[n]:[n.slice(0,r),n.slice(r+t.length)]},Qb=function(n,t){for(var r={},s=Object.keys(n),o=Array.isArray(t),g=0;g<s.length;g++){var b=s[g],m=n[b];(o?t.indexOf(b)!==-1:t(b,m,n))&&(r[b]=m)}return r};(function(n){const t=Wb,r=Xb,s=Zb,o=Qb,g=L=>L==null,b=Symbol("encodeFragmentIdentifier");function m(L){switch(L.arrayFormat){case"index":return K=>(N,j)=>{const O=N.length;return j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,[C(K,L),"[",O,"]"].join("")]:[...N,[C(K,L),"[",C(O,L),"]=",C(j,L)].join("")]};case"bracket":return K=>(N,j)=>j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,[C(K,L),"[]"].join("")]:[...N,[C(K,L),"[]=",C(j,L)].join("")];case"colon-list-separator":return K=>(N,j)=>j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,[C(K,L),":list="].join("")]:[...N,[C(K,L),":list=",C(j,L)].join("")];case"comma":case"separator":case"bracket-separator":{const K=L.arrayFormat==="bracket-separator"?"[]=":"=";return N=>(j,O)=>O===void 0||L.skipNull&&O===null||L.skipEmptyString&&O===""?j:(O=O===null?"":O,j.length===0?[[C(N,L),K,C(O,L)].join("")]:[[j,C(O,L)].join(L.arrayFormatSeparator)])}default:return K=>(N,j)=>j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,C(K,L)]:[...N,[C(K,L),"=",C(j,L)].join("")]}}function E(L){let K;switch(L.arrayFormat){case"index":return(N,j,O)=>{if(K=/\[(\d*)\]$/.exec(N),N=N.replace(/\[\d*\]$/,""),!K){O[N]=j;return}O[N]===void 0&&(O[N]={}),O[N][K[1]]=j};case"bracket":return(N,j,O)=>{if(K=/(\[\])$/.exec(N),N=N.replace(/\[\]$/,""),!K){O[N]=j;return}if(O[N]===void 0){O[N]=[j];return}O[N]=[].concat(O[N],j)};case"colon-list-separator":return(N,j,O)=>{if(K=/(:list)$/.exec(N),N=N.replace(/:list$/,""),!K){O[N]=j;return}if(O[N]===void 0){O[N]=[j];return}O[N]=[].concat(O[N],j)};case"comma":case"separator":return(N,j,O)=>{const u=typeof j=="string"&&j.includes(L.arrayFormatSeparator),y=typeof j=="string"&&!u&&$(j,L).includes(L.arrayFormatSeparator);j=y?$(j,L):j;const X=u||y?j.split(L.arrayFormatSeparator).map(c=>$(c,L)):j===null?j:$(j,L);O[N]=X};case"bracket-separator":return(N,j,O)=>{const u=/(\[\])$/.test(N);if(N=N.replace(/\[\]$/,""),!u){O[N]=j&&$(j,L);return}const y=j===null?[]:j.split(L.arrayFormatSeparator).map(X=>$(X,L));if(O[N]===void 0){O[N]=y;return}O[N]=[].concat(O[N],y)};default:return(N,j,O)=>{if(O[N]===void 0){O[N]=j;return}O[N]=[].concat(O[N],j)}}}function A(L){if(typeof L!="string"||L.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(L,K){return K.encode?K.strict?t(L):encodeURIComponent(L):L}function $(L,K){return K.decode?r(L):L}function k(L){return Array.isArray(L)?L.sort():typeof L=="object"?k(Object.keys(L)).sort((K,N)=>Number(K)-Number(N)).map(K=>L[K]):L}function M(L){const K=L.indexOf("#");return K!==-1&&(L=L.slice(0,K)),L}function H(L){let K="";const N=L.indexOf("#");return N!==-1&&(K=L.slice(N)),K}function Z(L){L=M(L);const K=L.indexOf("?");return K===-1?"":L.slice(K+1)}function Q(L,K){return K.parseNumbers&&!Number.isNaN(Number(L))&&typeof L=="string"&&L.trim()!==""?L=Number(L):K.parseBooleans&&L!==null&&(L.toLowerCase()==="true"||L.toLowerCase()==="false")&&(L=L.toLowerCase()==="true"),L}function ue(L,K){K=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},K),A(K.arrayFormatSeparator);const N=E(K),j=Object.create(null);if(typeof L!="string"||(L=L.trim().replace(/^[?#&]/,""),!L))return j;for(const O of L.split("&")){if(O==="")continue;let[u,y]=s(K.decode?O.replace(/\+/g," "):O,"=");y=y===void 0?null:["comma","separator","bracket-separator"].includes(K.arrayFormat)?y:$(y,K),N($(u,K),y,j)}for(const O of Object.keys(j)){const u=j[O];if(typeof u=="object"&&u!==null)for(const y of Object.keys(u))u[y]=Q(u[y],K);else j[O]=Q(u,K)}return K.sort===!1?j:(K.sort===!0?Object.keys(j).sort():Object.keys(j).sort(K.sort)).reduce((O,u)=>{const y=j[u];return y&&typeof y=="object"&&!Array.isArray(y)?O[u]=k(y):O[u]=y,O},Object.create(null))}n.extract=Z,n.parse=ue,n.stringify=(L,K)=>{if(!L)return"";K=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},K),A(K.arrayFormatSeparator);const N=y=>K.skipNull&&g(L[y])||K.skipEmptyString&&L[y]==="",j=m(K),O={};for(const y of Object.keys(L))N(y)||(O[y]=L[y]);const u=Object.keys(O);return K.sort!==!1&&u.sort(K.sort),u.map(y=>{const X=L[y];return X===void 0?"":X===null?C(y,K):Array.isArray(X)?X.length===0&&K.arrayFormat==="bracket-separator"?C(y,K)+"[]":X.reduce(j(y),[]).join("&"):C(y,K)+"="+C(X,K)}).filter(y=>y.length>0).join("&")},n.parseUrl=(L,K)=>{K=Object.assign({decode:!0},K);const[N,j]=s(L,"#");return Object.assign({url:N.split("?")[0]||"",query:ue(Z(L),K)},K&&K.parseFragmentIdentifier&&j?{fragmentIdentifier:$(j,K)}:{})},n.stringifyUrl=(L,K)=>{K=Object.assign({encode:!0,strict:!0,[b]:!0},K);const N=M(L.url).split("?")[0]||"",j=n.extract(L.url),O=n.parse(j,{sort:!1}),u=Object.assign(O,L.query);let y=n.stringify(u,K);y&&(y=`?${y}`);let X=H(L.url);return L.fragmentIdentifier&&(X=`#${K[b]?C(L.fragmentIdentifier,K):L.fragmentIdentifier}`),`${N}${y}${X}`},n.pick=(L,K,N)=>{N=Object.assign({parseFragmentIdentifier:!0,[b]:!1},N);const{url:j,query:O,fragmentIdentifier:u}=n.parseUrl(L,N);return n.stringifyUrl({url:j,query:o(O,K),fragmentIdentifier:u},N)},n.exclude=(L,K,N)=>{const j=Array.isArray(K)?O=>!K.includes(O):(O,u)=>!K(O,u);return n.pick(L,j,N)}})(ds);const ew={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function tw(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const o=n[s];r.push(...o.accounts)}),r}function Ad(n,t){return n.includes(":")?[n]:t.chains||[]}const Td="base10",cr="base16",Gc="base64pad",lu="utf8",Cd=0,rn=1,rw=0,nf=1,kc=12,fu=32;function iw(){const n=cu.generateKeyPair();return{privateKey:ur(n.secretKey,cr),publicKey:ur(n.publicKey,cr)}}function Wc(){const n=Rn.randomBytes(fu);return ur(n,cr)}function nw(n,t){const r=cu.sharedKey(yr(n,cr),yr(t,cr)),s=new Ub(Ha.SHA256,r).expand(fu);return ur(s,cr)}function sw(n){const t=Ha.hash(yr(n,cr));return ur(t,cr)}function Tn(n){const t=Ha.hash(yr(n,lu));return ur(t,cr)}function aw(n){return yr(`${n}`,Td)}function ys(n){return Number(ur(n,Td))}function ow(n){const t=aw(typeof n.type<"u"?n.type:Cd);if(ys(t)===rn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?yr(n.senderPublicKey,cr):void 0,s=typeof n.iv<"u"?yr(n.iv,cr):Rn.randomBytes(kc),o=new au.ChaCha20Poly1305(yr(n.symKey,cr)).seal(s,yr(n.message,lu));return uw({type:t,sealed:o,iv:s,senderPublicKey:r})}function cw(n){const t=new au.ChaCha20Poly1305(yr(n.symKey,cr)),{sealed:r,iv:s}=Na(n.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return ur(o,lu)}function uw(n){if(ys(n.type)===rn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(Mc([n.type,n.senderPublicKey,n.iv,n.sealed]),Gc)}return ur(Mc([n.type,n.iv,n.sealed]),Gc)}function Na(n){const t=yr(n,Gc),r=t.slice(rw,nf),s=nf;if(ys(r)===rn){const m=s+fu,E=m+kc,A=t.slice(s,m),C=t.slice(m,E),$=t.slice(E);return{type:r,sealed:$,iv:C,senderPublicKey:A}}const o=s+kc,g=t.slice(s,o),b=t.slice(o);return{type:r,sealed:b,iv:g}}function hw(n,t){const r=Na(n);return Rd({type:ys(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ur(r.senderPublicKey,cr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Rd(n){const t=(n==null?void 0:n.type)||Cd;if(t===rn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function sf(n){return n.type===rn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var lw=Object.defineProperty,af=Object.getOwnPropertySymbols,fw=Object.prototype.hasOwnProperty,dw=Object.prototype.propertyIsEnumerable,of=(n,t,r)=>t in n?lw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,cf=(n,t)=>{for(var r in t||(t={}))fw.call(t,r)&&of(n,r,t[r]);if(af)for(var r of af(t))dw.call(t,r)&&of(n,r,t[r]);return n};const pw="ReactNative",Zi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},gw="js";function du(){return typeof An<"u"&&typeof An.versions<"u"&&typeof An.versions.node<"u"}function Nd(){return!Id()&&!!uu()&&navigator.product===pw}function pu(){return!du()&&!!uu()}function jd(){return Nd()?Zi.reactNative:du()?Zi.node:pu()?Zi.browser:Zi.unknown}function _w(n,t){let r=ds.parse(n);return r=cf(cf({},r),t),n=ds.stringify(r),n}function yw(){return Pd()||{name:"",description:"",url:"",icons:[""]}}function vw(){if(typeof(Vr==null?void 0:Vr.Platform)<"u"){const{OS:r,Version:s}=Vr.Platform;return[r,s].join("-")}const n=k1();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function mw(){var n;const t=jd();return t===Zi.browser?[t,((n=Od())==null?void 0:n.host)||"unknown"].join(":"):t}function bw(n,t,r){const s=vw(),o=mw();return[[n,t].join("-"),[gw,r].join("-"),s,o].join("/")}function ww({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:g,useOnCloseEvent:b}){const m=r.split("?"),E=bw(n,t,s),A={auth:o,ua:E,projectId:g,useOnCloseEvent:b||void 0},C=_w(m[1]||"",A);return m[0]+"?"+C}function Qi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Dd(n){return Object.fromEntries(n.entries())}function Fd(n){return new Map(Object.entries(n))}function xn(n=me.FIVE_MINUTES,t){const r=me.toMiliseconds(n||me.FIVE_MINUTES);let s,o,g;return{resolve:b=>{g&&s&&(clearTimeout(g),s(b))},reject:b=>{g&&o&&(clearTimeout(g),o(b))},done:()=>new Promise((b,m)=>{g=setTimeout(()=>{m(new Error(t))},r),s=b,o=m})}}function ja(n,t,r){return new Promise(async(s,o)=>{const g=setTimeout(()=>o(new Error(r)),t);try{const b=await n;s(b)}catch(b){o(b)}clearTimeout(g)})}function Ud(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function Ew(n){return Ud("topic",n)}function Sw(n){return Ud("id",n)}function Ld(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function ti(n,t){return me.fromMiliseconds((t||Date.now())+me.toMiliseconds(n))}function Ti(n){return Date.now()>=me.toMiliseconds(n)}function Kt(n,t){return`${n}${t?`:${t}`:""}`}function Ac(n=[],t=[]){return[...new Set([...n,...t])]}async function Iw({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const g=`${o}/wc?requestId=${n}&sessionTopic=${t}`,b=jd();b===Zi.browser?window.open(g,"_self","noreferrer noopener"):b===Zi.reactNative&&typeof(Vr==null?void 0:Vr.Linking)<"u"&&await Vr.Linking.openURL(g)}catch(s){console.error(s)}}const Ow="irn";function Yc(n){return(n==null?void 0:n.relay)||{protocol:Ow}}function Pa(n){const t=ew[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Pw=Object.defineProperty,uf=Object.getOwnPropertySymbols,xw=Object.prototype.hasOwnProperty,Aw=Object.prototype.propertyIsEnumerable,hf=(n,t,r)=>t in n?Pw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Tw=(n,t)=>{for(var r in t||(t={}))xw.call(t,r)&&hf(n,r,t[r]);if(uf)for(var r of uf(t))Aw.call(t,r)&&hf(n,r,t[r]);return n};function Cw(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const g=o.replace(s,""),b=n[o];r[g]=b}}),r}function Rw(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),o=n.substring(t+1,r).split("@"),g=typeof r<"u"?n.substring(r):"",b=ds.parse(g);return{protocol:s,topic:Nw(o[0]),version:parseInt(o[1],10),symKey:b.symKey,relay:Cw(b)}}function Nw(n){return n.startsWith("//")?n.substring(2):n}function jw(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(o=>{const g=r+t+o;n[o]&&(s[g]=n[o])}),s}function Dw(n){return`${n.protocol}:${n.topic}@${n.version}?`+ds.stringify(Tw({symKey:n.symKey},jw(n.relay)))}function jn(n){const t=[];return n.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function Fw(n){const t=[];return Object.values(n).forEach(r=>{t.push(...jn(r.accounts))}),t}function Uw(n,t){const r=[];return Object.values(n).forEach(s=>{jn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function Lw(n,t){const r=[];return Object.values(n).forEach(s=>{jn(s.accounts).includes(t)&&r.push(...s.events)}),r}function $w(n,t){const r=Aa(n,t);if(r)throw new Error(r.message);const s={};for(const[o,g]of Object.entries(n))s[o]={methods:g.methods,events:g.events,chains:g.accounts.map(b=>`${b.split(":")[0]}:${b.split(":")[1]}`)};return s}function $d(n){return n.includes(":")}function xa(n){return $d(n)?n.split(":")[0]:n}const Mw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},qw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function de(n,t){const{message:r,code:s}=qw[n];return{message:t?`${r} ${t}`:r,code:s}}function Dt(n,t){const{message:r,code:s}=Mw[n];return{message:t?`${r} ${t}`:r,code:s}}function yi(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Cn(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function or(n){return typeof n>"u"}function Wt(n,t){return t&&or(n)?!0:typeof n=="string"&&!!n.trim().length}function gu(n,t){return t&&or(n)?!0:typeof n=="number"&&!isNaN(n)}function zw(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),o=Object.keys(r);let g=!0;return Qi(o,s)?(s.forEach(b=>{const{accounts:m,methods:E,events:A}=n.namespaces[b],C=jn(m),$=r[b];(!Qi(Ad(b,$),C)||!Qi($.methods,E)||!Qi($.events,A))&&(g=!1)}),g):!1}function _u(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function Hw(n){if(Wt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&_u(r)}}return!1}function Kw(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Bw(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function Vw(n){return n==null?void 0:n.topic}function Gw(n,t){let r=null;return Wt(n==null?void 0:n.publicKey,!1)||(r=de("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function lf(n){let t=!0;return yi(n)?n.length&&(t=n.every(r=>Wt(r,!1))):t=!1,t}function kw(n,t,r){let s=null;return yi(t)?t.forEach(o=>{s||(!_u(o)||!o.includes(n))&&(s=Dt("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):s=Dt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),s}function Ww(n,t){let r=null;return Object.entries(n).forEach(([s,o])=>{if(r)return;const g=kw(s,Ad(s,o),`${t} requiredNamespace`);g&&(r=g)}),r}function Yw(n,t){let r=null;return yi(n)?n.forEach(s=>{r||Hw(s)||(r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Jw(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=Yw(s==null?void 0:s.accounts,`${t} namespace`);o&&(r=o)}),r}function Xw(n,t){let r=null;return lf(n==null?void 0:n.methods)?lf(n==null?void 0:n.events)||(r=Dt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Dt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Md(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=Xw(s,`${t}, namespace`);o&&(r=o)}),r}function Zw(n,t,r){let s=null;if(n&&Cn(n)){const o=Md(n,t);o&&(s=o);const g=Ww(n,t);g&&(s=g)}else s=de("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Aa(n,t){let r=null;if(n&&Cn(n)){const s=Md(n,t);s&&(r=s);const o=Jw(n,t);o&&(r=o)}else r=de("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function qd(n){return Wt(n.protocol,!0)}function Qw(n,t){let r=!1;return t&&!n?r=!0:n&&yi(n)&&n.length&&n.forEach(s=>{r=qd(s)}),r}function eE(n){return typeof n=="number"}function _r(n){return typeof n<"u"&&typeof n!==null}function tE(n){return!(!n||typeof n!="object"||!n.code||!gu(n.code,!1)||!n.message||!Wt(n.message,!1))}function rE(n){return!(or(n)||!Wt(n.method,!1))}function iE(n){return!(or(n)||or(n.result)&&or(n.error)||!gu(n.id,!1)||!Wt(n.jsonrpc,!1))}function nE(n){return!(or(n)||!Wt(n.name,!1))}function ff(n,t){return!(!_u(t)||!Fw(n).includes(t))}function sE(n,t,r){return Wt(r,!1)?Uw(n,t).includes(r):!1}function aE(n,t,r){return Wt(r,!1)?Lw(n,t).includes(r):!1}function df(n,t,r){let s=null;const o=oE(n),g=cE(t),b=Object.keys(o),m=Object.keys(g),E=pf(Object.keys(n)),A=pf(Object.keys(t)),C=E.filter($=>!A.includes($));return C.length&&(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${C.toString()}
      Received: ${Object.keys(t).toString()}`)),Qi(b,m)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${b.toString()}
      Approved: ${m.toString()}`)),Object.keys(t).forEach($=>{if(!$.includes(":")||s)return;const k=jn(t[$].accounts);k.includes($)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${$}
        Required: ${$}
        Approved: ${k.toString()}`))}),b.forEach($=>{s||(Qi(o[$].methods,g[$].methods)?Qi(o[$].events,g[$].events)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${$}`)):s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${$}`))}),s}function oE(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(o=>{t[o]={methods:n[r].methods,events:n[r].events}})}),t}function pf(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function cE(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=jn(n[r].accounts);s==null||s.forEach(o=>{t[o]={accounts:n[r].accounts.filter(g=>g.includes(`${o}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function uE(n,t){return gu(n,!1)&&n<=t.max&&n>=t.min}const hE="PARSE_ERROR",lE="INVALID_REQUEST",fE="METHOD_NOT_FOUND",dE="INVALID_PARAMS",zd="INTERNAL_ERROR",yu="SERVER_ERROR",pE=[-32700,-32600,-32601,-32602,-32603],ls={[hE]:{code:-32700,message:"Parse error"},[lE]:{code:-32600,message:"Invalid Request"},[fE]:{code:-32601,message:"Method not found"},[dE]:{code:-32602,message:"Invalid params"},[zd]:{code:-32603,message:"Internal error"},[yu]:{code:-32e3,message:"Server error"}},Hd=yu;function gE(n){return pE.includes(n)}function gf(n){return Object.keys(ls).includes(n)?ls[n]:ls[Hd]}function _E(n){const t=Object.values(ls).find(r=>r.code===n);return t||ls[Hd]}function Kd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Bd={},Vd={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,K,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{P(w.next(q))}catch(te){T(te)}}function W(q){try{P(w.throw(q))}catch(te){T(te)}}function P(q){q.done?p(q.value):_(q.value).then(F,W)}P((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(P){return function(q){return W([P,q])}}function W(P){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=P[0]&2?_.return:P[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,P[1])).done)return p;switch(_=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return d.label++,{value:P[1],done:!1};case 5:d.label++,_=P[1],P=[0];continue;case 7:P=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){d=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){d.label=P[1];break}if(P[0]===6&&d.label<p[1]){d.label=p[1],p=P;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(P);break}p[2]&&d.ops.pop(),d.trys.pop();continue}P=f.call(c,d)}catch(q){P=[6,q],_=0}finally{w=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(P,q):te(p[0][2],re)}function P(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(P){p({value:P,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},K=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",K),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(Vd);var yE=Vd.exports,pi={},_f;function vE(){if(_f)return pi;_f=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.isBrowserCryptoAvailable=pi.getSubtleCrypto=pi.getBrowerCrypto=void 0;function n(){return(wt===null||wt===void 0?void 0:wt.crypto)||(wt===null||wt===void 0?void 0:wt.msCrypto)||{}}pi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}pi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return pi.isBrowserCryptoAvailable=r,pi}var gi={},yf;function mE(){if(yf)return gi;yf=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.isBrowser=gi.isNode=gi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}gi.isReactNative=n;function t(){return typeof An<"u"&&typeof An.versions<"u"&&typeof An.versions.node<"u"}gi.isNode=t;function r(){return!n()&&!t()}return gi.isBrowser=r,gi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=yE;t.__exportStar(vE(),n),t.__exportStar(mE(),n)})(Bd);function Gd(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function vu(n=6){return BigInt(Gd(n))}function Ka(n,t,r){return{id:r||Gd(),jsonrpc:"2.0",method:n,params:t}}function mu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Ba(n,t,r){return{id:n,jsonrpc:"2.0",error:bE(t,r)}}function bE(n,t){return typeof n>"u"?gf(zd):(typeof n=="string"&&(n=Object.assign(Object.assign({},gf(yu)),{message:n})),typeof t<"u"&&(n.data=t),gE(n.code)&&(n=_E(n.code)),n)}class wE{}class EE extends wE{constructor(){super()}}class SE extends EE{constructor(t){super()}}const IE="^https?:",OE="^wss?:";function PE(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function kd(n,t){const r=PE(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function vf(n){return kd(n,IE)}function mf(n){return kd(n,OE)}function xE(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Wd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function bu(n){return Wd(n)&&"method"in n}function Va(n){return Wd(n)&&(_i(n)||Br(n))}function _i(n){return"result"in n}function Br(n){return"error"in n}class Ni extends SE{constructor(t){super(t),this.events=new Lr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Ka(t.method,t.params||[],t.id||vu().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(g){o(g)}this.events.on(`${t.id}`,g=>{Br(g)?o(g.error):s(g.result)});try{await this.connection.send(t,r)}catch(g){o(g)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Va(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const bf=10,AE=()=>typeof Vr<"u"&&typeof Vr.WebSocket<"u"?Vr.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),TE=()=>typeof window<"u",CE=AE();class RE{constructor(t){if(this.url=t,this.events=new Lr.EventEmitter,this.registering=!1,!mf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(fs(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!mf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",g=>{this.resetMaxListeners(),o(g)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=Bd.isReactNative()?void 0:{rejectUnauthorized:!xE(t)},g=new CE(t,[],o);TE()?g.onerror=b=>{const m=b;s(this.emitError(m.error))}:g.on("error",b=>{s(this.emitError(b))}),g.onopen=()=>{this.onOpen(g),r(g)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?nu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),g=Ba(t,o);this.events.emit("payload",g)}parseError(t,r=this.url){return Kd(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>bf&&this.events.setMaxListeners(bf)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Da={exports:{}};Da.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",o=1,g=2,b=9007199254740991,m="[object Arguments]",E="[object Array]",A="[object AsyncFunction]",C="[object Boolean]",$="[object Date]",k="[object Error]",M="[object Function]",H="[object GeneratorFunction]",Z="[object Map]",Q="[object Number]",ue="[object Null]",L="[object Object]",K="[object Promise]",N="[object Proxy]",j="[object RegExp]",O="[object Set]",u="[object String]",y="[object Symbol]",X="[object Undefined]",c="[object WeakMap]",f="[object ArrayBuffer]",d="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",p="[object Int8Array]",T="[object Int16Array]",F="[object Int32Array]",W="[object Uint8Array]",P="[object Uint8ClampedArray]",q="[object Uint16Array]",te="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,ge=/^(?:0|[1-9]\d*)$/,le={};le[w]=le[_]=le[p]=le[T]=le[F]=le[W]=le[P]=le[q]=le[te]=!0,le[m]=le[E]=le[f]=le[C]=le[d]=le[$]=le[k]=le[M]=le[Z]=le[Q]=le[L]=le[j]=le[O]=le[u]=le[c]=!1;var be=typeof wt=="object"&&wt&&wt.Object===Object&&wt,J=typeof self=="object"&&self&&self.Object===Object&&self,Y=be||J||Function("return this")(),z=t&&!t.nodeType&&t,l=z&&!0&&n&&!n.nodeType&&n,D=l&&l.exports===z,he=D&&be.process,pe=function(){try{return he&&he.binding&&he.binding("util")}catch{}}(),Oe=pe&&pe.isTypedArray;function He(x,B){for(var oe=-1,_e=x==null?0:x.length,ot=0,Re=[];++oe<_e;){var ft=x[oe];B(ft,oe,x)&&(Re[ot++]=ft)}return Re}function Ve(x,B){for(var oe=-1,_e=B.length,ot=x.length;++oe<_e;)x[ot+oe]=B[oe];return x}function Le(x,B){for(var oe=-1,_e=x==null?0:x.length;++oe<_e;)if(B(x[oe],oe,x))return!0;return!1}function pt(x,B){for(var oe=-1,_e=Array(x);++oe<x;)_e[oe]=B(oe);return _e}function gt(x){return function(B){return x(B)}}function Me(x,B){return x.has(B)}function Pe(x,B){return x==null?void 0:x[B]}function je(x){var B=-1,oe=Array(x.size);return x.forEach(function(_e,ot){oe[++B]=[ot,_e]}),oe}function De(x,B){return function(oe){return x(B(oe))}}function qe(x){var B=-1,oe=Array(x.size);return x.forEach(function(_e){oe[++B]=_e}),oe}var Ae=Array.prototype,Fe=Function.prototype,Ie=Object.prototype,Te=Y["__core-js_shared__"],Ke=Fe.toString,xe=Ie.hasOwnProperty,Ge=function(){var x=/[^.]+$/.exec(Te&&Te.keys&&Te.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),We=Ie.toString,et=RegExp("^"+Ke.call(xe).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=D?Y.Buffer:void 0,Je=Y.Symbol,er=Y.Uint8Array,hr=Ie.propertyIsEnumerable,Gr=Ae.splice,tr=Je?Je.toStringTag:void 0,ri=Object.getOwnPropertySymbols,vi=tt?tt.isBuffer:void 0,Di=De(Object.keys,Object),Et=vr(Y,"DataView"),_t=vr(Y,"Map"),St=vr(Y,"Promise"),It=vr(Y,"Set"),mt=vr(Y,"WeakMap"),yt=vr(Object,"create"),Ut=ni(Et),Lt=ni(_t),Ot=ni(St),$t=ni(It),Pt=ni(mt),Ct=Je?Je.prototype:void 0,xt=Ct?Ct.valueOf:void 0;function ht(x){var B=-1,oe=x==null?0:x.length;for(this.clear();++B<oe;){var _e=x[B];this.set(_e[0],_e[1])}}function Mt(){this.__data__=yt?yt(null):{},this.size=0}function qt(x){var B=this.has(x)&&delete this.__data__[x];return this.size-=B?1:0,B}function Wa(x){var B=this.__data__;if(yt){var oe=B[x];return oe===s?void 0:oe}return xe.call(B,x)?B[x]:void 0}function Ya(x){var B=this.__data__;return yt?B[x]!==void 0:xe.call(B,x)}function Ja(x,B){var oe=this.__data__;return this.size+=this.has(x)?0:1,oe[x]=yt&&B===void 0?s:B,this}ht.prototype.clear=Mt,ht.prototype.delete=qt,ht.prototype.get=Wa,ht.prototype.has=Ya,ht.prototype.set=Ja;function Or(x){var B=-1,oe=x==null?0:x.length;for(this.clear();++B<oe;){var _e=x[B];this.set(_e[0],_e[1])}}function Xa(){this.__data__=[],this.size=0}function Za(x){var B=this.__data__,oe=Fi(B,x);if(oe<0)return!1;var _e=B.length-1;return oe==_e?B.pop():Gr.call(B,oe,1),--this.size,!0}function Qa(x){var B=this.__data__,oe=Fi(B,x);return oe<0?void 0:B[oe][1]}function eo(x){return Fi(this.__data__,x)>-1}function to(x,B){var oe=this.__data__,_e=Fi(oe,x);return _e<0?(++this.size,oe.push([x,B])):oe[_e][1]=B,this}Or.prototype.clear=Xa,Or.prototype.delete=Za,Or.prototype.get=Qa,Or.prototype.has=eo,Or.prototype.set=to;function ii(x){var B=-1,oe=x==null?0:x.length;for(this.clear();++B<oe;){var _e=x[B];this.set(_e[0],_e[1])}}function sn(){this.size=0,this.__data__={hash:new ht,map:new(_t||Or),string:new ht}}function ro(x){var B=mi(this,x).delete(x);return this.size-=B?1:0,B}function an(x){return mi(this,x).get(x)}function io(x){return mi(this,x).has(x)}function no(x,B){var oe=mi(this,x),_e=oe.size;return oe.set(x,B),this.size+=oe.size==_e?0:1,this}ii.prototype.clear=sn,ii.prototype.delete=ro,ii.prototype.get=an,ii.prototype.has=io,ii.prototype.set=no;function on(x){var B=-1,oe=x==null?0:x.length;for(this.__data__=new ii;++B<oe;)this.add(x[B])}function ms(x){return this.__data__.set(x,s),this}function bs(x){return this.__data__.has(x)}on.prototype.add=on.prototype.push=ms,on.prototype.has=bs;function $r(x){var B=this.__data__=new Or(x);this.size=B.size}function so(){this.__data__=new Or,this.size=0}function ao(x){var B=this.__data__,oe=B.delete(x);return this.size=B.size,oe}function oo(x){return this.__data__.get(x)}function co(x){return this.__data__.has(x)}function ws(x,B){var oe=this.__data__;if(oe instanceof Or){var _e=oe.__data__;if(!_t||_e.length<r-1)return _e.push([x,B]),this.size=++oe.size,this;oe=this.__data__=new ii(_e)}return oe.set(x,B),this.size=oe.size,this}$r.prototype.clear=so,$r.prototype.delete=ao,$r.prototype.get=oo,$r.prototype.has=co,$r.prototype.set=ws;function Es(x,B){var oe=hn(x),_e=!oe&&Ds(x),ot=!oe&&!_e&&Un(x),Re=!oe&&!_e&&!ot&&Ls(x),ft=oe||_e||ot||Re,zt=ft?pt(x.length,String):[],Xe=zt.length;for(var ct in x)(B||xe.call(x,ct))&&!(ft&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Re&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ts(ct,Xe)))&&zt.push(ct);return zt}function Fi(x,B){for(var oe=x.length;oe--;)if(js(x[oe][0],B))return oe;return-1}function Dn(x,B,oe){var _e=B(x);return hn(x)?_e:Ve(_e,oe(x))}function Ui(x){return x==null?x===void 0?X:ue:tr&&tr in Object(x)?xs(x):lo(x)}function Fn(x){return $i(x)&&Ui(x)==m}function Li(x,B,oe,_e,ot){return x===B?!0:x==null||B==null||!$i(x)&&!$i(B)?x!==x&&B!==B:Ss(x,B,oe,_e,Li,ot)}function Ss(x,B,oe,_e,ot,Re){var ft=hn(x),zt=hn(B),Xe=ft?E:kr(x),ct=zt?E:kr(B);Xe=Xe==m?L:Xe,ct=ct==m?L:ct;var Rt=Xe==L,lr=ct==L,Ht=Xe==ct;if(Ht&&Un(x)){if(!Un(B))return!1;ft=!0,Rt=!1}if(Ht&&!Rt)return Re||(Re=new $r),ft||Ls(x)?cn(x,B,oe,_e,ot,Re):ho(x,B,Xe,oe,_e,ot,Re);if(!(oe&o)){var dt=Rt&&xe.call(x,"__wrapped__"),rr=lr&&xe.call(B,"__wrapped__");if(dt||rr){var Mr=dt?x.value():x,Pr=rr?B.value():B;return Re||(Re=new $r),ot(Mr,Pr,oe,_e,Re)}}return Ht?(Re||(Re=new $r),Ps(x,B,oe,_e,ot,Re)):!1}function uo(x){if(!Us(x)||Rs(x))return!1;var B=ln(x)?et:ie;return B.test(ni(x))}function Is(x){return $i(x)&&Fs(x.length)&&!!le[Ui(x)]}function Os(x){if(!Ns(x))return Di(x);var B=[];for(var oe in Object(x))xe.call(x,oe)&&oe!="constructor"&&B.push(oe);return B}function cn(x,B,oe,_e,ot,Re){var ft=oe&o,zt=x.length,Xe=B.length;if(zt!=Xe&&!(ft&&Xe>zt))return!1;var ct=Re.get(x);if(ct&&Re.get(B))return ct==B;var Rt=-1,lr=!0,Ht=oe&g?new on:void 0;for(Re.set(x,B),Re.set(B,x);++Rt<zt;){var dt=x[Rt],rr=B[Rt];if(_e)var Mr=ft?_e(rr,dt,Rt,B,x,Re):_e(dt,rr,Rt,x,B,Re);if(Mr!==void 0){if(Mr)continue;lr=!1;break}if(Ht){if(!Le(B,function(Pr,Wr){if(!Me(Ht,Wr)&&(dt===Pr||ot(dt,Pr,oe,_e,Re)))return Ht.push(Wr)})){lr=!1;break}}else if(!(dt===rr||ot(dt,rr,oe,_e,Re))){lr=!1;break}}return Re.delete(x),Re.delete(B),lr}function ho(x,B,oe,_e,ot,Re,ft){switch(oe){case d:if(x.byteLength!=B.byteLength||x.byteOffset!=B.byteOffset)return!1;x=x.buffer,B=B.buffer;case f:return!(x.byteLength!=B.byteLength||!Re(new er(x),new er(B)));case C:case $:case Q:return js(+x,+B);case k:return x.name==B.name&&x.message==B.message;case j:case u:return x==B+"";case Z:var zt=je;case O:var Xe=_e&o;if(zt||(zt=qe),x.size!=B.size&&!Xe)return!1;var ct=ft.get(x);if(ct)return ct==B;_e|=g,ft.set(x,B);var Rt=cn(zt(x),zt(B),_e,ot,Re,ft);return ft.delete(x),Rt;case y:if(xt)return xt.call(x)==xt.call(B)}return!1}function Ps(x,B,oe,_e,ot,Re){var ft=oe&o,zt=un(x),Xe=zt.length,ct=un(B),Rt=ct.length;if(Xe!=Rt&&!ft)return!1;for(var lr=Xe;lr--;){var Ht=zt[lr];if(!(ft?Ht in B:xe.call(B,Ht)))return!1}var dt=Re.get(x);if(dt&&Re.get(B))return dt==B;var rr=!0;Re.set(x,B),Re.set(B,x);for(var Mr=ft;++lr<Xe;){Ht=zt[lr];var Pr=x[Ht],Wr=B[Ht];if(_e)var Ln=ft?_e(Wr,Pr,Ht,B,x,Re):_e(Pr,Wr,Ht,x,B,Re);if(!(Ln===void 0?Pr===Wr||ot(Pr,Wr,oe,_e,Re):Ln)){rr=!1;break}Mr||(Mr=Ht=="constructor")}if(rr&&!Mr){var Mi=x.constructor,Gt=B.constructor;Mi!=Gt&&"constructor"in x&&"constructor"in B&&!(typeof Mi=="function"&&Mi instanceof Mi&&typeof Gt=="function"&&Gt instanceof Gt)&&(rr=!1)}return Re.delete(x),Re.delete(B),rr}function un(x){return Dn(x,go,As)}function mi(x,B){var oe=x.__data__;return Cs(B)?oe[typeof B=="string"?"string":"hash"]:oe.map}function vr(x,B){var oe=Pe(x,B);return uo(oe)?oe:void 0}function xs(x){var B=xe.call(x,tr),oe=x[tr];try{x[tr]=void 0;var _e=!0}catch{}var ot=We.call(x);return _e&&(B?x[tr]=oe:delete x[tr]),ot}var As=ri?function(x){return x==null?[]:(x=Object(x),He(ri(x),function(B){return hr.call(x,B)}))}:at,kr=Ui;(Et&&kr(new Et(new ArrayBuffer(1)))!=d||_t&&kr(new _t)!=Z||St&&kr(St.resolve())!=K||It&&kr(new It)!=O||mt&&kr(new mt)!=c)&&(kr=function(x){var B=Ui(x),oe=B==L?x.constructor:void 0,_e=oe?ni(oe):"";if(_e)switch(_e){case Ut:return d;case Lt:return Z;case Ot:return K;case $t:return O;case Pt:return c}return B});function Ts(x,B){return B=B??b,!!B&&(typeof x=="number"||ge.test(x))&&x>-1&&x%1==0&&x<B}function Cs(x){var B=typeof x;return B=="string"||B=="number"||B=="symbol"||B=="boolean"?x!=="__proto__":x===null}function Rs(x){return!!Ge&&Ge in x}function Ns(x){var B=x&&x.constructor,oe=typeof B=="function"&&B.prototype||Ie;return x===oe}function lo(x){return We.call(x)}function ni(x){if(x!=null){try{return Ke.call(x)}catch{}try{return x+""}catch{}}return""}function js(x,B){return x===B||x!==x&&B!==B}var Ds=Fn(function(){return arguments}())?Fn:function(x){return $i(x)&&xe.call(x,"callee")&&!hr.call(x,"callee")},hn=Array.isArray;function fo(x){return x!=null&&Fs(x.length)&&!ln(x)}var Un=vi||st;function po(x,B){return Li(x,B)}function ln(x){if(!Us(x))return!1;var B=Ui(x);return B==M||B==H||B==A||B==N}function Fs(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=b}function Us(x){var B=typeof x;return x!=null&&(B=="object"||B=="function")}function $i(x){return x!=null&&typeof x=="object"}var Ls=Oe?gt(Oe):Is;function go(x){return fo(x)?Es(x):Os(x)}function at(){return[]}function st(){return!1}n.exports=po})(Da,Da.exports);var NE=Da.exports;const jE=W1(NE);function DE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var g=n.charAt(o),b=g.charCodeAt(0);if(r[b]!==255)throw new TypeError(g+" is ambiguous");r[b]=o}var m=n.length,E=n.charAt(0),A=Math.log(m)/Math.log(256),C=Math.log(256)/Math.log(m);function $(H){if(H instanceof Uint8Array||(ArrayBuffer.isView(H)?H=new Uint8Array(H.buffer,H.byteOffset,H.byteLength):Array.isArray(H)&&(H=Uint8Array.from(H))),!(H instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(H.length===0)return"";for(var Z=0,Q=0,ue=0,L=H.length;ue!==L&&H[ue]===0;)ue++,Z++;for(var K=(L-ue)*C+1>>>0,N=new Uint8Array(K);ue!==L;){for(var j=H[ue],O=0,u=K-1;(j!==0||O<Q)&&u!==-1;u--,O++)j+=256*N[u]>>>0,N[u]=j%m>>>0,j=j/m>>>0;if(j!==0)throw new Error("Non-zero carry");Q=O,ue++}for(var y=K-Q;y!==K&&N[y]===0;)y++;for(var X=E.repeat(Z);y<K;++y)X+=n.charAt(N[y]);return X}function k(H){if(typeof H!="string")throw new TypeError("Expected String");if(H.length===0)return new Uint8Array;var Z=0;if(H[Z]!==" "){for(var Q=0,ue=0;H[Z]===E;)Q++,Z++;for(var L=(H.length-Z)*A+1>>>0,K=new Uint8Array(L);H[Z];){var N=r[H.charCodeAt(Z)];if(N===255)return;for(var j=0,O=L-1;(N!==0||j<ue)&&O!==-1;O--,j++)N+=m*K[O]>>>0,K[O]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");ue=j,Z++}if(H[Z]!==" "){for(var u=L-ue;u!==L&&K[u]===0;)u++;for(var y=new Uint8Array(Q+(L-u)),X=Q;u!==L;)y[X++]=K[u++];return y}}}function M(H){var Z=k(H);if(Z)return Z;throw new Error(`Non-${t} character`)}return{encode:$,decodeUnsafe:k,decode:M}}var FE=DE,UE=FE;const Yd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},LE=n=>new TextEncoder().encode(n),$E=n=>new TextDecoder().decode(n);class ME{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class qE{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Jd(this,t)}}class zE{constructor(t){this.decoders=t}or(t){return Jd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Jd=(n,t)=>new zE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class HE{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new ME(t,r,s),this.decoder=new qE(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ga=({name:n,prefix:t,encode:r,decode:s})=>new HE(n,t,r,s),vs=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=UE(r,t);return Ga({prefix:n,name:t,encode:s,decode:g=>Yd(o(g))})},KE=(n,t,r,s)=>{const o={};for(let C=0;C<t.length;++C)o[t[C]]=C;let g=n.length;for(;n[g-1]==="=";)--g;const b=new Uint8Array(g*r/8|0);let m=0,E=0,A=0;for(let C=0;C<g;++C){const $=o[n[C]];if($===void 0)throw new SyntaxError(`Non-${s} character`);E=E<<r|$,m+=r,m>=8&&(m-=8,b[A++]=255&E>>m)}if(m>=r||255&E<<8-m)throw new SyntaxError("Unexpected end of data");return b},BE=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let g="",b=0,m=0;for(let E=0;E<n.length;++E)for(m=m<<8|n[E],b+=8;b>r;)b-=r,g+=t[o&m>>b];if(b&&(g+=t[o&m<<r-b]),s)for(;g.length*r&7;)g+="=";return g},Jt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ga({prefix:t,name:n,encode(o){return BE(o,s,r)},decode(o){return KE(o,s,r,n)}}),VE=Ga({prefix:"\0",name:"identity",encode:n=>$E(n),decode:n=>LE(n)});var GE=Object.freeze({__proto__:null,identity:VE});const kE=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var WE=Object.freeze({__proto__:null,base2:kE});const YE=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var JE=Object.freeze({__proto__:null,base8:YE});const XE=vs({prefix:"9",name:"base10",alphabet:"0123456789"});var ZE=Object.freeze({__proto__:null,base10:XE});const QE=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),e6=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var t6=Object.freeze({__proto__:null,base16:QE,base16upper:e6});const r6=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i6=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),n6=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),s6=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),a6=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),o6=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),c6=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),u6=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),h6=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var l6=Object.freeze({__proto__:null,base32:r6,base32upper:i6,base32pad:n6,base32padupper:s6,base32hex:a6,base32hexupper:o6,base32hexpad:c6,base32hexpadupper:u6,base32z:h6});const f6=vs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),d6=vs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var p6=Object.freeze({__proto__:null,base36:f6,base36upper:d6});const g6=vs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_6=vs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var y6=Object.freeze({__proto__:null,base58btc:g6,base58flickr:_6});const v6=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),m6=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),b6=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),w6=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var E6=Object.freeze({__proto__:null,base64:v6,base64pad:m6,base64url:b6,base64urlpad:w6});const Xd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),S6=Xd.reduce((n,t,r)=>(n[r]=t,n),[]),I6=Xd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function O6(n){return n.reduce((t,r)=>(t+=S6[r],t),"")}function P6(n){const t=[];for(const r of n){const s=I6[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const x6=Ga({prefix:"🚀",name:"base256emoji",encode:O6,decode:P6});var A6=Object.freeze({__proto__:null,base256emoji:x6}),T6=Zd,wf=128,C6=127,R6=~C6,N6=Math.pow(2,31);function Zd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=N6;)t[r++]=n&255|wf,n/=128;for(;n&R6;)t[r++]=n&255|wf,n>>>=7;return t[r]=n|0,Zd.bytes=r-s+1,t}var j6=Jc,D6=128,Ef=127;function Jc(n,s){var r=0,s=s||0,o=0,g=s,b,m=n.length;do{if(g>=m)throw Jc.bytes=0,new RangeError("Could not decode varint");b=n[g++],r+=o<28?(b&Ef)<<o:(b&Ef)*Math.pow(2,o),o+=7}while(b>=D6);return Jc.bytes=g-s,r}var F6=Math.pow(2,7),U6=Math.pow(2,14),L6=Math.pow(2,21),$6=Math.pow(2,28),M6=Math.pow(2,35),q6=Math.pow(2,42),z6=Math.pow(2,49),H6=Math.pow(2,56),K6=Math.pow(2,63),B6=function(n){return n<F6?1:n<U6?2:n<L6?3:n<$6?4:n<M6?5:n<q6?6:n<z6?7:n<H6?8:n<K6?9:10},V6={encode:T6,decode:j6,encodingLength:B6},Qd=V6;const Sf=(n,t,r=0)=>(Qd.encode(n,t,r),t),If=n=>Qd.encodingLength(n),Xc=(n,t)=>{const r=t.byteLength,s=If(n),o=s+If(r),g=new Uint8Array(o+r);return Sf(n,g,0),Sf(r,g,s),g.set(t,o),new G6(n,r,t,g)};class G6{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const ep=({name:n,code:t,encode:r})=>new k6(n,t,r);class k6{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Xc(this.code,r):r.then(s=>Xc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const tp=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),W6=ep({name:"sha2-256",code:18,encode:tp("SHA-256")}),Y6=ep({name:"sha2-512",code:19,encode:tp("SHA-512")});var J6=Object.freeze({__proto__:null,sha256:W6,sha512:Y6});const rp=0,X6="identity",ip=Yd,Z6=n=>Xc(rp,ip(n)),Q6={code:rp,name:X6,encode:ip,digest:Z6};var eS=Object.freeze({__proto__:null,identity:Q6});new TextEncoder,new TextDecoder;const Of={...GE,...WE,...JE,...ZE,...t6,...l6,...p6,...y6,...E6,...A6};({...J6,...eS});function np(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function tS(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?np(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function sp(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Pf=sp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Tc=sp("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=tS(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),rS={utf8:Pf,"utf-8":Pf,hex:Of.base16,latin1:Tc,ascii:Tc,binary:Tc,...Of};function iS(n,t="utf8"){const r=rS[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?np(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const ap="wc",nS=2,wu="core",Ci=`${ap}@2:${wu}:`,sS={name:wu,logger:"error"},aS={database:":memory:"},oS="crypto",xf="client_ed25519_seed",cS=me.ONE_DAY,uS="keychain",hS="0.3",lS="messages",fS="0.3",dS=me.SIX_HOURS,pS="publisher",op="irn",gS="error",cp="wss://relay.walletconnect.com",_S="relayer",Tt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},yS="_subscription",as={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},vS=me.ONE_SECOND/2,mS="2.8.4",bS=1e4,wS="0.3",ES="WALLETCONNECT_CLIENT_ID",ei={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},SS="subscription",IS="0.3",OS=me.FIVE_SECONDS*1e3,PS="pairing",xS="0.3",os={wc_pairingDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:me.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:me.ONE_DAY,prompt:!1,tag:0},res:{ttl:me.ONE_DAY,prompt:!1,tag:0}}},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},AS="history",TS="0.3",CS="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},RS="0.3",Cc="verify-api",Af="https://verify.walletconnect.com";class NS{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=uS,this.version=hS,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:g}=de("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(g)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Dd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Fd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class jS{constructor(t,r,s){this.core=t,this.logger=r,this.name=oS,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),g=Xl(o);return vd(g.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=iw();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const g=await this.getClientSeed(),b=Xl(g),m=Wc();return await Sb(m,o,cS,b)},this.generateSharedKey=(o,g,b)=>{this.isInitialized();const m=this.getPrivateKey(o),E=nw(m,g);return this.setSymKey(E,b)},this.setSymKey=async(o,g)=>{this.isInitialized();const b=g||sw(o);return await this.keychain.set(b,o),b},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,g,b)=>{this.isInitialized();const m=Rd(b),E=fs(g);if(sf(m)){const k=m.senderPublicKey,M=m.receiverPublicKey;o=await this.generateSharedKey(k,M)}const A=this.getSymKey(o),{type:C,senderPublicKey:$}=m;return ow({type:C,symKey:A,message:E,senderPublicKey:$})},this.decode=async(o,g,b)=>{this.isInitialized();const m=hw(g,b);if(sf(m)){const C=m.receiverPublicKey,$=m.senderPublicKey;o=await this.generateSharedKey(C,$)}const E=this.getSymKey(o),A=cw({symKey:E,encoded:g});return nu(A)},this.getPayloadType=o=>{const g=Na(o);return ys(g.type)},this.getPayloadSenderPublicKey=o=>{const g=Na(o);return g.senderPublicKey?ur(g.senderPublicKey,cr):void 0},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.keychain=s||new NS(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(xf)}catch{t=Wc(),await this.keychain.set(xf,t)}return iS(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class DS extends Pm{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=lS,this.version=fS,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const g=Tn(o);let b=this.messages.get(s);return typeof b>"u"&&(b={}),typeof b[g]<"u"||(b[g]=o,this.messages.set(s,b),await this.persist()),g},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const g=this.get(s),b=Tn(o);return typeof g[b]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(t,this.name),this.core=r}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Dd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Fd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class FS extends xm{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Lr.EventEmitter,this.name=pS,this.queue=new Map,this.publishTimeout=me.toMiliseconds(me.TEN_SECONDS),this.queueTimeout=me.toMiliseconds(me.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,g)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:g}});try{const b=(g==null?void 0:g.ttl)||dS,m=Yc(g),E=(g==null?void 0:g.prompt)||!1,A=(g==null?void 0:g.tag)||0,C=(g==null?void 0:g.id)||vu().toString(),$={topic:s,message:o,opts:{ttl:b,relay:m,prompt:E,tag:A,id:C}},k=setTimeout(()=>this.queue.set(C,$),this.queueTimeout);try{await await ja(this.rpcPublish(s,o,b,m,E,A,C),this.publishTimeout),clearTimeout(k),this.relayer.events.emit(Tt.publish,$)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:g}})}catch(b){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(b),b}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,g,b,m){var E,A,C,$;const k={method:Pa(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:g,tag:b},id:m};return or((E=k.params)==null?void 0:E.prompt)&&((A=k.params)==null||delete A.prompt),or((C=k.params)==null?void 0:C.tag)&&(($=k.params)==null||delete $.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:k}),this.relayer.request(k)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Tt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Tt.message_ack,t=>{this.onPublish(t.id.toString())})}}class US{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(g=>g!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var LS=Object.defineProperty,$S=Object.defineProperties,MS=Object.getOwnPropertyDescriptors,Tf=Object.getOwnPropertySymbols,qS=Object.prototype.hasOwnProperty,zS=Object.prototype.propertyIsEnumerable,Cf=(n,t,r)=>t in n?LS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,cs=(n,t)=>{for(var r in t||(t={}))qS.call(t,r)&&Cf(n,r,t[r]);if(Tf)for(var r of Tf(t))zS.call(t,r)&&Cf(n,r,t[r]);return n},Rc=(n,t)=>$S(n,MS(t));class HS extends Cm{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new US,this.events=new Lr.EventEmitter,this.name=SS,this.version=IS,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ci,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const g=Yc(o),b={topic:s,relay:g};this.pending.set(s,b);const m=await this.rpcSubscribe(s,g);return this.onSubscribe(m,b),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),m}catch(g){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(g),g}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,g)=>{const b=new me.Watch;b.start(this.pendingSubscriptionWatchLabel);const m=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(m),b.stop(this.pendingSubscriptionWatchLabel),o(!0)),b.elapsed(this.pendingSubscriptionWatchLabel)>=OS&&(clearInterval(m),b.stop(this.pendingSubscriptionWatchLabel),g(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=Yc(s);await this.rpcUnsubscribe(t,r,o);const g=Dt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,g),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:Pa(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await ja(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Tt.connection_stalled)}return Tn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Pa(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await ja(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Tt.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:Pa(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Rc(cs({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,cs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,cs({},r)),this.topicMap.set(r.topic,t),this.events.emit(ei.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(ei.deleted,Rc(cs({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ei.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ei.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);yi(r)&&this.onBatchSubscribe(r.map((s,o)=>Rc(cs({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Tt.connect,async()=>{await this.onConnect()}),this.relayer.on(Tt.disconnect,()=>{this.onDisconnect()}),this.events.on(ei.created,async t=>{const r=ei.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ei.deleted,async t=>{const r=ei.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var KS=Object.defineProperty,Rf=Object.getOwnPropertySymbols,BS=Object.prototype.hasOwnProperty,VS=Object.prototype.propertyIsEnumerable,Nf=(n,t,r)=>t in n?KS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,GS=(n,t)=>{for(var r in t||(t={}))BS.call(t,r)&&Nf(n,r,t[r]);if(Rf)for(var r of Rf(t))VS.call(t,r)&&Nf(n,r,t[r]);return n};class kS extends Am{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Lr.EventEmitter,this.name=_S,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Qe.generateChildLogger(t.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:t.logger||gS})),this.messages=new DS(this.logger,t.core),this.subscriber=new HS(this,this.logger),this.publisher=new FS(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||cp,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},bS)}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(g=>{this.subscriber.once(ei.created,b=>{b.topic===t&&g()})}),new Promise(async g=>{o=await this.subscriber.subscribe(t,r),g()})]),o)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Tt.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(ei.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await ja(this.provider.connect(),5e3,"socket stalled").catch(o=>s(o)).then(()=>r()).finally(()=>this.removeListener(Tt.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Tt.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Tt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(as.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ni(new RE(ww({sdkVersion:mS,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),bu(t)){if(!t.method.endsWith(yS))return;const r=t.params,{topic:s,message:o,publishedAt:g}=r.data,b={topic:s,message:o,publishedAt:g};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(GS({type:"event",event:r.id},b)),this.events.emit(r.id,b),await this.acknowledgePayload(t),await this.onMessageEvent(b)}else Va(t)&&this.events.emit(Tt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Tt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=mu(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(as.payload,t=>this.onProviderPayload(t)),this.provider.on(as.connect,()=>{this.events.emit(Tt.connect)}),this.provider.on(as.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(as.error,t=>{this.logger.error(t),this.events.emit(Tt.error,t)})}registerEventListeners(){this.events.on(Tt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Tt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},me.toMiliseconds(vS))}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var WS=Object.defineProperty,jf=Object.getOwnPropertySymbols,YS=Object.prototype.hasOwnProperty,JS=Object.prototype.propertyIsEnumerable,Df=(n,t,r)=>t in n?WS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ff=(n,t)=>{for(var r in t||(t={}))YS.call(t,r)&&Df(n,r,t[r]);if(jf)for(var r of jf(t))JS.call(t,r)&&Df(n,r,t[r]);return n};class ka extends Tm{constructor(t,r,s,o=Ci,g=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=wS,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(b=>{this.getKey&&b!==null&&!or(b)?this.map.set(this.getKey(b),b):Bw(b)?this.map.set(b.id,b):Vw(b)&&this.map.set(b.topic,b)}),this.cached=[],this.initialized=!0)},this.set=async(b,m)=>{this.isInitialized(),this.map.has(b)?await this.update(b,m):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:b,value:m}),this.map.set(b,m),await this.persist())},this.get=b=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:b}),this.getData(b)),this.getAll=b=>(this.isInitialized(),b?this.values.filter(m=>Object.keys(b).every(E=>jE(m[E],b[E]))):this.values),this.update=async(b,m)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:b,update:m});const E=Ff(Ff({},this.getData(b)),m);this.map.set(b,E),await this.persist()},this.delete=async(b,m)=>{this.isInitialized(),this.map.has(b)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:b,reason:m}),this.map.delete(b),await this.persist())},this.logger=Qe.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=g}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class XS{constructor(t,r){this.core=t,this.logger=r,this.name=PS,this.version=xS,this.events=new iu,this.initialized=!1,this.storagePrefix=Ci,this.ignoredPayloadTypes=[rn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Wc(),o=await this.core.crypto.setSymKey(s),g=ti(me.FIVE_MINUTES),b={protocol:op},m={topic:o,expiry:g,relay:b,active:!1},E=Dw({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:b});return await this.pairings.set(o,m),await this.core.relayer.subscribe(o),this.core.expirer.set(o,g),{topic:o,uri:E}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:g,relay:b}=Rw(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const m=ti(me.FIVE_MINUTES),E={topic:o,relay:b,expiry:m,active:!1};return await this.pairings.set(o,E),await this.core.crypto.setSymKey(g,o),await this.core.relayer.subscribe(o,{relay:b}),this.core.expirer.set(o,m),s.activatePairing&&await this.activate({topic:o}),E},this.activate=async({topic:s})=>{this.isInitialized();const o=ti(me.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const g=await this.sendRequest(o,"wc_pairingPing",{}),{done:b,resolve:m,reject:E}=xn();this.events.once(Kt("pairing_ping",g),({error:A})=>{A?E(A):m()}),await b()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Dt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,g)=>{const b=Ka(o,g),m=await this.core.crypto.encode(s,b),E=os[o].req;return this.core.history.set(s,b),this.core.relayer.publish(s,m,E),b.id},this.sendResult=async(s,o,g)=>{const b=mu(s,g),m=await this.core.crypto.encode(o,b),E=await this.core.history.get(o,s),A=os[E.request.method].res;await this.core.relayer.publish(o,m,A),await this.core.history.resolve(b)},this.sendError=async(s,o,g)=>{const b=Ba(s,g),m=await this.core.crypto.encode(o,b),E=await this.core.history.get(o,s),A=os[E.request.method]?os[E.request.method].res:os.unregistered_method.res;await this.core.relayer.publish(o,m,A),await this.core.history.resolve(b)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Dt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ti(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:g}=s,b=g.method;if(this.pairings.keys.includes(o))switch(b){case"wc_pairingPing":return this.onPairingPingRequest(o,g);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,g);default:return this.onUnknownRpcMethodRequest(o,g)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:g}=s,b=(await this.core.history.get(o,g.id)).request.method;if(this.pairings.keys.includes(o))switch(b){case"wc_pairingPing":return this.onPairingPingResponse(o,g);default:return this.onUnknownRpcMethodResponse(b)}},this.onPairingPingRequest=async(s,o)=>{const{id:g}=o;try{this.isValidPing({topic:s}),await this.sendResult(g,s,!0),this.events.emit("pairing_ping",{id:g,topic:s})}catch(b){await this.sendError(g,s,b),this.logger.error(b)}},this.onPairingPingResponse=(s,o)=>{const{id:g}=o;setTimeout(()=>{_i(o)?this.events.emit(Kt("pairing_ping",g),{}):Br(o)&&this.events.emit(Kt("pairing_ping",g),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:g}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:g,topic:s})}catch(b){await this.sendError(g,s,b),this.logger.error(b)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:g,method:b}=o;try{if(this.registeredMethods.includes(b))return;const m=Dt("WC_METHOD_UNSUPPORTED",b);await this.sendError(g,s,m),this.logger.error(m)}catch(m){await this.sendError(g,s,m),this.logger.error(m)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Dt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!_r(s)){const{message:o}=de("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!Kw(s.uri)){const{message:o}=de("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!_r(s)){const{message:g}=de("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(g)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!_r(s)){const{message:g}=de("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(g)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ti(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=de("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.pairings=new ka(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Tt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);bu(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Va(o)&&(await this.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o}))})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async t=>{const{topic:r}=Ld(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class ZS extends Om{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Lr.EventEmitter,this.name=AS,this.version=TS,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,g)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:g}),this.records.has(o.id))return;const b={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:g};this.records.set(b.id,b),this.events.emit(Qr.created,b)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Br(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Qr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(g=>{if(g.topic===s){if(typeof o<"u"&&g.id!==o)return;this.records.delete(g.id),this.events.emit(Qr.deleted,g)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Ka(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Qr.created,t=>{const r=Qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.updated,t=>{const r=Qr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.deleted,t=>{const r=Qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class QS extends Rm{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Lr.EventEmitter,this.name=CS,this.version=RS,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const g=this.formatTarget(s),b={target:g,expiry:o};this.expirations.set(g,b),this.checkExpiry(g,b),this.events.emit(Fr.created,{target:g,expiration:b})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),g=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Fr.deleted,{target:o,expiration:g})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Ew(t);if(typeof t=="number")return Sw(t);const{message:r}=de("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;me.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Fr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.expired,t=>{const r=Fr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.deleted,t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class e2 extends Nm{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Cc,this.initialized=!1,this.init=async s=>{Nd()||!pu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Af,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const g=this.startAbortTimer(me.FIVE_SECONDS),b=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(g),b.status===200?(o=await b.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(Cc))return s();const g=document.createElement("iframe");g.setAttribute("id",Cc),g.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),g.style.display="none",g.addEventListener("load",()=>{this.initialized=!0,s()}),g.addEventListener("error",b=>{o(b)}),document.body.append(g),this.iframe=g}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),me.toMiliseconds(me.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(r,this.name),this.verifyUrl=Af,this.abortController=new AbortController,this.isDevEnv=du()&&{}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),me.toMiliseconds(t))}}var t2=Object.defineProperty,Uf=Object.getOwnPropertySymbols,r2=Object.prototype.hasOwnProperty,i2=Object.prototype.propertyIsEnumerable,Lf=(n,t,r)=>t in n?t2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,$f=(n,t)=>{for(var r in t||(t={}))r2.call(t,r)&&Lf(n,r,t[r]);if(Uf)for(var r of Uf(t))i2.call(t,r)&&Lf(n,r,t[r]);return n};let n2=class up extends Im{constructor(t){super(t),this.protocol=ap,this.version=nS,this.name=wu,this.events=new Lr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||cp;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||sS.logger}));this.logger=Qe.generateChildLogger(r,this.name),this.heartbeat=new gs.HeartBeat,this.crypto=new jS(this,this.logger,t==null?void 0:t.keychain),this.history=new ZS(this,this.logger),this.expirer=new QS(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new am($f($f({},aS),t==null?void 0:t.storageOptions)),this.relayer=new kS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new XS(this,this.logger),this.verify=new e2(this.projectId||"",this.logger)}static async init(t){const r=new up(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(ES,s),r}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const s2=n2,hp="wc",lp=2,fp="client",Eu=`${hp}@${lp}:${fp}:`,Nc={name:fp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},a2="WALLETCONNECT_DEEPLINK_CHOICE",o2="proposal",dp="Proposal expired",c2="session",Sa=me.SEVEN_DAYS,u2="engine",us={wc_sessionPropose:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1104},res:{ttl:me.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1106},res:{ttl:me.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1112},res:{ttl:me.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1115}}},jc={min:me.FIVE_MINUTES,max:me.SEVEN_DAYS},h2="request",l2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var f2=Object.defineProperty,d2=Object.defineProperties,p2=Object.getOwnPropertyDescriptors,Mf=Object.getOwnPropertySymbols,g2=Object.prototype.hasOwnProperty,_2=Object.prototype.propertyIsEnumerable,qf=(n,t,r)=>t in n?f2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Dr=(n,t)=>{for(var r in t||(t={}))g2.call(t,r)&&qf(n,r,t[r]);if(Mf)for(var r of Mf(t))_2.call(t,r)&&qf(n,r,t[r]);return n},Dc=(n,t)=>d2(n,p2(t));class y2 extends Dm{constructor(t){super(t),this.name=u2,this.events=new iu,this.initialized=!1,this.ignoredPayloadTypes=[rn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(us)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Dc(Dr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:g,optionalNamespaces:b,sessionProperties:m,relays:E}=s;let A=o,C,$=!1;if(A&&($=this.client.core.pairing.pairings.get(A).active),!A||!$){const{topic:K,uri:N}=await this.client.core.pairing.create();A=K,C=N}const k=await this.client.core.crypto.generateKeyPair(),M=Dr({requiredNamespaces:g,optionalNamespaces:b,relays:E??[{protocol:op}],proposer:{publicKey:k,metadata:this.client.metadata}},m&&{sessionProperties:m}),{reject:H,resolve:Z,done:Q}=xn(me.FIVE_MINUTES,dp);if(this.events.once(Kt("session_connect"),async({error:K,session:N})=>{if(K)H(K);else if(N){N.self.publicKey=k;const j=Dc(Dr({},N),{requiredNamespaces:N.requiredNamespaces,optionalNamespaces:N.optionalNamespaces});await this.client.session.set(N.topic,j),await this.setExpiry(N.topic,N.expiry),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:N.peer.metadata}),Z(j)}}),!A){const{message:K}=de("NO_MATCHING_KEY",`connect() pairing topic: ${A}`);throw new Error(K)}const ue=await this.sendRequest(A,"wc_sessionPropose",M),L=ti(me.FIVE_MINUTES);return await this.setProposal(ue,Dr({id:ue,expiry:L},M)),{uri:C,approval:Q}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:g,sessionProperties:b}=r,m=this.client.proposal.get(s);let{pairingTopic:E,proposer:A,requiredNamespaces:C,optionalNamespaces:$}=m;E=E||"",Cn(C)||(C=$w(g,"approve()"));const k=await this.client.core.crypto.generateKeyPair(),M=A.publicKey,H=await this.client.core.crypto.generateSharedKey(k,M);E&&s&&(await this.client.core.pairing.updateMetadata({topic:E,metadata:A.metadata}),await this.sendResult(s,E,{relay:{protocol:o??"irn"},responderPublicKey:k}),await this.client.proposal.delete(s,Dt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:E}));const Z=Dr({relay:{protocol:o??"irn"},namespaces:g,requiredNamespaces:C,optionalNamespaces:$,pairingTopic:E,controller:{publicKey:k,metadata:this.client.metadata},expiry:ti(Sa)},b&&{sessionProperties:b});await this.client.core.relayer.subscribe(H),await this.sendRequest(H,"wc_sessionSettle",Z);const Q=Dc(Dr({},Z),{topic:H,pairingTopic:E,acknowledged:!1,self:Z.controller,peer:{publicKey:A.publicKey,metadata:A.metadata},controller:k});return await this.client.session.set(H,Q),await this.setExpiry(H,ti(Sa)),{topic:H,acknowledged:()=>new Promise(ue=>setTimeout(()=>ue(this.client.session.get(H)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:g}=this.client.proposal.get(s);g&&(await this.sendError(s,g,o),await this.client.proposal.delete(s,Dt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,g=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:b,resolve:m,reject:E}=xn();return this.events.once(Kt("session_update",g),({error:A})=>{A?E(A):m()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:b}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:g,resolve:b,reject:m}=xn();return this.events.once(Kt("session_extend",o),({error:E})=>{E?m(E):b()}),await this.setExpiry(s,ti(Sa)),{acknowledged:g}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:g,expiry:b}=r,m=await this.sendRequest(g,"wc_sessionRequest",{request:o,chainId:s},b),{done:E,resolve:A,reject:C}=xn(b);this.events.once(Kt("session_request",m),({error:k,result:M})=>{k?C(k):A(M)}),this.client.events.emit("session_request_sent",{topic:g,request:o,chainId:s,id:m});const $=await this.client.core.storage.getItem(a2);return Iw({id:m,topic:g,wcDeepLink:$}),await E()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:g}=o;_i(o)?await this.sendResult(g,s,o.result):Br(o)&&await this.sendError(g,s,o.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:g,resolve:b,reject:m}=xn();this.events.once(Kt("session_ping",o),({error:E})=>{E?m(E):b()}),await g()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:g}=r;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:g})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=vu().toString();let g;const b=m=>{(m==null?void 0:m.id.toString())===o&&(this.client.core.relayer.events.removeListener(Tt.message_ack,b),g())};await Promise.all([new Promise(m=>{g=m,this.client.core.relayer.on(Tt.message_ack,b)}),this.sendRequest(s,"wc_sessionDelete",Dt("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>zw(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(g=>{var b,m;return((b=g.peerMetadata)==null?void 0:b.url)&&((m=g.peerMetadata)==null?void 0:m.url)===r.peer.metadata.url&&g.topic&&g.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(g=>this.client.core.pairing.disconnect({topic:g.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Dt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Dt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=us.wc_sessionRequest.req.ttl,{id:o,topic:g,params:b}=r;await this.client.pendingRequest.set(o,{id:o,topic:g,params:b}),s&&this.client.core.expirer.set(o,ti(s))},this.sendRequest=async(r,s,o,g,b)=>{const m=Ka(s,o);if(pu()&&l2.includes(s)){const C=Tn(JSON.stringify(m));await this.client.core.verify.register({attestationId:C})}const E=await this.client.core.crypto.encode(r,m),A=us[s].req;return g&&(A.ttl=g),b&&(A.id=b),this.client.core.history.set(r,m),this.client.core.relayer.publish(r,E,A),m.id},this.sendResult=async(r,s,o)=>{const g=mu(r,o),b=await this.client.core.crypto.encode(s,g),m=await this.client.core.history.get(s,r),E=us[m.request.method].res;this.client.core.relayer.publish(s,b,E),await this.client.core.history.resolve(g)},this.sendError=async(r,s,o)=>{const g=Ba(r,o),b=await this.client.core.crypto.encode(s,g),m=await this.client.core.history.get(s,r),E=us[m.request.method].res;this.client.core.relayer.publish(s,b,E),await this.client.core.history.resolve(g)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{Ti(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ti(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=r=>{const{topic:s,payload:o}=r,g=o.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${g}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,g=(await this.client.core.history.get(s,o.id)).request.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${g}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=de("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:g}=s;try{this.isValidConnect(Dr({},s.params));const b=ti(me.FIVE_MINUTES),m=Dr({id:g,pairingTopic:r,expiry:b},o);await this.setProposal(g,m);const E=Tn(JSON.stringify(s)),A=await this.getVerifyContext(E,m.proposer.metadata);this.client.events.emit("session_proposal",{id:g,params:m,verifyContext:A})}catch(b){await this.sendError(g,r,b),this.client.logger.error(b)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(_i(s)){const{result:g}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:g});const b=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:b});const m=b.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:m});const E=g.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:E});const A=await this.client.core.crypto.generateSharedKey(m,E);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:A});const C=await this.client.core.relayer.subscribe(A);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:C}),await this.client.core.pairing.activate({topic:r})}else Br(s)&&(await this.client.proposal.delete(o,Dt("USER_DISCONNECTED")),this.events.emit(Kt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidSessionSettleRequest(g);const{relay:b,controller:m,expiry:E,namespaces:A,requiredNamespaces:C,optionalNamespaces:$,sessionProperties:k,pairingTopic:M}=s.params,H=Dr({topic:r,relay:b,expiry:E,namespaces:A,acknowledged:!0,pairingTopic:M,requiredNamespaces:C,optionalNamespaces:$,controller:m.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:m.publicKey,metadata:m.metadata}},k&&{sessionProperties:k});await this.sendResult(s.id,r,!0),this.events.emit(Kt("session_connect"),{session:H}),this.cleanupDuplicatePairings(H)}catch(b){await this.sendError(o,r,b),this.client.logger.error(b)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;_i(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Kt("session_approve",o),{})):Br(s)&&(await this.client.session.delete(r,Dt("USER_DISCONNECTED")),this.events.emit(Kt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:g}=s;try{this.isValidUpdate(Dr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult(g,r,!0),this.client.events.emit("session_update",{id:g,topic:r,params:o})}catch(b){await this.sendError(g,r,b),this.client.logger.error(b)}},this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;_i(s)?this.events.emit(Kt("session_update",o),{}):Br(s)&&this.events.emit(Kt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,ti(Sa)),await this.sendResult(o,r,!0),this.client.events.emit("session_extend",{id:o,topic:r})}catch(g){await this.sendError(o,r,g),this.client.logger.error(g)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;_i(s)?this.events.emit(Kt("session_extend",o),{}):Br(s)&&this.events.emit(Kt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult(o,r,!0),this.client.events.emit("session_ping",{id:o,topic:r})}catch(g){await this.sendError(o,r,g),this.client.logger.error(g)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{_i(s)?this.events.emit(Kt("session_ping",o),{}):Br(s)&&this.events.emit(Kt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(g=>{this.client.core.relayer.once(Tt.publish,async()=>{g(await this.deleteSession(r))})}),this.sendResult(o,r,!0)]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(g){this.client.logger.error(g)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidRequest(Dr({topic:r},g)),await this.setPendingSessionRequest({id:o,topic:r,params:g});const b=Tn(JSON.stringify(s)),m=this.client.session.get(r),E=await this.getVerifyContext(b,m.peer.metadata);this.client.events.emit("session_request",{id:o,topic:r,params:g,verifyContext:E})}catch(b){await this.sendError(o,r,b),this.client.logger.error(b)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;_i(s)?this.events.emit(Kt("session_request",o),{result:s.result}):Br(s)&&this.events.emit(Kt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidEmit(Dr({topic:r},g)),this.client.events.emit("session_event",{id:o,topic:r,params:g})}catch(b){await this.sendError(o,r,b),this.client.logger.error(b)}},this.isValidConnect=async r=>{if(!_r(r)){const{message:E}=de("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(E)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:g,sessionProperties:b,relays:m}=r;if(or(s)||await this.isValidPairingTopic(s),!Qw(m,!0)){const{message:E}=de("MISSING_OR_INVALID",`connect() relays: ${m}`);throw new Error(E)}!or(o)&&Cn(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(g)&&Cn(g)!==0&&this.validateNamespaces(g,"optionalNamespaces"),or(b)||this.validateSessionProps(b,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=Zw(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!_r(r))throw new Error(de("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:g,sessionProperties:b}=r;await this.isValidProposalId(s);const m=this.client.proposal.get(s),E=Aa(o,"approve()");if(E)throw new Error(E.message);const A=df(m.requiredNamespaces,o,"approve()");if(A)throw new Error(A.message);if(!Wt(g,!0)){const{message:C}=de("MISSING_OR_INVALID",`approve() relayProtocol: ${g}`);throw new Error(C)}or(b)||this.validateSessionProps(b,"sessionProperties")},this.isValidReject=async r=>{if(!_r(r)){const{message:g}=de("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(g)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!tE(o)){const{message:g}=de("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidSessionSettleRequest=r=>{if(!_r(r)){const{message:A}=de("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(A)}const{relay:s,controller:o,namespaces:g,expiry:b}=r;if(!qd(s)){const{message:A}=de("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(A)}const m=Gw(o,"onSessionSettleRequest()");if(m)throw new Error(m.message);const E=Aa(g,"onSessionSettleRequest()");if(E)throw new Error(E.message);if(Ti(b)){const{message:A}=de("EXPIRED","onSessionSettleRequest()");throw new Error(A)}},this.isValidUpdate=async r=>{if(!_r(r)){const{message:E}=de("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(E)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const g=this.client.session.get(s),b=Aa(o,"update()");if(b)throw new Error(b.message);const m=df(g.requiredNamespaces,o,"update()");if(m)throw new Error(m.message)},this.isValidExtend=async r=>{if(!_r(r)){const{message:o}=de("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!_r(r)){const{message:E}=de("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(E)}const{topic:s,request:o,chainId:g,expiry:b}=r;await this.isValidSessionTopic(s);const{namespaces:m}=this.client.session.get(s);if(!ff(m,g)){const{message:E}=de("MISSING_OR_INVALID",`request() chainId: ${g}`);throw new Error(E)}if(!rE(o)){const{message:E}=de("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(E)}if(!sE(m,g,o.method)){const{message:E}=de("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(E)}if(b&&!uE(b,jc)){const{message:E}=de("MISSING_OR_INVALID",`request() expiry: ${b}. Expiry must be a number (in seconds) between ${jc.min} and ${jc.max}`);throw new Error(E)}},this.isValidRespond=async r=>{if(!_r(r)){const{message:g}=de("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(g)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!iE(o)){const{message:g}=de("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidPing=async r=>{if(!_r(r)){const{message:o}=de("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!_r(r)){const{message:m}=de("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(m)}const{topic:s,event:o,chainId:g}=r;await this.isValidSessionTopic(s);const{namespaces:b}=this.client.session.get(s);if(!ff(b,g)){const{message:m}=de("MISSING_OR_INVALID",`emit() chainId: ${g}`);throw new Error(m)}if(!nE(o)){const{message:m}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(m)}if(!aE(b,g,o.name)){const{message:m}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(m)}},this.isValidDisconnect=async r=>{if(!_r(r)){const{message:o}=de("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const g=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});g&&(o.verified.origin=g,o.verified.validation=g===s.url?"VALID":"INVALID")}catch(g){this.client.logger.error(g)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Wt(o,!1)){const{message:g}=de("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(g)}})}}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Tt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);bu(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Va(o)?(await this.client.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o})):this.onRelayEventUnknownPayload({topic:r,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async t=>{const{topic:r,id:s}=Ld(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,de("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!Wt(t,!1)){const{message:r}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=de("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Wt(t,!1)){const{message:r}=de("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=de("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Wt(t,!1)){const{message:r}=de("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=de("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!eE(t)){const{message:r}=de("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=de("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class v2 extends ka{constructor(t,r){super(t,r,o2,Eu),this.core=t,this.logger=r}}class m2 extends ka{constructor(t,r){super(t,r,c2,Eu),this.core=t,this.logger=r}}class b2 extends ka{constructor(t,r){super(t,r,h2,Eu,s=>s.id),this.core=t,this.logger=r}}class Su extends jm{constructor(t){super(t),this.protocol=hp,this.version=lp,this.name=Nc.name,this.events=new Lr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Nc.name,this.metadata=(t==null?void 0:t.metadata)||yw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Nc.logger}));this.core=(t==null?void 0:t.core)||new s2(t),this.logger=Qe.generateChildLogger(r,this.name),this.session=new m2(this.core,this.logger),this.proposal=new v2(this.core,this.logger),this.pendingRequest=new b2(this.core,this.logger),this.engine=new y2(this)}static async init(t){const r=new Su(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const w2={Accept:"application/json","Content-Type":"application/json"},E2="POST",zf={headers:w2,method:E2},Hf=10;class nn{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Lr.EventEmitter,this.isAvailable=!1,this.registering=!1,!vf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=fs(t),g=await(await Ol(this.url,Object.assign(Object.assign({},zf),{body:s}))).json();this.onPayload({data:g})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!vf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",g=>{this.resetMaxListeners(),o(g)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=fs({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ol(t,Object.assign(Object.assign({},zf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?nu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),g=Ba(t,o);this.events.emit("payload",g)}parseError(t,r=this.url){return Kd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Hf&&this.events.setMaxListeners(Hf)}}const Kf="error",S2="wss://relay.walletconnect.com",I2="wc",O2="universal_provider",Bf=`${I2}@2:${O2}:`,P2="https://rpc.walletconnect.com/v1",ji={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Vr<"u"?Vr:typeof self<"u"?self:{},Zc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",o=200,g="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",b="Expected a function",m="Invalid `variable` option passed into `_.template`",E="__lodash_hash_undefined__",A=500,C="__lodash_placeholder__",$=1,k=2,M=4,H=1,Z=2,Q=1,ue=2,L=4,K=8,N=16,j=32,O=64,u=128,y=256,X=512,c=30,f="...",d=800,w=16,_=1,p=2,T=3,F=1/0,W=9007199254740991,P=17976931348623157e292,q=0/0,te=4294967295,re=te-1,ie=te>>>1,ge=[["ary",u],["bind",Q],["bindKey",ue],["curry",K],["curryRight",N],["flip",X],["partial",j],["partialRight",O],["rearg",y]],le="[object Arguments]",be="[object Array]",J="[object AsyncFunction]",Y="[object Boolean]",z="[object Date]",l="[object DOMException]",D="[object Error]",he="[object Function]",pe="[object GeneratorFunction]",Oe="[object Map]",He="[object Number]",Ve="[object Null]",Le="[object Object]",pt="[object Promise]",gt="[object Proxy]",Me="[object RegExp]",Pe="[object Set]",je="[object String]",De="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",Fe="[object WeakSet]",Ie="[object ArrayBuffer]",Te="[object DataView]",Ke="[object Float32Array]",xe="[object Float64Array]",Ge="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",er="[object Uint16Array]",hr="[object Uint32Array]",Gr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,ri=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vi=/&(?:amp|lt|gt|quot|#39);/g,Di=/[&<>"']/g,Et=RegExp(vi.source),_t=RegExp(Di.source),St=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,$t=RegExp(Ot.source),Pt=/^\s+/,Ct=/\s/,xt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Wa=/[()=,{}\[\]\/\s]/,Ya=/\\(\\)?/g,Ja=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Or=/\w*$/,Xa=/^[-+]0x[0-9a-f]+$/i,Za=/^0b[01]+$/i,Qa=/^\[object .+?Constructor\]$/,eo=/^0o[0-7]+$/i,to=/^(?:0|[1-9]\d*)$/,ii=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,sn=/($^)/,ro=/['\n\r\u2028\u2029\\]/g,an="\\ud800-\\udfff",io="\\u0300-\\u036f",no="\\ufe20-\\ufe2f",on="\\u20d0-\\u20ff",ms=io+no+on,bs="\\u2700-\\u27bf",$r="a-z\\xdf-\\xf6\\xf8-\\xff",so="\\xac\\xb1\\xd7\\xf7",ao="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",oo="\\u2000-\\u206f",co=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ws="A-Z\\xc0-\\xd6\\xd8-\\xde",Es="\\ufe0e\\ufe0f",Fi=so+ao+oo+co,Dn="['’]",Ui="["+an+"]",Fn="["+Fi+"]",Li="["+ms+"]",Ss="\\d+",uo="["+bs+"]",Is="["+$r+"]",Os="[^"+an+Fi+Ss+bs+$r+ws+"]",cn="\\ud83c[\\udffb-\\udfff]",ho="(?:"+Li+"|"+cn+")",Ps="[^"+an+"]",un="(?:\\ud83c[\\udde6-\\uddff]){2}",mi="[\\ud800-\\udbff][\\udc00-\\udfff]",vr="["+ws+"]",xs="\\u200d",As="(?:"+Is+"|"+Os+")",kr="(?:"+vr+"|"+Os+")",Ts="(?:"+Dn+"(?:d|ll|m|re|s|t|ve))?",Cs="(?:"+Dn+"(?:D|LL|M|RE|S|T|VE))?",Rs=ho+"?",Ns="["+Es+"]?",lo="(?:"+xs+"(?:"+[Ps,un,mi].join("|")+")"+Ns+Rs+")*",ni="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",js="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ds=Ns+Rs+lo,hn="(?:"+[uo,un,mi].join("|")+")"+Ds,fo="(?:"+[Ps+Li+"?",Li,un,mi,Ui].join("|")+")",Un=RegExp(Dn,"g"),po=RegExp(Li,"g"),ln=RegExp(cn+"(?="+cn+")|"+fo+Ds,"g"),Fs=RegExp([vr+"?"+Is+"+"+Ts+"(?="+[Fn,vr,"$"].join("|")+")",kr+"+"+Cs+"(?="+[Fn,vr+As,"$"].join("|")+")",vr+"?"+As+"+"+Ts,vr+"+"+Cs,js,ni,Ss,hn].join("|"),"g"),Us=RegExp("["+xs+an+ms+Es+"]"),$i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ls=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],go=-1,at={};at[Ke]=at[xe]=at[Ge]=at[We]=at[et]=at[tt]=at[Je]=at[er]=at[hr]=!0,at[le]=at[be]=at[Ie]=at[Y]=at[Te]=at[z]=at[D]=at[he]=at[Oe]=at[He]=at[Le]=at[Me]=at[Pe]=at[je]=at[Ae]=!1;var st={};st[le]=st[be]=st[Ie]=st[Te]=st[Y]=st[z]=st[Ke]=st[xe]=st[Ge]=st[We]=st[et]=st[Oe]=st[He]=st[Le]=st[Me]=st[Pe]=st[je]=st[De]=st[tt]=st[Je]=st[er]=st[hr]=!0,st[D]=st[he]=st[Ae]=!1;var x={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},oe={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},_e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Re=parseInt,ft=typeof hs=="object"&&hs&&hs.Object===Object&&hs,zt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||zt||Function("return this")(),ct=t&&!t.nodeType&&t,Rt=ct&&!0&&n&&!n.nodeType&&n,lr=Rt&&Rt.exports===ct,Ht=lr&&ft.process,dt=function(){try{var V=Rt&&Rt.require&&Rt.require("util").types;return V||Ht&&Ht.binding&&Ht.binding("util")}catch{}}(),rr=dt&&dt.isArrayBuffer,Mr=dt&&dt.isDate,Pr=dt&&dt.isMap,Wr=dt&&dt.isRegExp,Ln=dt&&dt.isSet,Mi=dt&&dt.isTypedArray;function Gt(V,ne,ee){switch(ee.length){case 0:return V.call(ne);case 1:return V.call(ne,ee[0]);case 2:return V.call(ne,ee[0],ee[1]);case 3:return V.call(ne,ee[0],ee[1],ee[2])}return V.apply(ne,ee)}function gp(V,ne,ee,ye){for(var Ce=-1,rt=V==null?0:V.length;++Ce<rt;){var Bt=V[Ce];ne(ye,Bt,ee(Bt),V)}return ye}function xr(V,ne){for(var ee=-1,ye=V==null?0:V.length;++ee<ye&&ne(V[ee],ee,V)!==!1;);return V}function _p(V,ne){for(var ee=V==null?0:V.length;ee--&&ne(V[ee],ee,V)!==!1;);return V}function Pu(V,ne){for(var ee=-1,ye=V==null?0:V.length;++ee<ye;)if(!ne(V[ee],ee,V))return!1;return!0}function bi(V,ne){for(var ee=-1,ye=V==null?0:V.length,Ce=0,rt=[];++ee<ye;){var Bt=V[ee];ne(Bt,ee,V)&&(rt[Ce++]=Bt)}return rt}function $s(V,ne){var ee=V==null?0:V.length;return!!ee&&fn(V,ne,0)>-1}function _o(V,ne,ee){for(var ye=-1,Ce=V==null?0:V.length;++ye<Ce;)if(ee(ne,V[ye]))return!0;return!1}function vt(V,ne){for(var ee=-1,ye=V==null?0:V.length,Ce=Array(ye);++ee<ye;)Ce[ee]=ne(V[ee],ee,V);return Ce}function wi(V,ne){for(var ee=-1,ye=ne.length,Ce=V.length;++ee<ye;)V[Ce+ee]=ne[ee];return V}function yo(V,ne,ee,ye){var Ce=-1,rt=V==null?0:V.length;for(ye&&rt&&(ee=V[++Ce]);++Ce<rt;)ee=ne(ee,V[Ce],Ce,V);return ee}function yp(V,ne,ee,ye){var Ce=V==null?0:V.length;for(ye&&Ce&&(ee=V[--Ce]);Ce--;)ee=ne(ee,V[Ce],Ce,V);return ee}function vo(V,ne){for(var ee=-1,ye=V==null?0:V.length;++ee<ye;)if(ne(V[ee],ee,V))return!0;return!1}var vp=mo("length");function mp(V){return V.split("")}function bp(V){return V.match(qt)||[]}function xu(V,ne,ee){var ye;return ee(V,function(Ce,rt,Bt){if(ne(Ce,rt,Bt))return ye=rt,!1}),ye}function Ms(V,ne,ee,ye){for(var Ce=V.length,rt=ee+(ye?1:-1);ye?rt--:++rt<Ce;)if(ne(V[rt],rt,V))return rt;return-1}function fn(V,ne,ee){return ne===ne?Np(V,ne,ee):Ms(V,Au,ee)}function wp(V,ne,ee,ye){for(var Ce=ee-1,rt=V.length;++Ce<rt;)if(ye(V[Ce],ne))return Ce;return-1}function Au(V){return V!==V}function Tu(V,ne){var ee=V==null?0:V.length;return ee?wo(V,ne)/ee:q}function mo(V){return function(ne){return ne==null?r:ne[V]}}function bo(V){return function(ne){return V==null?r:V[ne]}}function Cu(V,ne,ee,ye,Ce){return Ce(V,function(rt,Bt,ut){ee=ye?(ye=!1,rt):ne(ee,rt,Bt,ut)}),ee}function Ep(V,ne){var ee=V.length;for(V.sort(ne);ee--;)V[ee]=V[ee].value;return V}function wo(V,ne){for(var ee,ye=-1,Ce=V.length;++ye<Ce;){var rt=ne(V[ye]);rt!==r&&(ee=ee===r?rt:ee+rt)}return ee}function Eo(V,ne){for(var ee=-1,ye=Array(V);++ee<V;)ye[ee]=ne(ee);return ye}function Sp(V,ne){return vt(ne,function(ee){return[ee,V[ee]]})}function Ru(V){return V&&V.slice(0,Fu(V)+1).replace(Pt,"")}function mr(V){return function(ne){return V(ne)}}function So(V,ne){return vt(ne,function(ee){return V[ee]})}function $n(V,ne){return V.has(ne)}function Nu(V,ne){for(var ee=-1,ye=V.length;++ee<ye&&fn(ne,V[ee],0)>-1;);return ee}function ju(V,ne){for(var ee=V.length;ee--&&fn(ne,V[ee],0)>-1;);return ee}function Ip(V,ne){for(var ee=V.length,ye=0;ee--;)V[ee]===ne&&++ye;return ye}var Op=bo(x),Pp=bo(B);function xp(V){return"\\"+_e[V]}function Ap(V,ne){return V==null?r:V[ne]}function dn(V){return Us.test(V)}function Tp(V){return $i.test(V)}function Cp(V){for(var ne,ee=[];!(ne=V.next()).done;)ee.push(ne.value);return ee}function Io(V){var ne=-1,ee=Array(V.size);return V.forEach(function(ye,Ce){ee[++ne]=[Ce,ye]}),ee}function Du(V,ne){return function(ee){return V(ne(ee))}}function Ei(V,ne){for(var ee=-1,ye=V.length,Ce=0,rt=[];++ee<ye;){var Bt=V[ee];(Bt===ne||Bt===C)&&(V[ee]=C,rt[Ce++]=ee)}return rt}function qs(V){var ne=-1,ee=Array(V.size);return V.forEach(function(ye){ee[++ne]=ye}),ee}function Rp(V){var ne=-1,ee=Array(V.size);return V.forEach(function(ye){ee[++ne]=[ye,ye]}),ee}function Np(V,ne,ee){for(var ye=ee-1,Ce=V.length;++ye<Ce;)if(V[ye]===ne)return ye;return-1}function jp(V,ne,ee){for(var ye=ee+1;ye--;)if(V[ye]===ne)return ye;return ye}function pn(V){return dn(V)?Fp(V):vp(V)}function qr(V){return dn(V)?Up(V):mp(V)}function Fu(V){for(var ne=V.length;ne--&&Ct.test(V.charAt(ne)););return ne}var Dp=bo(oe);function Fp(V){for(var ne=ln.lastIndex=0;ln.test(V);)++ne;return ne}function Up(V){return V.match(ln)||[]}function Lp(V){return V.match(Fs)||[]}var $p=function V(ne){ne=ne==null?Xe:gn.defaults(Xe.Object(),ne,gn.pick(Xe,Ls));var ee=ne.Array,ye=ne.Date,Ce=ne.Error,rt=ne.Function,Bt=ne.Math,ut=ne.Object,Oo=ne.RegExp,Mp=ne.String,Ar=ne.TypeError,zs=ee.prototype,qp=rt.prototype,_n=ut.prototype,Hs=ne["__core-js_shared__"],Ks=qp.toString,nt=_n.hasOwnProperty,zp=0,Uu=function(){var e=/[^.]+$/.exec(Hs&&Hs.keys&&Hs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Bs=_n.toString,Hp=Ks.call(ut),Kp=Xe._,Bp=Oo("^"+Ks.call(nt).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vs=lr?ne.Buffer:r,Si=ne.Symbol,Gs=ne.Uint8Array,Lu=Vs?Vs.allocUnsafe:r,ks=Du(ut.getPrototypeOf,ut),$u=ut.create,Mu=_n.propertyIsEnumerable,Ws=zs.splice,qu=Si?Si.isConcatSpreadable:r,Mn=Si?Si.iterator:r,qi=Si?Si.toStringTag:r,Ys=function(){try{var e=Vi(ut,"defineProperty");return e({},"",{}),e}catch{}}(),Vp=ne.clearTimeout!==Xe.clearTimeout&&ne.clearTimeout,Gp=ye&&ye.now!==Xe.Date.now&&ye.now,kp=ne.setTimeout!==Xe.setTimeout&&ne.setTimeout,Js=Bt.ceil,Xs=Bt.floor,Po=ut.getOwnPropertySymbols,Wp=Vs?Vs.isBuffer:r,zu=ne.isFinite,Yp=zs.join,Jp=Du(ut.keys,ut),Vt=Bt.max,Xt=Bt.min,Xp=ye.now,Zp=ne.parseInt,Hu=Bt.random,Qp=zs.reverse,xo=Vi(ne,"DataView"),qn=Vi(ne,"Map"),Ao=Vi(ne,"Promise"),yn=Vi(ne,"Set"),zn=Vi(ne,"WeakMap"),Hn=Vi(ut,"create"),Zs=zn&&new zn,vn={},eg=Gi(xo),tg=Gi(qn),rg=Gi(Ao),ig=Gi(yn),ng=Gi(zn),Qs=Si?Si.prototype:r,Kn=Qs?Qs.valueOf:r,Ku=Qs?Qs.toString:r;function S(e){if(At(e)&&!Ne(e)&&!(e instanceof Ye)){if(e instanceof Tr)return e;if(nt.call(e,"__wrapped__"))return Bh(e)}return new Tr(e)}var mn=function(){function e(){}return function(i){if(!bt(i))return{};if($u)return $u(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function ea(){}function Tr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}S.templateSettings={escape:St,evaluate:It,interpolate:mt,variable:"",imports:{_:S}},S.prototype=ea.prototype,S.prototype.constructor=S,Tr.prototype=mn(ea.prototype),Tr.prototype.constructor=Tr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=te,this.__views__=[]}function sg(){var e=new Ye(this.__wrapped__);return e.__actions__=fr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=fr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=fr(this.__views__),e}function ag(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function og(){var e=this.__wrapped__.value(),i=this.__dir__,a=Ne(e),h=i<0,v=a?e.length:0,I=m0(0,v,this.__views__),R=I.start,U=I.end,G=U-R,se=h?U:R-1,ae=this.__iteratees__,ce=ae.length,fe=0,ve=Xt(G,this.__takeCount__);if(!a||!h&&v==G&&ve==G)return dh(e,this.__actions__);var Ee=[];e:for(;G--&&fe<ve;){se+=i;for(var ze=-1,Se=e[se];++ze<ce;){var ke=ae[ze],Ze=ke.iteratee,Er=ke.type,sr=Ze(Se);if(Er==p)Se=sr;else if(!sr){if(Er==_)continue e;break e}}Ee[fe++]=Se}return Ee}Ye.prototype=mn(ea.prototype),Ye.prototype.constructor=Ye;function zi(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var h=e[i];this.set(h[0],h[1])}}function cg(){this.__data__=Hn?Hn(null):{},this.size=0}function ug(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function hg(e){var i=this.__data__;if(Hn){var a=i[e];return a===E?r:a}return nt.call(i,e)?i[e]:r}function lg(e){var i=this.__data__;return Hn?i[e]!==r:nt.call(i,e)}function fg(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Hn&&i===r?E:i,this}zi.prototype.clear=cg,zi.prototype.delete=ug,zi.prototype.get=hg,zi.prototype.has=lg,zi.prototype.set=fg;function si(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var h=e[i];this.set(h[0],h[1])}}function dg(){this.__data__=[],this.size=0}function pg(e){var i=this.__data__,a=ta(i,e);if(a<0)return!1;var h=i.length-1;return a==h?i.pop():Ws.call(i,a,1),--this.size,!0}function gg(e){var i=this.__data__,a=ta(i,e);return a<0?r:i[a][1]}function _g(e){return ta(this.__data__,e)>-1}function yg(e,i){var a=this.__data__,h=ta(a,e);return h<0?(++this.size,a.push([e,i])):a[h][1]=i,this}si.prototype.clear=dg,si.prototype.delete=pg,si.prototype.get=gg,si.prototype.has=_g,si.prototype.set=yg;function ai(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var h=e[i];this.set(h[0],h[1])}}function vg(){this.size=0,this.__data__={hash:new zi,map:new(qn||si),string:new zi}}function mg(e){var i=da(this,e).delete(e);return this.size-=i?1:0,i}function bg(e){return da(this,e).get(e)}function wg(e){return da(this,e).has(e)}function Eg(e,i){var a=da(this,e),h=a.size;return a.set(e,i),this.size+=a.size==h?0:1,this}ai.prototype.clear=vg,ai.prototype.delete=mg,ai.prototype.get=bg,ai.prototype.has=wg,ai.prototype.set=Eg;function Hi(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new ai;++i<a;)this.add(e[i])}function Sg(e){return this.__data__.set(e,E),this}function Ig(e){return this.__data__.has(e)}Hi.prototype.add=Hi.prototype.push=Sg,Hi.prototype.has=Ig;function zr(e){var i=this.__data__=new si(e);this.size=i.size}function Og(){this.__data__=new si,this.size=0}function Pg(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function xg(e){return this.__data__.get(e)}function Ag(e){return this.__data__.has(e)}function Tg(e,i){var a=this.__data__;if(a instanceof si){var h=a.__data__;if(!qn||h.length<o-1)return h.push([e,i]),this.size=++a.size,this;a=this.__data__=new ai(h)}return a.set(e,i),this.size=a.size,this}zr.prototype.clear=Og,zr.prototype.delete=Pg,zr.prototype.get=xg,zr.prototype.has=Ag,zr.prototype.set=Tg;function Bu(e,i){var a=Ne(e),h=!a&&ki(e),v=!a&&!h&&Ai(e),I=!a&&!h&&!v&&Sn(e),R=a||h||v||I,U=R?Eo(e.length,Mp):[],G=U.length;for(var se in e)(i||nt.call(e,se))&&!(R&&(se=="length"||v&&(se=="offset"||se=="parent")||I&&(se=="buffer"||se=="byteLength"||se=="byteOffset")||hi(se,G)))&&U.push(se);return U}function Vu(e){var i=e.length;return i?e[Mo(0,i-1)]:r}function Cg(e,i){return pa(fr(e),Ki(i,0,e.length))}function Rg(e){return pa(fr(e))}function To(e,i,a){(a!==r&&!Hr(e[i],a)||a===r&&!(i in e))&&oi(e,i,a)}function Bn(e,i,a){var h=e[i];(!(nt.call(e,i)&&Hr(h,a))||a===r&&!(i in e))&&oi(e,i,a)}function ta(e,i){for(var a=e.length;a--;)if(Hr(e[a][0],i))return a;return-1}function Ng(e,i,a,h){return Ii(e,function(v,I,R){i(h,v,a(v),R)}),h}function Gu(e,i){return e&&Jr(i,kt(i),e)}function jg(e,i){return e&&Jr(i,pr(i),e)}function oi(e,i,a){i=="__proto__"&&Ys?Ys(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function Co(e,i){for(var a=-1,h=i.length,v=ee(h),I=e==null;++a<h;)v[a]=I?r:hc(e,i[a]);return v}function Ki(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Cr(e,i,a,h,v,I){var R,U=i&$,G=i&k,se=i&M;if(a&&(R=v?a(e,h,v,I):a(e)),R!==r)return R;if(!bt(e))return e;var ae=Ne(e);if(ae){if(R=w0(e),!U)return fr(e,R)}else{var ce=Zt(e),fe=ce==he||ce==pe;if(Ai(e))return _h(e,U);if(ce==Le||ce==le||fe&&!v){if(R=G||fe?{}:Fh(e),!U)return G?h0(e,jg(R,e)):u0(e,Gu(R,e))}else{if(!st[ce])return v?e:{};R=E0(e,ce,U)}}I||(I=new zr);var ve=I.get(e);if(ve)return ve;I.set(e,R),hl(e)?e.forEach(function(Se){R.add(Cr(Se,i,a,Se,e,I))}):cl(e)&&e.forEach(function(Se,ke){R.set(ke,Cr(Se,i,a,ke,e,I))});var Ee=se?G?Jo:Yo:G?pr:kt,ze=ae?r:Ee(e);return xr(ze||e,function(Se,ke){ze&&(ke=Se,Se=e[ke]),Bn(R,ke,Cr(Se,i,a,ke,e,I))}),R}function Dg(e){var i=kt(e);return function(a){return ku(a,e,i)}}function ku(e,i,a){var h=a.length;if(e==null)return!h;for(e=ut(e);h--;){var v=a[h],I=i[v],R=e[v];if(R===r&&!(v in e)||!I(R))return!1}return!0}function Wu(e,i,a){if(typeof e!="function")throw new Ar(b);return Xn(function(){e.apply(r,a)},i)}function Vn(e,i,a,h){var v=-1,I=$s,R=!0,U=e.length,G=[],se=i.length;if(!U)return G;a&&(i=vt(i,mr(a))),h?(I=_o,R=!1):i.length>=o&&(I=$n,R=!1,i=new Hi(i));e:for(;++v<U;){var ae=e[v],ce=a==null?ae:a(ae);if(ae=h||ae!==0?ae:0,R&&ce===ce){for(var fe=se;fe--;)if(i[fe]===ce)continue e;G.push(ae)}else I(i,ce,h)||G.push(ae)}return G}var Ii=wh(Yr),Yu=wh(No,!0);function Fg(e,i){var a=!0;return Ii(e,function(h,v,I){return a=!!i(h,v,I),a}),a}function ra(e,i,a){for(var h=-1,v=e.length;++h<v;){var I=e[h],R=i(I);if(R!=null&&(U===r?R===R&&!wr(R):a(R,U)))var U=R,G=I}return G}function Ug(e,i,a,h){var v=e.length;for(a=$e(a),a<0&&(a=-a>v?0:v+a),h=h===r||h>v?v:$e(h),h<0&&(h+=v),h=a>h?0:fl(h);a<h;)e[a++]=i;return e}function Ju(e,i){var a=[];return Ii(e,function(h,v,I){i(h,v,I)&&a.push(h)}),a}function Yt(e,i,a,h,v){var I=-1,R=e.length;for(a||(a=I0),v||(v=[]);++I<R;){var U=e[I];i>0&&a(U)?i>1?Yt(U,i-1,a,h,v):wi(v,U):h||(v[v.length]=U)}return v}var Ro=Eh(),Xu=Eh(!0);function Yr(e,i){return e&&Ro(e,i,kt)}function No(e,i){return e&&Xu(e,i,kt)}function ia(e,i){return bi(i,function(a){return li(e[a])})}function Bi(e,i){i=Pi(i,e);for(var a=0,h=i.length;e!=null&&a<h;)e=e[Xr(i[a++])];return a&&a==h?e:r}function Zu(e,i,a){var h=i(e);return Ne(e)?h:wi(h,a(e))}function ir(e){return e==null?e===r?qe:Ve:qi&&qi in ut(e)?v0(e):R0(e)}function jo(e,i){return e>i}function Lg(e,i){return e!=null&&nt.call(e,i)}function $g(e,i){return e!=null&&i in ut(e)}function Mg(e,i,a){return e>=Xt(i,a)&&e<Vt(i,a)}function Do(e,i,a){for(var h=a?_o:$s,v=e[0].length,I=e.length,R=I,U=ee(I),G=1/0,se=[];R--;){var ae=e[R];R&&i&&(ae=vt(ae,mr(i))),G=Xt(ae.length,G),U[R]=!a&&(i||v>=120&&ae.length>=120)?new Hi(R&&ae):r}ae=e[0];var ce=-1,fe=U[0];e:for(;++ce<v&&se.length<G;){var ve=ae[ce],Ee=i?i(ve):ve;if(ve=a||ve!==0?ve:0,!(fe?$n(fe,Ee):h(se,Ee,a))){for(R=I;--R;){var ze=U[R];if(!(ze?$n(ze,Ee):h(e[R],Ee,a)))continue e}fe&&fe.push(Ee),se.push(ve)}}return se}function qg(e,i,a,h){return Yr(e,function(v,I,R){i(h,a(v),I,R)}),h}function Gn(e,i,a){i=Pi(i,e),e=Mh(e,i);var h=e==null?e:e[Xr(Nr(i))];return h==null?r:Gt(h,e,a)}function Qu(e){return At(e)&&ir(e)==le}function zg(e){return At(e)&&ir(e)==Ie}function Hg(e){return At(e)&&ir(e)==z}function kn(e,i,a,h,v){return e===i?!0:e==null||i==null||!At(e)&&!At(i)?e!==e&&i!==i:Kg(e,i,a,h,kn,v)}function Kg(e,i,a,h,v,I){var R=Ne(e),U=Ne(i),G=R?be:Zt(e),se=U?be:Zt(i);G=G==le?Le:G,se=se==le?Le:se;var ae=G==Le,ce=se==Le,fe=G==se;if(fe&&Ai(e)){if(!Ai(i))return!1;R=!0,ae=!1}if(fe&&!ae)return I||(I=new zr),R||Sn(e)?Nh(e,i,a,h,v,I):_0(e,i,G,a,h,v,I);if(!(a&H)){var ve=ae&&nt.call(e,"__wrapped__"),Ee=ce&&nt.call(i,"__wrapped__");if(ve||Ee){var ze=ve?e.value():e,Se=Ee?i.value():i;return I||(I=new zr),v(ze,Se,a,h,I)}}return fe?(I||(I=new zr),y0(e,i,a,h,v,I)):!1}function Bg(e){return At(e)&&Zt(e)==Oe}function Fo(e,i,a,h){var v=a.length,I=v,R=!h;if(e==null)return!I;for(e=ut(e);v--;){var U=a[v];if(R&&U[2]?U[1]!==e[U[0]]:!(U[0]in e))return!1}for(;++v<I;){U=a[v];var G=U[0],se=e[G],ae=U[1];if(R&&U[2]){if(se===r&&!(G in e))return!1}else{var ce=new zr;if(h)var fe=h(se,ae,G,e,i,ce);if(!(fe===r?kn(ae,se,H|Z,h,ce):fe))return!1}}return!0}function eh(e){if(!bt(e)||P0(e))return!1;var i=li(e)?Bp:Qa;return i.test(Gi(e))}function Vg(e){return At(e)&&ir(e)==Me}function Gg(e){return At(e)&&Zt(e)==Pe}function kg(e){return At(e)&&ba(e.length)&&!!at[ir(e)]}function th(e){return typeof e=="function"?e:e==null?gr:typeof e=="object"?Ne(e)?nh(e[0],e[1]):ih(e):Sl(e)}function Uo(e){if(!Jn(e))return Jp(e);var i=[];for(var a in ut(e))nt.call(e,a)&&a!="constructor"&&i.push(a);return i}function Wg(e){if(!bt(e))return C0(e);var i=Jn(e),a=[];for(var h in e)h=="constructor"&&(i||!nt.call(e,h))||a.push(h);return a}function Lo(e,i){return e<i}function rh(e,i){var a=-1,h=dr(e)?ee(e.length):[];return Ii(e,function(v,I,R){h[++a]=i(v,I,R)}),h}function ih(e){var i=Zo(e);return i.length==1&&i[0][2]?Lh(i[0][0],i[0][1]):function(a){return a===e||Fo(a,e,i)}}function nh(e,i){return ec(e)&&Uh(i)?Lh(Xr(e),i):function(a){var h=hc(a,e);return h===r&&h===i?lc(a,e):kn(i,h,H|Z)}}function na(e,i,a,h,v){e!==i&&Ro(i,function(I,R){if(v||(v=new zr),bt(I))Yg(e,i,R,a,na,h,v);else{var U=h?h(rc(e,R),I,R+"",e,i,v):r;U===r&&(U=I),To(e,R,U)}},pr)}function Yg(e,i,a,h,v,I,R){var U=rc(e,a),G=rc(i,a),se=R.get(G);if(se){To(e,a,se);return}var ae=I?I(U,G,a+"",e,i,R):r,ce=ae===r;if(ce){var fe=Ne(G),ve=!fe&&Ai(G),Ee=!fe&&!ve&&Sn(G);ae=G,fe||ve||Ee?Ne(U)?ae=U:Nt(U)?ae=fr(U):ve?(ce=!1,ae=_h(G,!0)):Ee?(ce=!1,ae=yh(G,!0)):ae=[]:Zn(G)||ki(G)?(ae=U,ki(U)?ae=dl(U):(!bt(U)||li(U))&&(ae=Fh(G))):ce=!1}ce&&(R.set(G,ae),v(ae,G,h,I,R),R.delete(G)),To(e,a,ae)}function sh(e,i){var a=e.length;if(a)return i+=i<0?a:0,hi(i,a)?e[i]:r}function ah(e,i,a){i.length?i=vt(i,function(I){return Ne(I)?function(R){return Bi(R,I.length===1?I[0]:I)}:I}):i=[gr];var h=-1;i=vt(i,mr(we()));var v=rh(e,function(I,R,U){var G=vt(i,function(se){return se(I)});return{criteria:G,index:++h,value:I}});return Ep(v,function(I,R){return c0(I,R,a)})}function Jg(e,i){return oh(e,i,function(a,h){return lc(e,h)})}function oh(e,i,a){for(var h=-1,v=i.length,I={};++h<v;){var R=i[h],U=Bi(e,R);a(U,R)&&Wn(I,Pi(R,e),U)}return I}function Xg(e){return function(i){return Bi(i,e)}}function $o(e,i,a,h){var v=h?wp:fn,I=-1,R=i.length,U=e;for(e===i&&(i=fr(i)),a&&(U=vt(e,mr(a)));++I<R;)for(var G=0,se=i[I],ae=a?a(se):se;(G=v(U,ae,G,h))>-1;)U!==e&&Ws.call(U,G,1),Ws.call(e,G,1);return e}function ch(e,i){for(var a=e?i.length:0,h=a-1;a--;){var v=i[a];if(a==h||v!==I){var I=v;hi(v)?Ws.call(e,v,1):Ho(e,v)}}return e}function Mo(e,i){return e+Xs(Hu()*(i-e+1))}function Zg(e,i,a,h){for(var v=-1,I=Vt(Js((i-e)/(a||1)),0),R=ee(I);I--;)R[h?I:++v]=e,e+=a;return R}function qo(e,i){var a="";if(!e||i<1||i>W)return a;do i%2&&(a+=e),i=Xs(i/2),i&&(e+=e);while(i);return a}function Be(e,i){return ic($h(e,i,gr),e+"")}function Qg(e){return Vu(In(e))}function e0(e,i){var a=In(e);return pa(a,Ki(i,0,a.length))}function Wn(e,i,a,h){if(!bt(e))return e;i=Pi(i,e);for(var v=-1,I=i.length,R=I-1,U=e;U!=null&&++v<I;){var G=Xr(i[v]),se=a;if(G==="__proto__"||G==="constructor"||G==="prototype")return e;if(v!=R){var ae=U[G];se=h?h(ae,G,U):r,se===r&&(se=bt(ae)?ae:hi(i[v+1])?[]:{})}Bn(U,G,se),U=U[G]}return e}var uh=Zs?function(e,i){return Zs.set(e,i),e}:gr,t0=Ys?function(e,i){return Ys(e,"toString",{configurable:!0,enumerable:!1,value:dc(i),writable:!0})}:gr;function r0(e){return pa(In(e))}function Rr(e,i,a){var h=-1,v=e.length;i<0&&(i=-i>v?0:v+i),a=a>v?v:a,a<0&&(a+=v),v=i>a?0:a-i>>>0,i>>>=0;for(var I=ee(v);++h<v;)I[h]=e[h+i];return I}function i0(e,i){var a;return Ii(e,function(h,v,I){return a=i(h,v,I),!a}),!!a}function sa(e,i,a){var h=0,v=e==null?h:e.length;if(typeof i=="number"&&i===i&&v<=ie){for(;h<v;){var I=h+v>>>1,R=e[I];R!==null&&!wr(R)&&(a?R<=i:R<i)?h=I+1:v=I}return v}return zo(e,i,gr,a)}function zo(e,i,a,h){var v=0,I=e==null?0:e.length;if(I===0)return 0;i=a(i);for(var R=i!==i,U=i===null,G=wr(i),se=i===r;v<I;){var ae=Xs((v+I)/2),ce=a(e[ae]),fe=ce!==r,ve=ce===null,Ee=ce===ce,ze=wr(ce);if(R)var Se=h||Ee;else se?Se=Ee&&(h||fe):U?Se=Ee&&fe&&(h||!ve):G?Se=Ee&&fe&&!ve&&(h||!ze):ve||ze?Se=!1:Se=h?ce<=i:ce<i;Se?v=ae+1:I=ae}return Xt(I,re)}function hh(e,i){for(var a=-1,h=e.length,v=0,I=[];++a<h;){var R=e[a],U=i?i(R):R;if(!a||!Hr(U,G)){var G=U;I[v++]=R===0?0:R}}return I}function lh(e){return typeof e=="number"?e:wr(e)?q:+e}function br(e){if(typeof e=="string")return e;if(Ne(e))return vt(e,br)+"";if(wr(e))return Ku?Ku.call(e):"";var i=e+"";return i=="0"&&1/e==-F?"-0":i}function Oi(e,i,a){var h=-1,v=$s,I=e.length,R=!0,U=[],G=U;if(a)R=!1,v=_o;else if(I>=o){var se=i?null:p0(e);if(se)return qs(se);R=!1,v=$n,G=new Hi}else G=i?[]:U;e:for(;++h<I;){var ae=e[h],ce=i?i(ae):ae;if(ae=a||ae!==0?ae:0,R&&ce===ce){for(var fe=G.length;fe--;)if(G[fe]===ce)continue e;i&&G.push(ce),U.push(ae)}else v(G,ce,a)||(G!==U&&G.push(ce),U.push(ae))}return U}function Ho(e,i){return i=Pi(i,e),e=Mh(e,i),e==null||delete e[Xr(Nr(i))]}function fh(e,i,a,h){return Wn(e,i,a(Bi(e,i)),h)}function aa(e,i,a,h){for(var v=e.length,I=h?v:-1;(h?I--:++I<v)&&i(e[I],I,e););return a?Rr(e,h?0:I,h?I+1:v):Rr(e,h?I+1:0,h?v:I)}function dh(e,i){var a=e;return a instanceof Ye&&(a=a.value()),yo(i,function(h,v){return v.func.apply(v.thisArg,wi([h],v.args))},a)}function Ko(e,i,a){var h=e.length;if(h<2)return h?Oi(e[0]):[];for(var v=-1,I=ee(h);++v<h;)for(var R=e[v],U=-1;++U<h;)U!=v&&(I[v]=Vn(I[v]||R,e[U],i,a));return Oi(Yt(I,1),i,a)}function ph(e,i,a){for(var h=-1,v=e.length,I=i.length,R={};++h<v;){var U=h<I?i[h]:r;a(R,e[h],U)}return R}function Bo(e){return Nt(e)?e:[]}function Vo(e){return typeof e=="function"?e:gr}function Pi(e,i){return Ne(e)?e:ec(e,i)?[e]:Kh(it(e))}var n0=Be;function xi(e,i,a){var h=e.length;return a=a===r?h:a,!i&&a>=h?e:Rr(e,i,a)}var gh=Vp||function(e){return Xe.clearTimeout(e)};function _h(e,i){if(i)return e.slice();var a=e.length,h=Lu?Lu(a):new e.constructor(a);return e.copy(h),h}function Go(e){var i=new e.constructor(e.byteLength);return new Gs(i).set(new Gs(e)),i}function s0(e,i){var a=i?Go(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function a0(e){var i=new e.constructor(e.source,Or.exec(e));return i.lastIndex=e.lastIndex,i}function o0(e){return Kn?ut(Kn.call(e)):{}}function yh(e,i){var a=i?Go(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function vh(e,i){if(e!==i){var a=e!==r,h=e===null,v=e===e,I=wr(e),R=i!==r,U=i===null,G=i===i,se=wr(i);if(!U&&!se&&!I&&e>i||I&&R&&G&&!U&&!se||h&&R&&G||!a&&G||!v)return 1;if(!h&&!I&&!se&&e<i||se&&a&&v&&!h&&!I||U&&a&&v||!R&&v||!G)return-1}return 0}function c0(e,i,a){for(var h=-1,v=e.criteria,I=i.criteria,R=v.length,U=a.length;++h<R;){var G=vh(v[h],I[h]);if(G){if(h>=U)return G;var se=a[h];return G*(se=="desc"?-1:1)}}return e.index-i.index}function mh(e,i,a,h){for(var v=-1,I=e.length,R=a.length,U=-1,G=i.length,se=Vt(I-R,0),ae=ee(G+se),ce=!h;++U<G;)ae[U]=i[U];for(;++v<R;)(ce||v<I)&&(ae[a[v]]=e[v]);for(;se--;)ae[U++]=e[v++];return ae}function bh(e,i,a,h){for(var v=-1,I=e.length,R=-1,U=a.length,G=-1,se=i.length,ae=Vt(I-U,0),ce=ee(ae+se),fe=!h;++v<ae;)ce[v]=e[v];for(var ve=v;++G<se;)ce[ve+G]=i[G];for(;++R<U;)(fe||v<I)&&(ce[ve+a[R]]=e[v++]);return ce}function fr(e,i){var a=-1,h=e.length;for(i||(i=ee(h));++a<h;)i[a]=e[a];return i}function Jr(e,i,a,h){var v=!a;a||(a={});for(var I=-1,R=i.length;++I<R;){var U=i[I],G=h?h(a[U],e[U],U,a,e):r;G===r&&(G=e[U]),v?oi(a,U,G):Bn(a,U,G)}return a}function u0(e,i){return Jr(e,Qo(e),i)}function h0(e,i){return Jr(e,jh(e),i)}function oa(e,i){return function(a,h){var v=Ne(a)?gp:Ng,I=i?i():{};return v(a,e,we(h,2),I)}}function bn(e){return Be(function(i,a){var h=-1,v=a.length,I=v>1?a[v-1]:r,R=v>2?a[2]:r;for(I=e.length>3&&typeof I=="function"?(v--,I):r,R&&nr(a[0],a[1],R)&&(I=v<3?r:I,v=1),i=ut(i);++h<v;){var U=a[h];U&&e(i,U,h,I)}return i})}function wh(e,i){return function(a,h){if(a==null)return a;if(!dr(a))return e(a,h);for(var v=a.length,I=i?v:-1,R=ut(a);(i?I--:++I<v)&&h(R[I],I,R)!==!1;);return a}}function Eh(e){return function(i,a,h){for(var v=-1,I=ut(i),R=h(i),U=R.length;U--;){var G=R[e?U:++v];if(a(I[G],G,I)===!1)break}return i}}function l0(e,i,a){var h=i&Q,v=Yn(e);function I(){var R=this&&this!==Xe&&this instanceof I?v:e;return R.apply(h?a:this,arguments)}return I}function Sh(e){return function(i){i=it(i);var a=dn(i)?qr(i):r,h=a?a[0]:i.charAt(0),v=a?xi(a,1).join(""):i.slice(1);return h[e]()+v}}function wn(e){return function(i){return yo(wl(bl(i).replace(Un,"")),e,"")}}function Yn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=mn(e.prototype),h=e.apply(a,i);return bt(h)?h:a}}function f0(e,i,a){var h=Yn(e);function v(){for(var I=arguments.length,R=ee(I),U=I,G=En(v);U--;)R[U]=arguments[U];var se=I<3&&R[0]!==G&&R[I-1]!==G?[]:Ei(R,G);if(I-=se.length,I<a)return Ah(e,i,ca,v.placeholder,r,R,se,r,r,a-I);var ae=this&&this!==Xe&&this instanceof v?h:e;return Gt(ae,this,R)}return v}function Ih(e){return function(i,a,h){var v=ut(i);if(!dr(i)){var I=we(a,3);i=kt(i),a=function(U){return I(v[U],U,v)}}var R=e(i,a,h);return R>-1?v[I?i[R]:R]:r}}function Oh(e){return ui(function(i){var a=i.length,h=a,v=Tr.prototype.thru;for(e&&i.reverse();h--;){var I=i[h];if(typeof I!="function")throw new Ar(b);if(v&&!R&&fa(I)=="wrapper")var R=new Tr([],!0)}for(h=R?h:a;++h<a;){I=i[h];var U=fa(I),G=U=="wrapper"?Xo(I):r;G&&tc(G[0])&&G[1]==(u|K|j|y)&&!G[4].length&&G[9]==1?R=R[fa(G[0])].apply(R,G[3]):R=I.length==1&&tc(I)?R[U]():R.thru(I)}return function(){var se=arguments,ae=se[0];if(R&&se.length==1&&Ne(ae))return R.plant(ae).value();for(var ce=0,fe=a?i[ce].apply(this,se):ae;++ce<a;)fe=i[ce].call(this,fe);return fe}})}function ca(e,i,a,h,v,I,R,U,G,se){var ae=i&u,ce=i&Q,fe=i&ue,ve=i&(K|N),Ee=i&X,ze=fe?r:Yn(e);function Se(){for(var ke=arguments.length,Ze=ee(ke),Er=ke;Er--;)Ze[Er]=arguments[Er];if(ve)var sr=En(Se),Sr=Ip(Ze,sr);if(h&&(Ze=mh(Ze,h,v,ve)),I&&(Ze=bh(Ze,I,R,ve)),ke-=Sr,ve&&ke<se){var jt=Ei(Ze,sr);return Ah(e,i,ca,Se.placeholder,a,Ze,jt,U,G,se-ke)}var Kr=ce?a:this,di=fe?Kr[e]:e;return ke=Ze.length,U?Ze=N0(Ze,U):Ee&&ke>1&&Ze.reverse(),ae&&G<ke&&(Ze.length=G),this&&this!==Xe&&this instanceof Se&&(di=ze||Yn(di)),di.apply(Kr,Ze)}return Se}function Ph(e,i){return function(a,h){return qg(a,e,i(h),{})}}function ua(e,i){return function(a,h){var v;if(a===r&&h===r)return i;if(a!==r&&(v=a),h!==r){if(v===r)return h;typeof a=="string"||typeof h=="string"?(a=br(a),h=br(h)):(a=lh(a),h=lh(h)),v=e(a,h)}return v}}function ko(e){return ui(function(i){return i=vt(i,mr(we())),Be(function(a){var h=this;return e(i,function(v){return Gt(v,h,a)})})})}function ha(e,i){i=i===r?" ":br(i);var a=i.length;if(a<2)return a?qo(i,e):i;var h=qo(i,Js(e/pn(i)));return dn(i)?xi(qr(h),0,e).join(""):h.slice(0,e)}function d0(e,i,a,h){var v=i&Q,I=Yn(e);function R(){for(var U=-1,G=arguments.length,se=-1,ae=h.length,ce=ee(ae+G),fe=this&&this!==Xe&&this instanceof R?I:e;++se<ae;)ce[se]=h[se];for(;G--;)ce[se++]=arguments[++U];return Gt(fe,v?a:this,ce)}return R}function xh(e){return function(i,a,h){return h&&typeof h!="number"&&nr(i,a,h)&&(a=h=r),i=fi(i),a===r?(a=i,i=0):a=fi(a),h=h===r?i<a?1:-1:fi(h),Zg(i,a,h,e)}}function la(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=jr(i),a=jr(a)),e(i,a)}}function Ah(e,i,a,h,v,I,R,U,G,se){var ae=i&K,ce=ae?R:r,fe=ae?r:R,ve=ae?I:r,Ee=ae?r:I;i|=ae?j:O,i&=~(ae?O:j),i&L||(i&=~(Q|ue));var ze=[e,i,v,ve,ce,Ee,fe,U,G,se],Se=a.apply(r,ze);return tc(e)&&qh(Se,ze),Se.placeholder=h,zh(Se,e,i)}function Wo(e){var i=Bt[e];return function(a,h){if(a=jr(a),h=h==null?0:Xt($e(h),292),h&&zu(a)){var v=(it(a)+"e").split("e"),I=i(v[0]+"e"+(+v[1]+h));return v=(it(I)+"e").split("e"),+(v[0]+"e"+(+v[1]-h))}return i(a)}}var p0=yn&&1/qs(new yn([,-0]))[1]==F?function(e){return new yn(e)}:_c;function Th(e){return function(i){var a=Zt(i);return a==Oe?Io(i):a==Pe?Rp(i):Sp(i,e(i))}}function ci(e,i,a,h,v,I,R,U){var G=i&ue;if(!G&&typeof e!="function")throw new Ar(b);var se=h?h.length:0;if(se||(i&=~(j|O),h=v=r),R=R===r?R:Vt($e(R),0),U=U===r?U:$e(U),se-=v?v.length:0,i&O){var ae=h,ce=v;h=v=r}var fe=G?r:Xo(e),ve=[e,i,a,h,v,ae,ce,I,R,U];if(fe&&T0(ve,fe),e=ve[0],i=ve[1],a=ve[2],h=ve[3],v=ve[4],U=ve[9]=ve[9]===r?G?0:e.length:Vt(ve[9]-se,0),!U&&i&(K|N)&&(i&=~(K|N)),!i||i==Q)var Ee=l0(e,i,a);else i==K||i==N?Ee=f0(e,i,U):(i==j||i==(Q|j))&&!v.length?Ee=d0(e,i,a,h):Ee=ca.apply(r,ve);var ze=fe?uh:qh;return zh(ze(Ee,ve),e,i)}function Ch(e,i,a,h){return e===r||Hr(e,_n[a])&&!nt.call(h,a)?i:e}function Rh(e,i,a,h,v,I){return bt(e)&&bt(i)&&(I.set(i,e),na(e,i,r,Rh,I),I.delete(i)),e}function g0(e){return Zn(e)?r:e}function Nh(e,i,a,h,v,I){var R=a&H,U=e.length,G=i.length;if(U!=G&&!(R&&G>U))return!1;var se=I.get(e),ae=I.get(i);if(se&&ae)return se==i&&ae==e;var ce=-1,fe=!0,ve=a&Z?new Hi:r;for(I.set(e,i),I.set(i,e);++ce<U;){var Ee=e[ce],ze=i[ce];if(h)var Se=R?h(ze,Ee,ce,i,e,I):h(Ee,ze,ce,e,i,I);if(Se!==r){if(Se)continue;fe=!1;break}if(ve){if(!vo(i,function(ke,Ze){if(!$n(ve,Ze)&&(Ee===ke||v(Ee,ke,a,h,I)))return ve.push(Ze)})){fe=!1;break}}else if(!(Ee===ze||v(Ee,ze,a,h,I))){fe=!1;break}}return I.delete(e),I.delete(i),fe}function _0(e,i,a,h,v,I,R){switch(a){case Te:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ie:return!(e.byteLength!=i.byteLength||!I(new Gs(e),new Gs(i)));case Y:case z:case He:return Hr(+e,+i);case D:return e.name==i.name&&e.message==i.message;case Me:case je:return e==i+"";case Oe:var U=Io;case Pe:var G=h&H;if(U||(U=qs),e.size!=i.size&&!G)return!1;var se=R.get(e);if(se)return se==i;h|=Z,R.set(e,i);var ae=Nh(U(e),U(i),h,v,I,R);return R.delete(e),ae;case De:if(Kn)return Kn.call(e)==Kn.call(i)}return!1}function y0(e,i,a,h,v,I){var R=a&H,U=Yo(e),G=U.length,se=Yo(i),ae=se.length;if(G!=ae&&!R)return!1;for(var ce=G;ce--;){var fe=U[ce];if(!(R?fe in i:nt.call(i,fe)))return!1}var ve=I.get(e),Ee=I.get(i);if(ve&&Ee)return ve==i&&Ee==e;var ze=!0;I.set(e,i),I.set(i,e);for(var Se=R;++ce<G;){fe=U[ce];var ke=e[fe],Ze=i[fe];if(h)var Er=R?h(Ze,ke,fe,i,e,I):h(ke,Ze,fe,e,i,I);if(!(Er===r?ke===Ze||v(ke,Ze,a,h,I):Er)){ze=!1;break}Se||(Se=fe=="constructor")}if(ze&&!Se){var sr=e.constructor,Sr=i.constructor;sr!=Sr&&"constructor"in e&&"constructor"in i&&!(typeof sr=="function"&&sr instanceof sr&&typeof Sr=="function"&&Sr instanceof Sr)&&(ze=!1)}return I.delete(e),I.delete(i),ze}function ui(e){return ic($h(e,r,kh),e+"")}function Yo(e){return Zu(e,kt,Qo)}function Jo(e){return Zu(e,pr,jh)}var Xo=Zs?function(e){return Zs.get(e)}:_c;function fa(e){for(var i=e.name+"",a=vn[i],h=nt.call(vn,i)?a.length:0;h--;){var v=a[h],I=v.func;if(I==null||I==e)return v.name}return i}function En(e){var i=nt.call(S,"placeholder")?S:e;return i.placeholder}function we(){var e=S.iteratee||pc;return e=e===pc?th:e,arguments.length?e(arguments[0],arguments[1]):e}function da(e,i){var a=e.__data__;return O0(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Zo(e){for(var i=kt(e),a=i.length;a--;){var h=i[a],v=e[h];i[a]=[h,v,Uh(v)]}return i}function Vi(e,i){var a=Ap(e,i);return eh(a)?a:r}function v0(e){var i=nt.call(e,qi),a=e[qi];try{e[qi]=r;var h=!0}catch{}var v=Bs.call(e);return h&&(i?e[qi]=a:delete e[qi]),v}var Qo=Po?function(e){return e==null?[]:(e=ut(e),bi(Po(e),function(i){return Mu.call(e,i)}))}:yc,jh=Po?function(e){for(var i=[];e;)wi(i,Qo(e)),e=ks(e);return i}:yc,Zt=ir;(xo&&Zt(new xo(new ArrayBuffer(1)))!=Te||qn&&Zt(new qn)!=Oe||Ao&&Zt(Ao.resolve())!=pt||yn&&Zt(new yn)!=Pe||zn&&Zt(new zn)!=Ae)&&(Zt=function(e){var i=ir(e),a=i==Le?e.constructor:r,h=a?Gi(a):"";if(h)switch(h){case eg:return Te;case tg:return Oe;case rg:return pt;case ig:return Pe;case ng:return Ae}return i});function m0(e,i,a){for(var h=-1,v=a.length;++h<v;){var I=a[h],R=I.size;switch(I.type){case"drop":e+=R;break;case"dropRight":i-=R;break;case"take":i=Xt(i,e+R);break;case"takeRight":e=Vt(e,i-R);break}}return{start:e,end:i}}function b0(e){var i=e.match(ht);return i?i[1].split(Mt):[]}function Dh(e,i,a){i=Pi(i,e);for(var h=-1,v=i.length,I=!1;++h<v;){var R=Xr(i[h]);if(!(I=e!=null&&a(e,R)))break;e=e[R]}return I||++h!=v?I:(v=e==null?0:e.length,!!v&&ba(v)&&hi(R,v)&&(Ne(e)||ki(e)))}function w0(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function Fh(e){return typeof e.constructor=="function"&&!Jn(e)?mn(ks(e)):{}}function E0(e,i,a){var h=e.constructor;switch(i){case Ie:return Go(e);case Y:case z:return new h(+e);case Te:return s0(e,a);case Ke:case xe:case Ge:case We:case et:case tt:case Je:case er:case hr:return yh(e,a);case Oe:return new h;case He:case je:return new h(e);case Me:return a0(e);case Pe:return new h;case De:return o0(e)}}function S0(e,i){var a=i.length;if(!a)return e;var h=a-1;return i[h]=(a>1?"& ":"")+i[h],i=i.join(a>2?", ":" "),e.replace(xt,`{
/* [wrapped with `+i+`] */
`)}function I0(e){return Ne(e)||ki(e)||!!(qu&&e&&e[qu])}function hi(e,i){var a=typeof e;return i=i??W,!!i&&(a=="number"||a!="symbol"&&to.test(e))&&e>-1&&e%1==0&&e<i}function nr(e,i,a){if(!bt(a))return!1;var h=typeof i;return(h=="number"?dr(a)&&hi(i,a.length):h=="string"&&i in a)?Hr(a[i],e):!1}function ec(e,i){if(Ne(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||wr(e)?!0:Ut.test(e)||!yt.test(e)||i!=null&&e in ut(i)}function O0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function tc(e){var i=fa(e),a=S[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(e===a)return!0;var h=Xo(a);return!!h&&e===h[0]}function P0(e){return!!Uu&&Uu in e}var x0=Hs?li:vc;function Jn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||_n;return e===a}function Uh(e){return e===e&&!bt(e)}function Lh(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in ut(a))}}function A0(e){var i=va(e,function(h){return a.size===A&&a.clear(),h}),a=i.cache;return i}function T0(e,i){var a=e[1],h=i[1],v=a|h,I=v<(Q|ue|u),R=h==u&&a==K||h==u&&a==y&&e[7].length<=i[8]||h==(u|y)&&i[7].length<=i[8]&&a==K;if(!(I||R))return e;h&Q&&(e[2]=i[2],v|=a&Q?0:L);var U=i[3];if(U){var G=e[3];e[3]=G?mh(G,U,i[4]):U,e[4]=G?Ei(e[3],C):i[4]}return U=i[5],U&&(G=e[5],e[5]=G?bh(G,U,i[6]):U,e[6]=G?Ei(e[5],C):i[6]),U=i[7],U&&(e[7]=U),h&u&&(e[8]=e[8]==null?i[8]:Xt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=v,e}function C0(e){var i=[];if(e!=null)for(var a in ut(e))i.push(a);return i}function R0(e){return Bs.call(e)}function $h(e,i,a){return i=Vt(i===r?e.length-1:i,0),function(){for(var h=arguments,v=-1,I=Vt(h.length-i,0),R=ee(I);++v<I;)R[v]=h[i+v];v=-1;for(var U=ee(i+1);++v<i;)U[v]=h[v];return U[i]=a(R),Gt(e,this,U)}}function Mh(e,i){return i.length<2?e:Bi(e,Rr(i,0,-1))}function N0(e,i){for(var a=e.length,h=Xt(i.length,a),v=fr(e);h--;){var I=i[h];e[h]=hi(I,a)?v[I]:r}return e}function rc(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var qh=Hh(uh),Xn=kp||function(e,i){return Xe.setTimeout(e,i)},ic=Hh(t0);function zh(e,i,a){var h=i+"";return ic(e,S0(h,j0(b0(h),a)))}function Hh(e){var i=0,a=0;return function(){var h=Xp(),v=w-(h-a);if(a=h,v>0){if(++i>=d)return arguments[0]}else i=0;return e.apply(r,arguments)}}function pa(e,i){var a=-1,h=e.length,v=h-1;for(i=i===r?h:i;++a<i;){var I=Mo(a,v),R=e[I];e[I]=e[a],e[a]=R}return e.length=i,e}var Kh=A0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Lt,function(a,h,v,I){i.push(v?I.replace(Ya,"$1"):h||a)}),i});function Xr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-F?"-0":i}function Gi(e){if(e!=null){try{return Ks.call(e)}catch{}try{return e+""}catch{}}return""}function j0(e,i){return xr(ge,function(a){var h="_."+a[0];i&a[1]&&!$s(e,h)&&e.push(h)}),e.sort()}function Bh(e){if(e instanceof Ye)return e.clone();var i=new Tr(e.__wrapped__,e.__chain__);return i.__actions__=fr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function D0(e,i,a){(a?nr(e,i,a):i===r)?i=1:i=Vt($e(i),0);var h=e==null?0:e.length;if(!h||i<1)return[];for(var v=0,I=0,R=ee(Js(h/i));v<h;)R[I++]=Rr(e,v,v+=i);return R}function F0(e){for(var i=-1,a=e==null?0:e.length,h=0,v=[];++i<a;){var I=e[i];I&&(v[h++]=I)}return v}function U0(){var e=arguments.length;if(!e)return[];for(var i=ee(e-1),a=arguments[0],h=e;h--;)i[h-1]=arguments[h];return wi(Ne(a)?fr(a):[a],Yt(i,1))}var L0=Be(function(e,i){return Nt(e)?Vn(e,Yt(i,1,Nt,!0)):[]}),$0=Be(function(e,i){var a=Nr(i);return Nt(a)&&(a=r),Nt(e)?Vn(e,Yt(i,1,Nt,!0),we(a,2)):[]}),M0=Be(function(e,i){var a=Nr(i);return Nt(a)&&(a=r),Nt(e)?Vn(e,Yt(i,1,Nt,!0),r,a):[]});function q0(e,i,a){var h=e==null?0:e.length;return h?(i=a||i===r?1:$e(i),Rr(e,i<0?0:i,h)):[]}function z0(e,i,a){var h=e==null?0:e.length;return h?(i=a||i===r?1:$e(i),i=h-i,Rr(e,0,i<0?0:i)):[]}function H0(e,i){return e&&e.length?aa(e,we(i,3),!0,!0):[]}function K0(e,i){return e&&e.length?aa(e,we(i,3),!0):[]}function B0(e,i,a,h){var v=e==null?0:e.length;return v?(a&&typeof a!="number"&&nr(e,i,a)&&(a=0,h=v),Ug(e,i,a,h)):[]}function Vh(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=a==null?0:$e(a);return v<0&&(v=Vt(h+v,0)),Ms(e,we(i,3),v)}function Gh(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=h-1;return a!==r&&(v=$e(a),v=a<0?Vt(h+v,0):Xt(v,h-1)),Ms(e,we(i,3),v,!0)}function kh(e){var i=e==null?0:e.length;return i?Yt(e,1):[]}function V0(e){var i=e==null?0:e.length;return i?Yt(e,F):[]}function G0(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:$e(i),Yt(e,i)):[]}function k0(e){for(var i=-1,a=e==null?0:e.length,h={};++i<a;){var v=e[i];h[v[0]]=v[1]}return h}function Wh(e){return e&&e.length?e[0]:r}function W0(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=a==null?0:$e(a);return v<0&&(v=Vt(h+v,0)),fn(e,i,v)}function Y0(e){var i=e==null?0:e.length;return i?Rr(e,0,-1):[]}var J0=Be(function(e){var i=vt(e,Bo);return i.length&&i[0]===e[0]?Do(i):[]}),X0=Be(function(e){var i=Nr(e),a=vt(e,Bo);return i===Nr(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Do(a,we(i,2)):[]}),Z0=Be(function(e){var i=Nr(e),a=vt(e,Bo);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Do(a,r,i):[]});function Q0(e,i){return e==null?"":Yp.call(e,i)}function Nr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function e_(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=h;return a!==r&&(v=$e(a),v=v<0?Vt(h+v,0):Xt(v,h-1)),i===i?jp(e,i,v):Ms(e,Au,v,!0)}function t_(e,i){return e&&e.length?sh(e,$e(i)):r}var r_=Be(Yh);function Yh(e,i){return e&&e.length&&i&&i.length?$o(e,i):e}function i_(e,i,a){return e&&e.length&&i&&i.length?$o(e,i,we(a,2)):e}function n_(e,i,a){return e&&e.length&&i&&i.length?$o(e,i,r,a):e}var s_=ui(function(e,i){var a=e==null?0:e.length,h=Co(e,i);return ch(e,vt(i,function(v){return hi(v,a)?+v:v}).sort(vh)),h});function a_(e,i){var a=[];if(!(e&&e.length))return a;var h=-1,v=[],I=e.length;for(i=we(i,3);++h<I;){var R=e[h];i(R,h,e)&&(a.push(R),v.push(h))}return ch(e,v),a}function nc(e){return e==null?e:Qp.call(e)}function o_(e,i,a){var h=e==null?0:e.length;return h?(a&&typeof a!="number"&&nr(e,i,a)?(i=0,a=h):(i=i==null?0:$e(i),a=a===r?h:$e(a)),Rr(e,i,a)):[]}function c_(e,i){return sa(e,i)}function u_(e,i,a){return zo(e,i,we(a,2))}function h_(e,i){var a=e==null?0:e.length;if(a){var h=sa(e,i);if(h<a&&Hr(e[h],i))return h}return-1}function l_(e,i){return sa(e,i,!0)}function f_(e,i,a){return zo(e,i,we(a,2),!0)}function d_(e,i){var a=e==null?0:e.length;if(a){var h=sa(e,i,!0)-1;if(Hr(e[h],i))return h}return-1}function p_(e){return e&&e.length?hh(e):[]}function g_(e,i){return e&&e.length?hh(e,we(i,2)):[]}function __(e){var i=e==null?0:e.length;return i?Rr(e,1,i):[]}function y_(e,i,a){return e&&e.length?(i=a||i===r?1:$e(i),Rr(e,0,i<0?0:i)):[]}function v_(e,i,a){var h=e==null?0:e.length;return h?(i=a||i===r?1:$e(i),i=h-i,Rr(e,i<0?0:i,h)):[]}function m_(e,i){return e&&e.length?aa(e,we(i,3),!1,!0):[]}function b_(e,i){return e&&e.length?aa(e,we(i,3)):[]}var w_=Be(function(e){return Oi(Yt(e,1,Nt,!0))}),E_=Be(function(e){var i=Nr(e);return Nt(i)&&(i=r),Oi(Yt(e,1,Nt,!0),we(i,2))}),S_=Be(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Oi(Yt(e,1,Nt,!0),r,i)});function I_(e){return e&&e.length?Oi(e):[]}function O_(e,i){return e&&e.length?Oi(e,we(i,2)):[]}function P_(e,i){return i=typeof i=="function"?i:r,e&&e.length?Oi(e,r,i):[]}function sc(e){if(!(e&&e.length))return[];var i=0;return e=bi(e,function(a){if(Nt(a))return i=Vt(a.length,i),!0}),Eo(i,function(a){return vt(e,mo(a))})}function Jh(e,i){if(!(e&&e.length))return[];var a=sc(e);return i==null?a:vt(a,function(h){return Gt(i,r,h)})}var x_=Be(function(e,i){return Nt(e)?Vn(e,i):[]}),A_=Be(function(e){return Ko(bi(e,Nt))}),T_=Be(function(e){var i=Nr(e);return Nt(i)&&(i=r),Ko(bi(e,Nt),we(i,2))}),C_=Be(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Ko(bi(e,Nt),r,i)}),R_=Be(sc);function N_(e,i){return ph(e||[],i||[],Bn)}function j_(e,i){return ph(e||[],i||[],Wn)}var D_=Be(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,Jh(e,a)});function Xh(e){var i=S(e);return i.__chain__=!0,i}function F_(e,i){return i(e),e}function ga(e,i){return i(e)}var U_=ui(function(e){var i=e.length,a=i?e[0]:0,h=this.__wrapped__,v=function(I){return Co(I,e)};return i>1||this.__actions__.length||!(h instanceof Ye)||!hi(a)?this.thru(v):(h=h.slice(a,+a+(i?1:0)),h.__actions__.push({func:ga,args:[v],thisArg:r}),new Tr(h,this.__chain__).thru(function(I){return i&&!I.length&&I.push(r),I}))});function L_(){return Xh(this)}function $_(){return new Tr(this.value(),this.__chain__)}function M_(){this.__values__===r&&(this.__values__=ll(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function q_(){return this}function z_(e){for(var i,a=this;a instanceof ea;){var h=Bh(a);h.__index__=0,h.__values__=r,i?v.__wrapped__=h:i=h;var v=h;a=a.__wrapped__}return v.__wrapped__=e,i}function H_(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:ga,args:[nc],thisArg:r}),new Tr(i,this.__chain__)}return this.thru(nc)}function K_(){return dh(this.__wrapped__,this.__actions__)}var B_=oa(function(e,i,a){nt.call(e,a)?++e[a]:oi(e,a,1)});function V_(e,i,a){var h=Ne(e)?Pu:Fg;return a&&nr(e,i,a)&&(i=r),h(e,we(i,3))}function G_(e,i){var a=Ne(e)?bi:Ju;return a(e,we(i,3))}var k_=Ih(Vh),W_=Ih(Gh);function Y_(e,i){return Yt(_a(e,i),1)}function J_(e,i){return Yt(_a(e,i),F)}function X_(e,i,a){return a=a===r?1:$e(a),Yt(_a(e,i),a)}function Zh(e,i){var a=Ne(e)?xr:Ii;return a(e,we(i,3))}function Qh(e,i){var a=Ne(e)?_p:Yu;return a(e,we(i,3))}var Z_=oa(function(e,i,a){nt.call(e,a)?e[a].push(i):oi(e,a,[i])});function Q_(e,i,a,h){e=dr(e)?e:In(e),a=a&&!h?$e(a):0;var v=e.length;return a<0&&(a=Vt(v+a,0)),wa(e)?a<=v&&e.indexOf(i,a)>-1:!!v&&fn(e,i,a)>-1}var ey=Be(function(e,i,a){var h=-1,v=typeof i=="function",I=dr(e)?ee(e.length):[];return Ii(e,function(R){I[++h]=v?Gt(i,R,a):Gn(R,i,a)}),I}),ty=oa(function(e,i,a){oi(e,a,i)});function _a(e,i){var a=Ne(e)?vt:rh;return a(e,we(i,3))}function ry(e,i,a,h){return e==null?[]:(Ne(i)||(i=i==null?[]:[i]),a=h?r:a,Ne(a)||(a=a==null?[]:[a]),ah(e,i,a))}var iy=oa(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function ny(e,i,a){var h=Ne(e)?yo:Cu,v=arguments.length<3;return h(e,we(i,4),a,v,Ii)}function sy(e,i,a){var h=Ne(e)?yp:Cu,v=arguments.length<3;return h(e,we(i,4),a,v,Yu)}function ay(e,i){var a=Ne(e)?bi:Ju;return a(e,ma(we(i,3)))}function oy(e){var i=Ne(e)?Vu:Qg;return i(e)}function cy(e,i,a){(a?nr(e,i,a):i===r)?i=1:i=$e(i);var h=Ne(e)?Cg:e0;return h(e,i)}function uy(e){var i=Ne(e)?Rg:r0;return i(e)}function hy(e){if(e==null)return 0;if(dr(e))return wa(e)?pn(e):e.length;var i=Zt(e);return i==Oe||i==Pe?e.size:Uo(e).length}function ly(e,i,a){var h=Ne(e)?vo:i0;return a&&nr(e,i,a)&&(i=r),h(e,we(i,3))}var fy=Be(function(e,i){if(e==null)return[];var a=i.length;return a>1&&nr(e,i[0],i[1])?i=[]:a>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),ah(e,Yt(i,1),[])}),ya=Gp||function(){return Xe.Date.now()};function dy(e,i){if(typeof i!="function")throw new Ar(b);return e=$e(e),function(){if(--e<1)return i.apply(this,arguments)}}function el(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,ci(e,u,r,r,r,r,i)}function tl(e,i){var a;if(typeof i!="function")throw new Ar(b);return e=$e(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var ac=Be(function(e,i,a){var h=Q;if(a.length){var v=Ei(a,En(ac));h|=j}return ci(e,h,i,a,v)}),rl=Be(function(e,i,a){var h=Q|ue;if(a.length){var v=Ei(a,En(rl));h|=j}return ci(i,h,e,a,v)});function il(e,i,a){i=a?r:i;var h=ci(e,K,r,r,r,r,r,i);return h.placeholder=il.placeholder,h}function nl(e,i,a){i=a?r:i;var h=ci(e,N,r,r,r,r,r,i);return h.placeholder=nl.placeholder,h}function sl(e,i,a){var h,v,I,R,U,G,se=0,ae=!1,ce=!1,fe=!0;if(typeof e!="function")throw new Ar(b);i=jr(i)||0,bt(a)&&(ae=!!a.leading,ce="maxWait"in a,I=ce?Vt(jr(a.maxWait)||0,i):I,fe="trailing"in a?!!a.trailing:fe);function ve(jt){var Kr=h,di=v;return h=v=r,se=jt,R=e.apply(di,Kr),R}function Ee(jt){return se=jt,U=Xn(ke,i),ae?ve(jt):R}function ze(jt){var Kr=jt-G,di=jt-se,Il=i-Kr;return ce?Xt(Il,I-di):Il}function Se(jt){var Kr=jt-G,di=jt-se;return G===r||Kr>=i||Kr<0||ce&&di>=I}function ke(){var jt=ya();if(Se(jt))return Ze(jt);U=Xn(ke,ze(jt))}function Ze(jt){return U=r,fe&&h?ve(jt):(h=v=r,R)}function Er(){U!==r&&gh(U),se=0,h=G=v=U=r}function sr(){return U===r?R:Ze(ya())}function Sr(){var jt=ya(),Kr=Se(jt);if(h=arguments,v=this,G=jt,Kr){if(U===r)return Ee(G);if(ce)return gh(U),U=Xn(ke,i),ve(G)}return U===r&&(U=Xn(ke,i)),R}return Sr.cancel=Er,Sr.flush=sr,Sr}var py=Be(function(e,i){return Wu(e,1,i)}),gy=Be(function(e,i,a){return Wu(e,jr(i)||0,a)});function _y(e){return ci(e,X)}function va(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Ar(b);var a=function(){var h=arguments,v=i?i.apply(this,h):h[0],I=a.cache;if(I.has(v))return I.get(v);var R=e.apply(this,h);return a.cache=I.set(v,R)||I,R};return a.cache=new(va.Cache||ai),a}va.Cache=ai;function ma(e){if(typeof e!="function")throw new Ar(b);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function yy(e){return tl(2,e)}var vy=n0(function(e,i){i=i.length==1&&Ne(i[0])?vt(i[0],mr(we())):vt(Yt(i,1),mr(we()));var a=i.length;return Be(function(h){for(var v=-1,I=Xt(h.length,a);++v<I;)h[v]=i[v].call(this,h[v]);return Gt(e,this,h)})}),oc=Be(function(e,i){var a=Ei(i,En(oc));return ci(e,j,r,i,a)}),al=Be(function(e,i){var a=Ei(i,En(al));return ci(e,O,r,i,a)}),my=ui(function(e,i){return ci(e,y,r,r,r,i)});function by(e,i){if(typeof e!="function")throw new Ar(b);return i=i===r?i:$e(i),Be(e,i)}function wy(e,i){if(typeof e!="function")throw new Ar(b);return i=i==null?0:Vt($e(i),0),Be(function(a){var h=a[i],v=xi(a,0,i);return h&&wi(v,h),Gt(e,this,v)})}function Ey(e,i,a){var h=!0,v=!0;if(typeof e!="function")throw new Ar(b);return bt(a)&&(h="leading"in a?!!a.leading:h,v="trailing"in a?!!a.trailing:v),sl(e,i,{leading:h,maxWait:i,trailing:v})}function Sy(e){return el(e,1)}function Iy(e,i){return oc(Vo(i),e)}function Oy(){if(!arguments.length)return[];var e=arguments[0];return Ne(e)?e:[e]}function Py(e){return Cr(e,M)}function xy(e,i){return i=typeof i=="function"?i:r,Cr(e,M,i)}function Ay(e){return Cr(e,$|M)}function Ty(e,i){return i=typeof i=="function"?i:r,Cr(e,$|M,i)}function Cy(e,i){return i==null||ku(e,i,kt(i))}function Hr(e,i){return e===i||e!==e&&i!==i}var Ry=la(jo),Ny=la(function(e,i){return e>=i}),ki=Qu(function(){return arguments}())?Qu:function(e){return At(e)&&nt.call(e,"callee")&&!Mu.call(e,"callee")},Ne=ee.isArray,jy=rr?mr(rr):zg;function dr(e){return e!=null&&ba(e.length)&&!li(e)}function Nt(e){return At(e)&&dr(e)}function Dy(e){return e===!0||e===!1||At(e)&&ir(e)==Y}var Ai=Wp||vc,Fy=Mr?mr(Mr):Hg;function Uy(e){return At(e)&&e.nodeType===1&&!Zn(e)}function Ly(e){if(e==null)return!0;if(dr(e)&&(Ne(e)||typeof e=="string"||typeof e.splice=="function"||Ai(e)||Sn(e)||ki(e)))return!e.length;var i=Zt(e);if(i==Oe||i==Pe)return!e.size;if(Jn(e))return!Uo(e).length;for(var a in e)if(nt.call(e,a))return!1;return!0}function $y(e,i){return kn(e,i)}function My(e,i,a){a=typeof a=="function"?a:r;var h=a?a(e,i):r;return h===r?kn(e,i,r,a):!!h}function cc(e){if(!At(e))return!1;var i=ir(e);return i==D||i==l||typeof e.message=="string"&&typeof e.name=="string"&&!Zn(e)}function qy(e){return typeof e=="number"&&zu(e)}function li(e){if(!bt(e))return!1;var i=ir(e);return i==he||i==pe||i==J||i==gt}function ol(e){return typeof e=="number"&&e==$e(e)}function ba(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=W}function bt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function At(e){return e!=null&&typeof e=="object"}var cl=Pr?mr(Pr):Bg;function zy(e,i){return e===i||Fo(e,i,Zo(i))}function Hy(e,i,a){return a=typeof a=="function"?a:r,Fo(e,i,Zo(i),a)}function Ky(e){return ul(e)&&e!=+e}function By(e){if(x0(e))throw new Ce(g);return eh(e)}function Vy(e){return e===null}function Gy(e){return e==null}function ul(e){return typeof e=="number"||At(e)&&ir(e)==He}function Zn(e){if(!At(e)||ir(e)!=Le)return!1;var i=ks(e);if(i===null)return!0;var a=nt.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Ks.call(a)==Hp}var uc=Wr?mr(Wr):Vg;function ky(e){return ol(e)&&e>=-W&&e<=W}var hl=Ln?mr(Ln):Gg;function wa(e){return typeof e=="string"||!Ne(e)&&At(e)&&ir(e)==je}function wr(e){return typeof e=="symbol"||At(e)&&ir(e)==De}var Sn=Mi?mr(Mi):kg;function Wy(e){return e===r}function Yy(e){return At(e)&&Zt(e)==Ae}function Jy(e){return At(e)&&ir(e)==Fe}var Xy=la(Lo),Zy=la(function(e,i){return e<=i});function ll(e){if(!e)return[];if(dr(e))return wa(e)?qr(e):fr(e);if(Mn&&e[Mn])return Cp(e[Mn]());var i=Zt(e),a=i==Oe?Io:i==Pe?qs:In;return a(e)}function fi(e){if(!e)return e===0?e:0;if(e=jr(e),e===F||e===-F){var i=e<0?-1:1;return i*P}return e===e?e:0}function $e(e){var i=fi(e),a=i%1;return i===i?a?i-a:i:0}function fl(e){return e?Ki($e(e),0,te):0}function jr(e){if(typeof e=="number")return e;if(wr(e))return q;if(bt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=bt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Ru(e);var a=Za.test(e);return a||eo.test(e)?Re(e.slice(2),a?2:8):Xa.test(e)?q:+e}function dl(e){return Jr(e,pr(e))}function Qy(e){return e?Ki($e(e),-W,W):e===0?e:0}function it(e){return e==null?"":br(e)}var ev=bn(function(e,i){if(Jn(i)||dr(i)){Jr(i,kt(i),e);return}for(var a in i)nt.call(i,a)&&Bn(e,a,i[a])}),pl=bn(function(e,i){Jr(i,pr(i),e)}),Ea=bn(function(e,i,a,h){Jr(i,pr(i),e,h)}),tv=bn(function(e,i,a,h){Jr(i,kt(i),e,h)}),rv=ui(Co);function iv(e,i){var a=mn(e);return i==null?a:Gu(a,i)}var nv=Be(function(e,i){e=ut(e);var a=-1,h=i.length,v=h>2?i[2]:r;for(v&&nr(i[0],i[1],v)&&(h=1);++a<h;)for(var I=i[a],R=pr(I),U=-1,G=R.length;++U<G;){var se=R[U],ae=e[se];(ae===r||Hr(ae,_n[se])&&!nt.call(e,se))&&(e[se]=I[se])}return e}),sv=Be(function(e){return e.push(r,Rh),Gt(gl,r,e)});function av(e,i){return xu(e,we(i,3),Yr)}function ov(e,i){return xu(e,we(i,3),No)}function cv(e,i){return e==null?e:Ro(e,we(i,3),pr)}function uv(e,i){return e==null?e:Xu(e,we(i,3),pr)}function hv(e,i){return e&&Yr(e,we(i,3))}function lv(e,i){return e&&No(e,we(i,3))}function fv(e){return e==null?[]:ia(e,kt(e))}function dv(e){return e==null?[]:ia(e,pr(e))}function hc(e,i,a){var h=e==null?r:Bi(e,i);return h===r?a:h}function pv(e,i){return e!=null&&Dh(e,i,Lg)}function lc(e,i){return e!=null&&Dh(e,i,$g)}var gv=Ph(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Bs.call(i)),e[i]=a},dc(gr)),_v=Ph(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Bs.call(i)),nt.call(e,i)?e[i].push(a):e[i]=[a]},we),yv=Be(Gn);function kt(e){return dr(e)?Bu(e):Uo(e)}function pr(e){return dr(e)?Bu(e,!0):Wg(e)}function vv(e,i){var a={};return i=we(i,3),Yr(e,function(h,v,I){oi(a,i(h,v,I),h)}),a}function mv(e,i){var a={};return i=we(i,3),Yr(e,function(h,v,I){oi(a,v,i(h,v,I))}),a}var bv=bn(function(e,i,a){na(e,i,a)}),gl=bn(function(e,i,a,h){na(e,i,a,h)}),wv=ui(function(e,i){var a={};if(e==null)return a;var h=!1;i=vt(i,function(I){return I=Pi(I,e),h||(h=I.length>1),I}),Jr(e,Jo(e),a),h&&(a=Cr(a,$|k|M,g0));for(var v=i.length;v--;)Ho(a,i[v]);return a});function Ev(e,i){return _l(e,ma(we(i)))}var Sv=ui(function(e,i){return e==null?{}:Jg(e,i)});function _l(e,i){if(e==null)return{};var a=vt(Jo(e),function(h){return[h]});return i=we(i),oh(e,a,function(h,v){return i(h,v[0])})}function Iv(e,i,a){i=Pi(i,e);var h=-1,v=i.length;for(v||(v=1,e=r);++h<v;){var I=e==null?r:e[Xr(i[h])];I===r&&(h=v,I=a),e=li(I)?I.call(e):I}return e}function Ov(e,i,a){return e==null?e:Wn(e,i,a)}function Pv(e,i,a,h){return h=typeof h=="function"?h:r,e==null?e:Wn(e,i,a,h)}var yl=Th(kt),vl=Th(pr);function xv(e,i,a){var h=Ne(e),v=h||Ai(e)||Sn(e);if(i=we(i,4),a==null){var I=e&&e.constructor;v?a=h?new I:[]:bt(e)?a=li(I)?mn(ks(e)):{}:a={}}return(v?xr:Yr)(e,function(R,U,G){return i(a,R,U,G)}),a}function Av(e,i){return e==null?!0:Ho(e,i)}function Tv(e,i,a){return e==null?e:fh(e,i,Vo(a))}function Cv(e,i,a,h){return h=typeof h=="function"?h:r,e==null?e:fh(e,i,Vo(a),h)}function In(e){return e==null?[]:So(e,kt(e))}function Rv(e){return e==null?[]:So(e,pr(e))}function Nv(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=jr(a),a=a===a?a:0),i!==r&&(i=jr(i),i=i===i?i:0),Ki(jr(e),i,a)}function jv(e,i,a){return i=fi(i),a===r?(a=i,i=0):a=fi(a),e=jr(e),Mg(e,i,a)}function Dv(e,i,a){if(a&&typeof a!="boolean"&&nr(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=fi(e),i===r?(i=e,e=0):i=fi(i)),e>i){var h=e;e=i,i=h}if(a||e%1||i%1){var v=Hu();return Xt(e+v*(i-e+ot("1e-"+((v+"").length-1))),i)}return Mo(e,i)}var Fv=wn(function(e,i,a){return i=i.toLowerCase(),e+(a?ml(i):i)});function ml(e){return fc(it(e).toLowerCase())}function bl(e){return e=it(e),e&&e.replace(ii,Op).replace(po,"")}function Uv(e,i,a){e=it(e),i=br(i);var h=e.length;a=a===r?h:Ki($e(a),0,h);var v=a;return a-=i.length,a>=0&&e.slice(a,v)==i}function Lv(e){return e=it(e),e&&_t.test(e)?e.replace(Di,Pp):e}function $v(e){return e=it(e),e&&$t.test(e)?e.replace(Ot,"\\$&"):e}var Mv=wn(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),qv=wn(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),zv=Sh("toLowerCase");function Hv(e,i,a){e=it(e),i=$e(i);var h=i?pn(e):0;if(!i||h>=i)return e;var v=(i-h)/2;return ha(Xs(v),a)+e+ha(Js(v),a)}function Kv(e,i,a){e=it(e),i=$e(i);var h=i?pn(e):0;return i&&h<i?e+ha(i-h,a):e}function Bv(e,i,a){e=it(e),i=$e(i);var h=i?pn(e):0;return i&&h<i?ha(i-h,a)+e:e}function Vv(e,i,a){return a||i==null?i=0:i&&(i=+i),Zp(it(e).replace(Pt,""),i||0)}function Gv(e,i,a){return(a?nr(e,i,a):i===r)?i=1:i=$e(i),qo(it(e),i)}function kv(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Wv=wn(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function Yv(e,i,a){return a&&typeof a!="number"&&nr(e,i,a)&&(i=a=r),a=a===r?te:a>>>0,a?(e=it(e),e&&(typeof i=="string"||i!=null&&!uc(i))&&(i=br(i),!i&&dn(e))?xi(qr(e),0,a):e.split(i,a)):[]}var Jv=wn(function(e,i,a){return e+(a?" ":"")+fc(i)});function Xv(e,i,a){return e=it(e),a=a==null?0:Ki($e(a),0,e.length),i=br(i),e.slice(a,a+i.length)==i}function Zv(e,i,a){var h=S.templateSettings;a&&nr(e,i,a)&&(i=r),e=it(e),i=Ea({},i,h,Ch);var v=Ea({},i.imports,h.imports,Ch),I=kt(v),R=So(v,I),U,G,se=0,ae=i.interpolate||sn,ce="__p += '",fe=Oo((i.escape||sn).source+"|"+ae.source+"|"+(ae===mt?Ja:sn).source+"|"+(i.evaluate||sn).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++go+"]")+`
`;e.replace(fe,function(Se,ke,Ze,Er,sr,Sr){return Ze||(Ze=Er),ce+=e.slice(se,Sr).replace(ro,xp),ke&&(U=!0,ce+=`' +
__e(`+ke+`) +
'`),sr&&(G=!0,ce+=`';
`+sr+`;
__p += '`),Ze&&(ce+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),se=Sr+Se.length,Se}),ce+=`';
`;var Ee=nt.call(i,"variable")&&i.variable;if(!Ee)ce=`with (obj) {
`+ce+`
}
`;else if(Wa.test(Ee))throw new Ce(m);ce=(G?ce.replace(Gr,""):ce).replace(tr,"$1").replace(ri,"$1;"),ce="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(U?", __e = _.escape":"")+(G?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ce+`return __p
}`;var ze=El(function(){return rt(I,ve+"return "+ce).apply(r,R)});if(ze.source=ce,cc(ze))throw ze;return ze}function Qv(e){return it(e).toLowerCase()}function e1(e){return it(e).toUpperCase()}function t1(e,i,a){if(e=it(e),e&&(a||i===r))return Ru(e);if(!e||!(i=br(i)))return e;var h=qr(e),v=qr(i),I=Nu(h,v),R=ju(h,v)+1;return xi(h,I,R).join("")}function r1(e,i,a){if(e=it(e),e&&(a||i===r))return e.slice(0,Fu(e)+1);if(!e||!(i=br(i)))return e;var h=qr(e),v=ju(h,qr(i))+1;return xi(h,0,v).join("")}function i1(e,i,a){if(e=it(e),e&&(a||i===r))return e.replace(Pt,"");if(!e||!(i=br(i)))return e;var h=qr(e),v=Nu(h,qr(i));return xi(h,v).join("")}function n1(e,i){var a=c,h=f;if(bt(i)){var v="separator"in i?i.separator:v;a="length"in i?$e(i.length):a,h="omission"in i?br(i.omission):h}e=it(e);var I=e.length;if(dn(e)){var R=qr(e);I=R.length}if(a>=I)return e;var U=a-pn(h);if(U<1)return h;var G=R?xi(R,0,U).join(""):e.slice(0,U);if(v===r)return G+h;if(R&&(U+=G.length-U),uc(v)){if(e.slice(U).search(v)){var se,ae=G;for(v.global||(v=Oo(v.source,it(Or.exec(v))+"g")),v.lastIndex=0;se=v.exec(ae);)var ce=se.index;G=G.slice(0,ce===r?U:ce)}}else if(e.indexOf(br(v),U)!=U){var fe=G.lastIndexOf(v);fe>-1&&(G=G.slice(0,fe))}return G+h}function s1(e){return e=it(e),e&&Et.test(e)?e.replace(vi,Dp):e}var a1=wn(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),fc=Sh("toUpperCase");function wl(e,i,a){return e=it(e),i=a?r:i,i===r?Tp(e)?Lp(e):bp(e):e.match(i)||[]}var El=Be(function(e,i){try{return Gt(e,r,i)}catch(a){return cc(a)?a:new Ce(a)}}),o1=ui(function(e,i){return xr(i,function(a){a=Xr(a),oi(e,a,ac(e[a],e))}),e});function c1(e){var i=e==null?0:e.length,a=we();return e=i?vt(e,function(h){if(typeof h[1]!="function")throw new Ar(b);return[a(h[0]),h[1]]}):[],Be(function(h){for(var v=-1;++v<i;){var I=e[v];if(Gt(I[0],this,h))return Gt(I[1],this,h)}})}function u1(e){return Dg(Cr(e,$))}function dc(e){return function(){return e}}function h1(e,i){return e==null||e!==e?i:e}var l1=Oh(),f1=Oh(!0);function gr(e){return e}function pc(e){return th(typeof e=="function"?e:Cr(e,$))}function d1(e){return ih(Cr(e,$))}function p1(e,i){return nh(e,Cr(i,$))}var g1=Be(function(e,i){return function(a){return Gn(a,e,i)}}),_1=Be(function(e,i){return function(a){return Gn(e,a,i)}});function gc(e,i,a){var h=kt(i),v=ia(i,h);a==null&&!(bt(i)&&(v.length||!h.length))&&(a=i,i=e,e=this,v=ia(i,kt(i)));var I=!(bt(a)&&"chain"in a)||!!a.chain,R=li(e);return xr(v,function(U){var G=i[U];e[U]=G,R&&(e.prototype[U]=function(){var se=this.__chain__;if(I||se){var ae=e(this.__wrapped__),ce=ae.__actions__=fr(this.__actions__);return ce.push({func:G,args:arguments,thisArg:e}),ae.__chain__=se,ae}return G.apply(e,wi([this.value()],arguments))})}),e}function y1(){return Xe._===this&&(Xe._=Kp),this}function _c(){}function v1(e){return e=$e(e),Be(function(i){return sh(i,e)})}var m1=ko(vt),b1=ko(Pu),w1=ko(vo);function Sl(e){return ec(e)?mo(Xr(e)):Xg(e)}function E1(e){return function(i){return e==null?r:Bi(e,i)}}var S1=xh(),I1=xh(!0);function yc(){return[]}function vc(){return!1}function O1(){return{}}function P1(){return""}function x1(){return!0}function A1(e,i){if(e=$e(e),e<1||e>W)return[];var a=te,h=Xt(e,te);i=we(i),e-=te;for(var v=Eo(h,i);++a<e;)i(a);return v}function T1(e){return Ne(e)?vt(e,Xr):wr(e)?[e]:fr(Kh(it(e)))}function C1(e){var i=++zp;return it(e)+i}var R1=ua(function(e,i){return e+i},0),N1=Wo("ceil"),j1=ua(function(e,i){return e/i},1),D1=Wo("floor");function F1(e){return e&&e.length?ra(e,gr,jo):r}function U1(e,i){return e&&e.length?ra(e,we(i,2),jo):r}function L1(e){return Tu(e,gr)}function $1(e,i){return Tu(e,we(i,2))}function M1(e){return e&&e.length?ra(e,gr,Lo):r}function q1(e,i){return e&&e.length?ra(e,we(i,2),Lo):r}var z1=ua(function(e,i){return e*i},1),H1=Wo("round"),K1=ua(function(e,i){return e-i},0);function B1(e){return e&&e.length?wo(e,gr):0}function V1(e,i){return e&&e.length?wo(e,we(i,2)):0}return S.after=dy,S.ary=el,S.assign=ev,S.assignIn=pl,S.assignInWith=Ea,S.assignWith=tv,S.at=rv,S.before=tl,S.bind=ac,S.bindAll=o1,S.bindKey=rl,S.castArray=Oy,S.chain=Xh,S.chunk=D0,S.compact=F0,S.concat=U0,S.cond=c1,S.conforms=u1,S.constant=dc,S.countBy=B_,S.create=iv,S.curry=il,S.curryRight=nl,S.debounce=sl,S.defaults=nv,S.defaultsDeep=sv,S.defer=py,S.delay=gy,S.difference=L0,S.differenceBy=$0,S.differenceWith=M0,S.drop=q0,S.dropRight=z0,S.dropRightWhile=H0,S.dropWhile=K0,S.fill=B0,S.filter=G_,S.flatMap=Y_,S.flatMapDeep=J_,S.flatMapDepth=X_,S.flatten=kh,S.flattenDeep=V0,S.flattenDepth=G0,S.flip=_y,S.flow=l1,S.flowRight=f1,S.fromPairs=k0,S.functions=fv,S.functionsIn=dv,S.groupBy=Z_,S.initial=Y0,S.intersection=J0,S.intersectionBy=X0,S.intersectionWith=Z0,S.invert=gv,S.invertBy=_v,S.invokeMap=ey,S.iteratee=pc,S.keyBy=ty,S.keys=kt,S.keysIn=pr,S.map=_a,S.mapKeys=vv,S.mapValues=mv,S.matches=d1,S.matchesProperty=p1,S.memoize=va,S.merge=bv,S.mergeWith=gl,S.method=g1,S.methodOf=_1,S.mixin=gc,S.negate=ma,S.nthArg=v1,S.omit=wv,S.omitBy=Ev,S.once=yy,S.orderBy=ry,S.over=m1,S.overArgs=vy,S.overEvery=b1,S.overSome=w1,S.partial=oc,S.partialRight=al,S.partition=iy,S.pick=Sv,S.pickBy=_l,S.property=Sl,S.propertyOf=E1,S.pull=r_,S.pullAll=Yh,S.pullAllBy=i_,S.pullAllWith=n_,S.pullAt=s_,S.range=S1,S.rangeRight=I1,S.rearg=my,S.reject=ay,S.remove=a_,S.rest=by,S.reverse=nc,S.sampleSize=cy,S.set=Ov,S.setWith=Pv,S.shuffle=uy,S.slice=o_,S.sortBy=fy,S.sortedUniq=p_,S.sortedUniqBy=g_,S.split=Yv,S.spread=wy,S.tail=__,S.take=y_,S.takeRight=v_,S.takeRightWhile=m_,S.takeWhile=b_,S.tap=F_,S.throttle=Ey,S.thru=ga,S.toArray=ll,S.toPairs=yl,S.toPairsIn=vl,S.toPath=T1,S.toPlainObject=dl,S.transform=xv,S.unary=Sy,S.union=w_,S.unionBy=E_,S.unionWith=S_,S.uniq=I_,S.uniqBy=O_,S.uniqWith=P_,S.unset=Av,S.unzip=sc,S.unzipWith=Jh,S.update=Tv,S.updateWith=Cv,S.values=In,S.valuesIn=Rv,S.without=x_,S.words=wl,S.wrap=Iy,S.xor=A_,S.xorBy=T_,S.xorWith=C_,S.zip=R_,S.zipObject=N_,S.zipObjectDeep=j_,S.zipWith=D_,S.entries=yl,S.entriesIn=vl,S.extend=pl,S.extendWith=Ea,gc(S,S),S.add=R1,S.attempt=El,S.camelCase=Fv,S.capitalize=ml,S.ceil=N1,S.clamp=Nv,S.clone=Py,S.cloneDeep=Ay,S.cloneDeepWith=Ty,S.cloneWith=xy,S.conformsTo=Cy,S.deburr=bl,S.defaultTo=h1,S.divide=j1,S.endsWith=Uv,S.eq=Hr,S.escape=Lv,S.escapeRegExp=$v,S.every=V_,S.find=k_,S.findIndex=Vh,S.findKey=av,S.findLast=W_,S.findLastIndex=Gh,S.findLastKey=ov,S.floor=D1,S.forEach=Zh,S.forEachRight=Qh,S.forIn=cv,S.forInRight=uv,S.forOwn=hv,S.forOwnRight=lv,S.get=hc,S.gt=Ry,S.gte=Ny,S.has=pv,S.hasIn=lc,S.head=Wh,S.identity=gr,S.includes=Q_,S.indexOf=W0,S.inRange=jv,S.invoke=yv,S.isArguments=ki,S.isArray=Ne,S.isArrayBuffer=jy,S.isArrayLike=dr,S.isArrayLikeObject=Nt,S.isBoolean=Dy,S.isBuffer=Ai,S.isDate=Fy,S.isElement=Uy,S.isEmpty=Ly,S.isEqual=$y,S.isEqualWith=My,S.isError=cc,S.isFinite=qy,S.isFunction=li,S.isInteger=ol,S.isLength=ba,S.isMap=cl,S.isMatch=zy,S.isMatchWith=Hy,S.isNaN=Ky,S.isNative=By,S.isNil=Gy,S.isNull=Vy,S.isNumber=ul,S.isObject=bt,S.isObjectLike=At,S.isPlainObject=Zn,S.isRegExp=uc,S.isSafeInteger=ky,S.isSet=hl,S.isString=wa,S.isSymbol=wr,S.isTypedArray=Sn,S.isUndefined=Wy,S.isWeakMap=Yy,S.isWeakSet=Jy,S.join=Q0,S.kebabCase=Mv,S.last=Nr,S.lastIndexOf=e_,S.lowerCase=qv,S.lowerFirst=zv,S.lt=Xy,S.lte=Zy,S.max=F1,S.maxBy=U1,S.mean=L1,S.meanBy=$1,S.min=M1,S.minBy=q1,S.stubArray=yc,S.stubFalse=vc,S.stubObject=O1,S.stubString=P1,S.stubTrue=x1,S.multiply=z1,S.nth=t_,S.noConflict=y1,S.noop=_c,S.now=ya,S.pad=Hv,S.padEnd=Kv,S.padStart=Bv,S.parseInt=Vv,S.random=Dv,S.reduce=ny,S.reduceRight=sy,S.repeat=Gv,S.replace=kv,S.result=Iv,S.round=H1,S.runInContext=V,S.sample=oy,S.size=hy,S.snakeCase=Wv,S.some=ly,S.sortedIndex=c_,S.sortedIndexBy=u_,S.sortedIndexOf=h_,S.sortedLastIndex=l_,S.sortedLastIndexBy=f_,S.sortedLastIndexOf=d_,S.startCase=Jv,S.startsWith=Xv,S.subtract=K1,S.sum=B1,S.sumBy=V1,S.template=Zv,S.times=A1,S.toFinite=fi,S.toInteger=$e,S.toLength=fl,S.toLower=Qv,S.toNumber=jr,S.toSafeInteger=Qy,S.toString=it,S.toUpper=e1,S.trim=t1,S.trimEnd=r1,S.trimStart=i1,S.truncate=n1,S.unescape=s1,S.uniqueId=C1,S.upperCase=a1,S.upperFirst=fc,S.each=Zh,S.eachRight=Qh,S.first=Wh,gc(S,function(){var e={};return Yr(S,function(i,a){nt.call(S.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),S.VERSION=s,xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){S[e].placeholder=S}),xr(["drop","take"],function(e,i){Ye.prototype[e]=function(a){a=a===r?1:Vt($e(a),0);var h=this.__filtered__&&!i?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Xt(a,h.__takeCount__):h.__views__.push({size:Xt(a,te),type:e+(h.__dir__<0?"Right":"")}),h},Ye.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),xr(["filter","map","takeWhile"],function(e,i){var a=i+1,h=a==_||a==T;Ye.prototype[e]=function(v){var I=this.clone();return I.__iteratees__.push({iteratee:we(v,3),type:a}),I.__filtered__=I.__filtered__||h,I}}),xr(["head","last"],function(e,i){var a="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[a](1).value()[0]}}),xr(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(gr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Be(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(a){return Gn(a,e,i)})}),Ye.prototype.reject=function(e){return this.filter(ma(we(e)))},Ye.prototype.slice=function(e,i){e=$e(e);var a=this;return a.__filtered__&&(e>0||i<0)?new Ye(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=$e(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(te)},Yr(Ye.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),h=/^(?:head|last)$/.test(i),v=S[h?"take"+(i=="last"?"Right":""):i],I=h||/^find/.test(i);v&&(S.prototype[i]=function(){var R=this.__wrapped__,U=h?[1]:arguments,G=R instanceof Ye,se=U[0],ae=G||Ne(R),ce=function(ke){var Ze=v.apply(S,wi([ke],U));return h&&fe?Ze[0]:Ze};ae&&a&&typeof se=="function"&&se.length!=1&&(G=ae=!1);var fe=this.__chain__,ve=!!this.__actions__.length,Ee=I&&!fe,ze=G&&!ve;if(!I&&ae){R=ze?R:new Ye(this);var Se=e.apply(R,U);return Se.__actions__.push({func:ga,args:[ce],thisArg:r}),new Tr(Se,fe)}return Ee&&ze?e.apply(this,U):(Se=this.thru(ce),Ee?h?Se.value()[0]:Se.value():Se)})}),xr(["pop","push","shift","sort","splice","unshift"],function(e){var i=zs[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",h=/^(?:pop|shift)$/.test(e);S.prototype[e]=function(){var v=arguments;if(h&&!this.__chain__){var I=this.value();return i.apply(Ne(I)?I:[],v)}return this[a](function(R){return i.apply(Ne(R)?R:[],v)})}}),Yr(Ye.prototype,function(e,i){var a=S[i];if(a){var h=a.name+"";nt.call(vn,h)||(vn[h]=[]),vn[h].push({name:i,func:a})}}),vn[ca(r,ue).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=sg,Ye.prototype.reverse=ag,Ye.prototype.value=og,S.prototype.at=U_,S.prototype.chain=L_,S.prototype.commit=$_,S.prototype.next=M_,S.prototype.plant=z_,S.prototype.reverse=H_,S.prototype.toJSON=S.prototype.valueOf=S.prototype.value=K_,S.prototype.first=S.prototype.head,Mn&&(S.prototype[Mn]=q_),S},gn=$p();Rt?((Rt.exports=gn)._=gn,ct._=gn):Xe._=gn}).call(hs)})(Zc,Zc.exports);var x2=Object.defineProperty,A2=Object.defineProperties,T2=Object.getOwnPropertyDescriptors,Vf=Object.getOwnPropertySymbols,C2=Object.prototype.hasOwnProperty,R2=Object.prototype.propertyIsEnumerable,Gf=(n,t,r)=>t in n?x2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ia=(n,t)=>{for(var r in t||(t={}))C2.call(t,r)&&Gf(n,r,t[r]);if(Vf)for(var r of Vf(t))R2.call(t,r)&&Gf(n,r,t[r]);return n},N2=(n,t)=>A2(n,T2(t));function Ur(n,t,r){let s;const o=Qc(n);return t.rpcMap&&(s=t.rpcMap[o]),s||(s=`${P2}?chainId=eip155:${o}&projectId=${r}`),s}function Qc(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function j2(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function D2(n,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(n));if(!r.length)return[];const s=[];return r.forEach(o=>{const g=t.namespaces[o].accounts;s.push(...g)}),s}function F2(n,t={}){const r=kf(n),s=kf(t);return Zc.exports.merge(r,s)}function kf(n){var t,r,s,o;const g={};if(!Cn(n))return g;for(const[b,m]of Object.entries(n)){const E=$d(b)?[b]:m.chains,A=m.methods||[],C=m.events||[],$=m.rpcMap||{},k=xa(b);g[k]=N2(Ia(Ia({},g[k]),m),{chains:Ac(E,(t=g[k])==null?void 0:t.chains),methods:Ac(A,(r=g[k])==null?void 0:r.methods),events:Ac(C,(s=g[k])==null?void 0:s.events),rpcMap:Ia(Ia({},$),(o=g[k])==null?void 0:o.rpcMap)})}return g}const pp={},Ft=n=>pp[n],Fc=(n,t)=>{pp[n]=t};class U2{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class L2{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=Qc(t);if(!this.httpProviders[s]){const o=r||Ur(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=Qc(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r;let s=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const o=parseInt(s,16);if(this.isChainApproved(o))this.setDefaultChain(`${o}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:t.chainId}),this.setDefaultChain(`${o}`);else throw new Error(`Failed to switch to chain 'eip155:${o}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class $2{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class M2{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class q2{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class z2{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class H2{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}var K2=Object.defineProperty,B2=Object.defineProperties,V2=Object.getOwnPropertyDescriptors,Wf=Object.getOwnPropertySymbols,G2=Object.prototype.hasOwnProperty,k2=Object.prototype.propertyIsEnumerable,Yf=(n,t,r)=>t in n?K2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Oa=(n,t)=>{for(var r in t||(t={}))G2.call(t,r)&&Yf(n,r,t[r]);if(Wf)for(var r of Wf(t))k2.call(t,r)&&Yf(n,r,t[r]);return n},Uc=(n,t)=>B2(n,V2(t));class Iu{constructor(t){this.events=new iu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Kf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Iu(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Oa({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Dt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(g=>{this.session=g}).catch(g=>{if(g.message!==dp)throw g;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(yi(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Su.init({logger:this.providerOpts.logger||Kf,relayUrl:this.providerOpts.relayUrl||S2,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>xa(r)))];Fc("client",this.client),Fc("events",this.events),Fc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=D2(r,this.session),o=j2(s),g=F2(this.namespaces,this.optionalNamespaces),b=Uc(Oa({},g[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new L2({namespace:b});break;case"solana":this.rpcProviders[r]=new $2({namespace:b});break;case"cosmos":this.rpcProviders[r]=new M2({namespace:b});break;case"polkadot":this.rpcProviders[r]=new U2({namespace:b});break;case"cip34":this.rpcProviders[r]=new q2({namespace:b});break;case"elrond":this.rpcProviders[r]=new z2({namespace:b});break;case"multiversx":this.rpcProviders[r]=new H2({namespace:b});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,g=(s=this.client)==null?void 0:s.session.get(t);this.session=Uc(Oa({},g),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Uc(Oa({},Dt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ji.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).map(b=>xa(b)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=xa(Object.keys(this.namespaces)[0]),g=this.rpcProviders[o].getDefaultChain();return[o,g]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;const[o,g]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(g),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${g}`]).defaultChain=g,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",g)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Bf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Bf}/${t}`)}}const W2=Iu,Y2="wc",J2="ethereum_provider",X2=`${Y2}@2:${J2}:`,Z2="https://rpc.walletconnect.com/v1/",eu=["eth_sendTransaction","personal_sign"],g3=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],tu=["chainChanged","accountsChanged"],_3=["message","disconnect","connect"];var Q2=Object.defineProperty,e3=Object.defineProperties,t3=Object.getOwnPropertyDescriptors,Jf=Object.getOwnPropertySymbols,r3=Object.prototype.hasOwnProperty,i3=Object.prototype.propertyIsEnumerable,Xf=(n,t,r)=>t in n?Q2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Lc=(n,t)=>{for(var r in t||(t={}))r3.call(t,r)&&Xf(n,r,t[r]);if(Jf)for(var r of Jf(t))i3.call(t,r)&&Xf(n,r,t[r]);return n},Zf=(n,t)=>e3(n,t3(t));function ru(n){return Number(n[0].split(":")[1])}function $c(n){return`0x${n.toString(16)}`}function n3(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:g,optionalEvents:b,rpcMap:m}=n;if(!yi(t))throw new Error("Invalid chains");const E=t,A=s||eu,C=g||tu,$={[ru(E)]:m[ru(E)]},k={chains:E,methods:A,events:C,rpcMap:$},M=g==null?void 0:g.filter(ue=>!tu.includes(ue)),H=s==null?void 0:s.filter(ue=>!eu.includes(ue));if(!r&&!b&&!o&&!(M!=null&&M.length)&&!(H!=null&&H.length))return{required:k};const Z=(M==null?void 0:M.length)&&(H==null?void 0:H.length)||!r,Q={chains:[...new Set(Z?E.concat(r||[]):r)],methods:[...new Set(A.concat(o||[]))],events:[...new Set(C.concat(b||[]))],rpcMap:m};return{required:k,optional:Q}}class Ou{constructor(){this.events=new Lr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=X2,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Ou;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=n3(this.rpc);try{const o=await new Promise(async(b,m)=>{var E;this.rpc.showQrModal&&((E=this.modal)==null||E.subscribeModal(A=>{!A.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),m(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Zf(Lc({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(A=>{b(A)}).catch(A=>{m(new Error(A.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const g=tw(o.namespaces,[this.namespace]);this.setAccounts(g),this.events.emit("connect",{chainId:$c(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",$c(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Zf(Lc({},Dt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",$c(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;return{chains:((r=t.chains)==null?void 0:r.map(o=>this.formatChainId(o)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(o=>this.formatChainId(o)):void 0,methods:(t==null?void 0:t.methods)||eu,events:(t==null?void 0:t.events)||tu,optionalMethods:(t==null?void 0:t.optionalMethods)||[],optionalEvents:(t==null?void 0:t.optionalEvents)||[],rpcMap:(t==null?void 0:t.rpcMap)||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:(s=t==null?void 0:t.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=ru(this.rpc.chains),this.signer=await W2.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Y1(()=>import("./index-ac54edda.js").then(o=>o.a),["assets/index-ac54edda.js","assets/index-20076c51.js","assets/index-bdbd7312.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Lc({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&yi(r)&&(this.rpc.chains=r.map(g=>this.formatChainId(g)),r.forEach(g=>{this.rpc.rpcMap[g]=(o==null?void 0:o[g])||this.getRpcUrl(g)})),s&&yi(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(g=>this.formatChainId(g)),s.forEach(g=>{this.rpc.rpcMap[g]=(o==null?void 0:o[g])||this.getRpcUrl(g)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${Z2}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const y3=Ou;export{y3 as EthereumProvider,_3 as OPTIONAL_EVENTS,g3 as OPTIONAL_METHODS,tu as REQUIRED_EVENTS,eu as REQUIRED_METHODS,Ou as default};
